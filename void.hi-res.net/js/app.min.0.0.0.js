$(document).ready(function () {
    !function (t) { function e(n) { if (i[n]) return i[n].exports; var o = i[n] = { exports: {}, id: n, loaded: !1 }; return t[n].call(o.exports, o, o.exports, e), o.loaded = !0, o.exports } var i = {}; return e.m = t, e.c = i, e.p = "", e(0) }([function (t, e, i) { var n, o, s, r, a, u, h, l, d, p, _, f, m, g, y = function (t, e) { return function () { return t.apply(e, arguments) } }; window.PI = Math.PI, window.PI_2 = 2 * Math.PI, window.PI_HALF = .5 * Math.PI, p = i(2), u = i(3), d = i(7), _ = i(21), s = i(93), o = i(96), l = i(38), m = i(10), a = i(97), r = i(99), f = i(22), h = i(101), g = i(9), n = function () { function t() { this.start = y(this.start, this), this.test = y(this.test, this), window.c = p, c.enable = !0, c.log("%c V O I D", "background:#000; color: #fff"), c.log("%c 	Hi-ReS!", "background:#000; color: #fff"), c.enable = !m.live, u.set_tests(["desktop", "WebGL", "AudioContext"]), l.once("loaded", this.test), l.load() } return t.prototype.test = function () { var t, e, i, n, o; for (o = window.location.pathname.replace(m.base_path, ""), i = !1, t = 0, e = f.length; e > t; t++)if (n = f[t], o === n.url) { i = !0; break } return i ? u.supported() ? this.supported() : this.unsupported() : void this.not_found() }, t.prototype.not_found = function () { return new r }, t.prototype.unsupported = function () { return new a }, t.prototype.supported = function () { return d.once("loaded", this.start), d.setup() }, t.prototype.start = function () { return new s, new o, _.start(), h.random() }, t }(), t.exports = new n }, , function (t, e) { var i = [].slice; t.exports = { enable: !1, clear: function () { return "undefined" != typeof console && null !== console && null != console.clear ? console.clear() : void 0 }, log: function () { var t; return t = 1 <= arguments.length ? i.call(arguments, 0) : [], this.enable ? "undefined" != typeof console && null !== console && null != console.log && null != console.log.apply ? console.log.apply(console, t) : console.log(t) : void 0 }, debug: function () { var t; return t = 1 <= arguments.length ? i.call(arguments, 0) : [], this.enable ? "undefined" != typeof console && null !== console && null != console.debug && null != console.debug.apply ? console.debug.apply(console, t) : console.log(t) : void 0 }, info: function () { var t; return t = 1 <= arguments.length ? i.call(arguments, 0) : [], this.enable ? "undefined" != typeof console && null !== console && null != console.info && null != console.info.apply ? console.info.apply(console, t) : console.log(t) : void 0 }, warn: function () { var t; return t = 1 <= arguments.length ? i.call(arguments, 0) : [], this.enable ? "undefined" != typeof console && null !== console && null != console.warn && null != console.warn.apply ? console.warn.apply(console, t) : console.log(t) : void 0 }, error: function () { var t; return t = 1 <= arguments.length ? i.call(arguments, 0) : [], this.enable ? "undefined" != typeof console && null !== console && null != console.error && null != console.error.apply ? console.error.apply(console, t) : console.log(t) : void 0 } } }, function (t, e, i) { var n; n = i(4), t.exports = new (function () { function t() { this.detect = new MobileDetect(window.navigator.userAgent), this.tests = {}, this.messages = { WebGL: "WebGL", desktop: "Desktop Browser", tablet: "Tablet Browser", mobile: "Mobile Browser" } } return t.prototype.set_tests = function (t) { var e, i, n, o, s; for (n = [], e = 0, i = t.length; i > e; e++)switch (s = t[e]) { case "desktop": this.detect.tablet() || this.detect.mobile() ? n.push(this.tests.desktop = !1) : n.push(this.tests.desktop = !0); break; case "tablet": n.push(this.tests.tablet = this.detect.tablet()); break; case "mobile": n.push(this.tests.mobile = this.detect.mobile()); break; case "AudioContext": n.push(this.tests.AudioContext = void 0 !== (window.AudioContext || window.webkitAudioContext)); break; case "WebGL": o = function () { var t, e; try { return !!window.WebGLRenderingContext && !!document.createElement("canvas").getContext("experimental-webgl") } catch (e) { return t = e, !1 } }, n.push(this.tests.WebGL = o()); break; default: n.push(void 0) }return n }, t.prototype.browser_test = function () { var t, e, i; return t = "debug", i = !0, null != env.BROWSER_SPEC[n.name] ? (e = env.BROWSER_SPEC[n.name], n.version < e ? (i = !1, this.message = "Unsupported browser", t = "error") : (i = !0, this.message = "supported")) : i = !1, c[t]("[BrowserTest] " + this.name + " " + this.version + " " + this.message), i }, t.prototype.supported = function () { var t, e, i, n; e = !1, t = this.tests; for (n in t) { if (i = t[n], i === !1) { e = !1; break } "desktop" !== n && "tablet" !== n && "mobile" !== n || !i || (e = !0) } return e && (e = this.browser_test()), e }, t }()) }, function (t, e, i) { var n, o, s; o = i(5).browser, s = i(6), t.exports = new (n = function () { function t() { this.ie = o.msie, this.firefox = o.firefox, this.ltie10 = o.msie && o.version < 10, this.name = o.name, this.version = o.version, this.mobile = s.phone, this.tablet = s.tablet, this.handheld = s.any, this.device = this.tablet || this.mobile, this.desktop = (this.tablet || this.mobile) === !1 } return t }()) }, function (t, e, i) { var n, o; !function (s, r) { "undefined" != typeof t && t.exports ? t.exports.browser = r() : (n = r, o = "function" == typeof n ? n.call(e, i, e, t) : n, !(void 0 !== o && (t.exports = o))) }("bowser", function () { function t(t) { function i(e) { var i = t.match(e); return i && i.length > 1 && i[1] || "" } function n(e) { var i = t.match(e); return i && i.length > 1 && i[2] || "" } var o, s = i(/(ipod|iphone|ipad)/i).toLowerCase(), r = /like android/i.test(t), a = !r && /android/i.test(t), u = i(/edge\/(\d+(\.\d+)?)/i), h = i(/version\/(\d+(\.\d+)?)/i), l = /tablet/i.test(t), c = !l && /[^-]mobi/i.test(t); /opera|opr/i.test(t) ? o = { name: "Opera", opera: e, version: h || i(/(?:opera|opr)[\s\/](\d+(\.\d+)?)/i) } : /windows phone/i.test(t) ? (o = { name: "Windows Phone", windowsphone: e }, u ? (o.msedge = e, o.version = u) : (o.msie = e, o.version = i(/iemobile\/(\d+(\.\d+)?)/i))) : /msie|trident/i.test(t) ? o = { name: "Internet Explorer", msie: e, version: i(/(?:msie |rv:)(\d+(\.\d+)?)/i) } : /chrome.+? edge/i.test(t) ? o = { name: "Microsoft Edge", msedge: e, version: u } : /chrome|crios|crmo/i.test(t) ? o = { name: "Chrome", chrome: e, version: i(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i) } : s ? (o = { name: "iphone" == s ? "iPhone" : "ipad" == s ? "iPad" : "iPod" }, h && (o.version = h)) : /sailfish/i.test(t) ? o = { name: "Sailfish", sailfish: e, version: i(/sailfish\s?browser\/(\d+(\.\d+)?)/i) } : /seamonkey\//i.test(t) ? o = { name: "SeaMonkey", seamonkey: e, version: i(/seamonkey\/(\d+(\.\d+)?)/i) } : /firefox|iceweasel/i.test(t) ? (o = { name: "Firefox", firefox: e, version: i(/(?:firefox|iceweasel)[ \/](\d+(\.\d+)?)/i) }, /\((mobile|tablet);[^\)]*rv:[\d\.]+\)/i.test(t) && (o.firefoxos = e)) : /silk/i.test(t) ? o = { name: "Amazon Silk", silk: e, version: i(/silk\/(\d+(\.\d+)?)/i) } : a ? o = { name: "Android", version: h } : /phantom/i.test(t) ? o = { name: "PhantomJS", phantom: e, version: i(/phantomjs\/(\d+(\.\d+)?)/i) } : /blackberry|\bbb\d+/i.test(t) || /rim\stablet/i.test(t) ? o = { name: "BlackBerry", blackberry: e, version: h || i(/blackberry[\d]+\/(\d+(\.\d+)?)/i) } : /(web|hpw)os/i.test(t) ? (o = { name: "WebOS", webos: e, version: h || i(/w(?:eb)?osbrowser\/(\d+(\.\d+)?)/i) }, /touchpad\//i.test(t) && (o.touchpad = e)) : o = /bada/i.test(t) ? { name: "Bada", bada: e, version: i(/dolfin\/(\d+(\.\d+)?)/i) } : /tizen/i.test(t) ? { name: "Tizen", tizen: e, version: i(/(?:tizen\s?)?browser\/(\d+(\.\d+)?)/i) || h } : /safari/i.test(t) ? { name: "Safari", safari: e, version: h } : { name: i(/^(.*)\/(.*) /), version: n(/^(.*)\/(.*) /) }, !o.msedge && /(apple)?webkit/i.test(t) ? (o.name = o.name || "Webkit", o.webkit = e, !o.version && h && (o.version = h)) : !o.opera && /gecko\//i.test(t) && (o.name = o.name || "Gecko", o.gecko = e, o.version = o.version || i(/gecko\/(\d+(\.\d+)?)/i)), o.msedge || !a && !o.silk ? s && (o[s] = e, o.ios = e) : o.android = e; var d = ""; o.windowsphone ? d = i(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i) : s ? (d = i(/os (\d+([_\s]\d+)*) like mac os x/i), d = d.replace(/[_\s]/g, ".")) : a ? d = i(/android[ \/-](\d+(\.\d+)*)/i) : o.webos ? d = i(/(?:web|hpw)os\/(\d+(\.\d+)*)/i) : o.blackberry ? d = i(/rim\stablet\sos\s(\d+(\.\d+)*)/i) : o.bada ? d = i(/bada\/(\d+(\.\d+)*)/i) : o.tizen && (d = i(/tizen[\/\s](\d+(\.\d+)*)/i)), d && (o.osversion = d); var p = d.split(".")[0]; return l || "ipad" == s || a && (3 == p || 4 == p && !c) || o.silk ? o.tablet = e : (c || "iphone" == s || "ipod" == s || a || o.blackberry || o.webos || o.bada) && (o.mobile = e), o.msedge || o.msie && o.version >= 10 || o.chrome && o.version >= 20 || o.firefox && o.version >= 20 || o.safari && o.version >= 6 || o.opera && o.version >= 10 || o.ios && o.osversion && o.osversion.split(".")[0] >= 6 || o.blackberry && o.version >= 10.1 ? o.a = e : o.msie && o.version < 10 || o.chrome && o.version < 20 || o.firefox && o.version < 20 || o.safari && o.version < 6 || o.opera && o.version < 10 || o.ios && o.osversion && o.osversion.split(".")[0] < 6 ? o.c = e : o.x = e, o } var e = !0, i = t("undefined" != typeof navigator ? navigator.userAgent : ""); return i.test = function (t) { for (var e = 0; e < t.length; ++e) { var n = t[e]; if ("string" == typeof n && n in i) return !0 } return !1 }, i._detect = t, i }) }, function (t, e, i) { var n, o, s; !function (i) { var r = /iPhone/i, a = /iPod/i, u = /iPad/i, h = /(?=.*\bAndroid\b)(?=.*\bMobile\b)/i, l = /Android/i, c = /(?=.*\bAndroid\b)(?=.*\bSD4930UR\b)/i, d = /(?=.*\bAndroid\b)(?=.*\b(?:KFOT|KFTT|KFJWI|KFJWA|KFSOWI|KFTHWI|KFTHWA|KFAPWI|KFAPWA|KFARWI|KFASWI|KFSAWI|KFSAWA)\b)/i, p = /IEMobile/i, _ = /(?=.*\bWindows\b)(?=.*\bARM\b)/i, f = /BlackBerry/i, m = /BB10/i, g = /Opera Mini/i, y = /(CriOS|Chrome)(?=.*\bMobile\b)/i, v = /(?=.*\bFirefox\b)(?=.*\bMobile\b)/i, b = new RegExp("(?:Nexus 7|BNTV250|Kindle Fire|Silk|GT-P1000)", "i"), w = function (t, e) { return t.test(e) }, x = function (t) { var e = t || navigator.userAgent, i = e.split("[FBAN"); return "undefined" != typeof i[1] && (e = i[0]), this.apple = { phone: w(r, e), ipod: w(a, e), tablet: !w(r, e) && w(u, e), device: w(r, e) || w(a, e) || w(u, e) }, this.amazon = { phone: w(c, e), tablet: !w(c, e) && w(d, e), device: w(c, e) || w(d, e) }, this.android = { phone: w(c, e) || w(h, e), tablet: !w(c, e) && !w(h, e) && (w(d, e) || w(l, e)), device: w(c, e) || w(d, e) || w(h, e) || w(l, e) }, this.windows = { phone: w(p, e), tablet: w(_, e), device: w(p, e) || w(_, e) }, this.other = { blackberry: w(f, e), blackberry10: w(m, e), opera: w(g, e), firefox: w(v, e), chrome: w(y, e), device: w(f, e) || w(m, e) || w(g, e) || w(v, e) || w(y, e) }, this.seven_inch = w(b, e), this.any = this.apple.device || this.android.device || this.windows.device || this.other.device || this.seven_inch, this.phone = this.apple.phone || this.android.phone || this.windows.phone, this.tablet = this.apple.tablet || this.android.tablet || this.windows.tablet, "undefined" == typeof window ? this : void 0 }, E = function () { var t = new x; return t.Class = x, t }; "undefined" != typeof t && t.exports && "undefined" == typeof window ? t.exports = x : "undefined" != typeof t && t.exports && "undefined" != typeof window ? t.exports = E() : (o = [], n = i.isMobile = E(), s = "function" == typeof n ? n.apply(e, o) : n, !(void 0 !== s && (t.exports = s))) }(this) }, function (t, e, i) { var n, o, s, r, a, u, h, l, c, d = function (t, e) { return function () { return t.apply(e, arguments) } }; u = i(8), c = i(9), l = i(10), a = i(11), o = i(16), r = i(17), h = i(18), s = i(19), t.exports = new (n = function () { function t() { this._resize = d(this._resize, this), this._update = d(this._update, this), u(this) } var e; return e = null, t.prototype.scene = r, t.prototype.fov = 80, t.prototype.setup = function () { var t, e; return this.el = $("#void"), e = function (t, e) { return t.position.set(1 * e, .75 * e, 1 * e), t.lookAt(new THREE.Vector3) }, e(o.dev, 160), h.setSize(c.width, c.height), this.el.append(h.domElement), l.debug && (this.scene.add(new THREE.GridHelper(50, 10)), this.scene.add(new THREE.AxisHelper(10))), l.live || (t = i(20), this.save = new t, $(window).on("keydown", function (t) { return function (e) { var i, n, s, r, a, u, l, d; return n = 7, s = 7, a = 3, u = 3, l = c.width * a, r = c.height * u, d = c.width * n, i = c.height * s, 80 === e.keyCode ? (h.setSize(l, r), t._render(o.user, 0, 0, a, u), h.render(t.scene, o.user), t.save["export"](d, i)) : void 0 } }(this))), this.gui = a.addFolder("controller::engine"), this.gui.add(l, "debug"), this.gui.open(), this._bind(), this._update(), this.emit("loaded") }, t.prototype.set_scene = function (t, e) { this.scene = null != t ? t : r, this.config = null != e ? e : {} }, t.prototype._bind = function () { return c.on("resize", this._resize) }, t.prototype._update = function () { return requestAnimationFrame(this._update), this.emit("update"), s.update(), o.user.fov = this.fov, l.debug ? (this._render(o.dev, 0, 0, 1, 1), this._render(o.user, 0, 0, .25, .25)) : this._render(o.user, 0, 0, 1, 1) }, t.prototype._render = function (t, e, i, n, s) { var r; return e *= c.width, i *= c.height, n *= c.width, s *= c.height, o.dev.updateProjectionMatrix(), o.user.updateProjectionMatrix(), h.setViewport(e, i, n, s), h.setScissor(e, i, n, s), h.enableScissorTest(!0), r = l.debug ? 1184274 : 0, h.setClearColor(r, 1), null == this.config || this.config.has_composer ? void 0 : h.render(this.scene, t) }, t.prototype._resize = function () { return o.dev.aspect = c.width / c.height, o.user.aspect = c.width / c.height, o.dev.updateProjectionMatrix(), o.user.updateProjectionMatrix(), h.setSize(c.width, c.height) }, t }()) }, function (t, e) { function i(t) { if (!(t && t instanceof Function)) throw new Error(t + " is not a Function") } t.exports = function (t) { t = t || {}; for (var e in n) t[e] = n[e]; return t }; var n = { __init: function (t) { var e = this.__listeners || (this.__listeners = []); return e[t] || (e[t] = []) }, on: function (t, e) { i(e), this.__init(t).push(e) }, off: function (t, e) { var i = this.__init(t); i.splice(i.indexOf(e), 1) }, once: function (t, e) { i(e); var n = this, o = function () { n.off(t, o), e.apply(this, arguments) }; this.on(t, o) }, emit: function (t) { var e, i = this.__init(t).slice(0); for (e in i) i[e].apply(this, [].slice.call(arguments, 1)) } } }, function (t, e, i) { var n, o, s = function (t, e) { return function () { return t.apply(e, arguments) } }; o = i(8), n = function () { function t() { this.resize = s(this.resize, this), o(this), this.window.on("resize", this.resize), this.resize() } return t.prototype.window = $(window), t.prototype.width = 0, t.prototype.height = 0, t.prototype.resize = function () { return this.width = this.window.width(), this.height = this.window.height(), this.emit("resize") }, t }(), t.exports = new n }, function (t, e) { var i; i = { debug: env.DEBUG, live: env.LIVE, retina: 2 === window.devicePixelRatio, base_path: env.BASE_PATH, share_url: window.location.href }, i.retina_scale = i.retina ? 2 : 1, t.exports = i }, function (t, e, i) { var n, o, s; s = i(10), n = i(12), o = new n, window.gui = o, t.exports = o }, function (t, e, i) { var n, o, s, r; r = i(10), r.live ? (n = function () { function t() { } return t.prototype.add = function () { return this }, t.prototype.listen = function () { return this }, t.prototype.name = function () { return this }, t.prototype.open = function () { return this }, t.prototype.onChange = function () { return this }, t.prototype.addFolder = function () { return new t }, t.prototype.addColor = function () { return this }, t }(), o = function () { function t() { } return t.prototype.add = function () { return this }, t.prototype.addFolder = function () { return new n }, t.prototype.name = function () { return this }, t.prototype.close = function () { return this }, t.prototype.step = function () { return this }, t.prototype.onChange = function () { return this }, t.prototype.setValue = function () { return this }, t }(), t.exports = o) : (s = i(13), t.exports = s.GUI) }, function (t, e, i) { t.exports = i(14), t.exports.color = i(15) }, function (t, e) {
        var i = t.exports = i || {}; i.gui = i.gui || {}, i.utils = i.utils || {}, i.controllers = i.controllers || {}, i.dom = i.dom || {}, i.color = i.color || {}, i.utils.css = function () { return { load: function (t, e) { e = e || document; var i = e.createElement("link"); i.type = "text/css", i.rel = "stylesheet", i.href = t, e.getElementsByTagName("head")[0].appendChild(i) }, inject: function (t, e) { e = e || document; var i = document.createElement("style"); i.type = "text/css", i.innerHTML = t, e.getElementsByTagName("head")[0].appendChild(i) } } }(), i.utils.common = function () { var t = Array.prototype.forEach, e = Array.prototype.slice; return { BREAK: {}, extend: function (t) { return this.each(e.call(arguments, 1), function (e) { for (var i in e) this.isUndefined(e[i]) || (t[i] = e[i]) }, this), t }, defaults: function (t) { return this.each(e.call(arguments, 1), function (e) { for (var i in e) this.isUndefined(t[i]) && (t[i] = e[i]) }, this), t }, compose: function () { var t = e.call(arguments); return function () { for (var i = e.call(arguments), n = t.length - 1; n >= 0; n--)i = [t[n].apply(this, i)]; return i[0] } }, each: function (e, i, n) { if (t && e.forEach === t) e.forEach(i, n); else if (e.length === e.length + 0) { for (var o = 0, s = e.length; s > o; o++)if (o in e && i.call(n, e[o], o) === this.BREAK) return } else for (var o in e) if (i.call(n, e[o], o) === this.BREAK) return }, defer: function (t) { setTimeout(t, 0) }, toArray: function (t) { return t.toArray ? t.toArray() : e.call(t) }, isUndefined: function (t) { return void 0 === t }, isNull: function (t) { return null === t }, isNaN: function (t) { return t !== t }, isArray: Array.isArray || function (t) { return t.constructor === Array }, isObject: function (t) { return t === Object(t) }, isNumber: function (t) { return t === t + 0 }, isString: function (t) { return t === t + "" }, isBoolean: function (t) { return t === !1 || t === !0 }, isFunction: function (t) { return "[object Function]" === Object.prototype.toString.call(t) } } }(), i.controllers.Controller = function (t) { var e = function (t, e) { this.initialValue = t[e], this.domElement = document.createElement("div"), this.object = t, this.property = e, this.__onChange = void 0, this.__onFinishChange = void 0 }; return t.extend(e.prototype, { onChange: function (t) { return this.__onChange = t, this }, onFinishChange: function (t) { return this.__onFinishChange = t, this }, setValue: function (t) { return this.object[this.property] = t, this.__onChange && this.__onChange.call(this, t), this.updateDisplay(), this }, getValue: function () { return this.object[this.property] }, updateDisplay: function () { return this }, isModified: function () { return this.initialValue !== this.getValue() } }), e }(i.utils.common), i.dom.dom = function (t) { function e(e) { if ("0" === e || t.isUndefined(e)) return 0; var i = e.match(o); return t.isNull(i) ? 0 : parseFloat(i[1]) } var i = { HTMLEvents: ["change"], MouseEvents: ["click", "mousemove", "mousedown", "mouseup", "mouseover"], KeyboardEvents: ["keydown"] }, n = {}; t.each(i, function (e, i) { t.each(e, function (t) { n[t] = i }) }); var o = /(\d+(\.\d+)?)px/, s = { makeSelectable: function (t, e) { void 0 !== t && void 0 !== t.style && (t.onselectstart = e ? function () { return !1 } : function () { }, t.style.MozUserSelect = e ? "auto" : "none", t.style.KhtmlUserSelect = e ? "auto" : "none", t.unselectable = e ? "on" : "off") }, makeFullscreen: function (e, i, n) { t.isUndefined(i) && (i = !0), t.isUndefined(n) && (n = !0), e.style.position = "absolute", i && (e.style.left = 0, e.style.right = 0), n && (e.style.top = 0, e.style.bottom = 0) }, fakeEvent: function (e, i, o, s) { o = o || {}; var r = n[i]; if (!r) throw new Error("Event type " + i + " not supported."); var a = document.createEvent(r); switch (r) { case "MouseEvents": var u = o.x || o.clientX || 0, h = o.y || o.clientY || 0; a.initMouseEvent(i, o.bubbles || !1, o.cancelable || !0, window, o.clickCount || 1, 0, 0, u, h, !1, !1, !1, !1, 0, null); break; case "KeyboardEvents": var l = a.initKeyboardEvent || a.initKeyEvent; t.defaults(o, { cancelable: !0, ctrlKey: !1, altKey: !1, shiftKey: !1, metaKey: !1, keyCode: void 0, charCode: void 0 }), l(i, o.bubbles || !1, o.cancelable, window, o.ctrlKey, o.altKey, o.shiftKey, o.metaKey, o.keyCode, o.charCode); break; default: a.initEvent(i, o.bubbles || !1, o.cancelable || !0) }t.defaults(a, s), e.dispatchEvent(a) }, bind: function (t, e, i, n) { return n = n || !1, t.addEventListener ? t.addEventListener(e, i, n) : t.attachEvent && t.attachEvent("on" + e, i), s }, unbind: function (t, e, i, n) { return n = n || !1, t.removeEventListener ? t.removeEventListener(e, i, n) : t.detachEvent && t.detachEvent("on" + e, i), s }, addClass: function (t, e) { if (void 0 === t.className) t.className = e; else if (t.className !== e) { var i = t.className.split(/ +/); -1 == i.indexOf(e) && (i.push(e), t.className = i.join(" ").replace(/^\s+/, "").replace(/\s+$/, "")) } return s }, removeClass: function (t, e) { if (e) if (void 0 === t.className); else if (t.className === e) t.removeAttribute("class"); else { var i = t.className.split(/ +/), n = i.indexOf(e); -1 != n && (i.splice(n, 1), t.className = i.join(" ")) } else t.className = void 0; return s }, hasClass: function (t, e) { return new RegExp("(?:^|\\s+)" + e + "(?:\\s+|$)").test(t.className) || !1 }, getWidth: function (t) { var i = getComputedStyle(t); return e(i["border-left-width"]) + e(i["border-right-width"]) + e(i["padding-left"]) + e(i["padding-right"]) + e(i.width) }, getHeight: function (t) { var i = getComputedStyle(t); return e(i["border-top-width"]) + e(i["border-bottom-width"]) + e(i["padding-top"]) + e(i["padding-bottom"]) + e(i.height) }, getOffset: function (t) { var e = { left: 0, top: 0 }; if (t.offsetParent) do e.left += t.offsetLeft, e.top += t.offsetTop; while (t = t.offsetParent); return e }, isActive: function (t) { return t === document.activeElement && (t.type || t.href) } }; return s }(i.utils.common), i.controllers.OptionController = function (t, e, i) { var n = function (t, o, s) { n.superclass.call(this, t, o); var r = this; if (this.__select = document.createElement("select"), i.isArray(s)) { var a = {}; i.each(s, function (t) { a[t] = t }), s = a } i.each(s, function (t, e) { var i = document.createElement("option"); i.innerHTML = e, i.setAttribute("value", t), r.__select.appendChild(i) }), this.updateDisplay(), e.bind(this.__select, "change", function () { var t = this.options[this.selectedIndex].value; r.setValue(t) }), this.domElement.appendChild(this.__select) }; return n.superclass = t, i.extend(n.prototype, t.prototype, { setValue: function (t) { var e = n.superclass.prototype.setValue.call(this, t); return this.__onFinishChange && this.__onFinishChange.call(this, this.getValue()), e }, updateDisplay: function () { return this.__select.value = this.getValue(), n.superclass.prototype.updateDisplay.call(this) } }), n }(i.controllers.Controller, i.dom.dom, i.utils.common), i.controllers.NumberController = function (t, e) { function i(t) { return t = t.toString(), t.indexOf(".") > -1 ? t.length - t.indexOf(".") - 1 : 0 } var n = function (t, o, s) { n.superclass.call(this, t, o), s = s || {}, this.__min = s.min, this.__max = s.max, this.__step = s.step, e.isUndefined(this.__step) ? 0 == this.initialValue ? this.__impliedStep = 1 : this.__impliedStep = Math.pow(10, Math.floor(Math.log(this.initialValue) / Math.LN10)) / 10 : this.__impliedStep = this.__step, this.__precision = i(this.__impliedStep) }; return n.superclass = t, e.extend(n.prototype, t.prototype, { setValue: function (t) { return void 0 !== this.__min && t < this.__min ? t = this.__min : void 0 !== this.__max && t > this.__max && (t = this.__max), void 0 !== this.__step && t % this.__step != 0 && (t = Math.round(t / this.__step) * this.__step), n.superclass.prototype.setValue.call(this, t) }, min: function (t) { return this.__min = t, this }, max: function (t) { return this.__max = t, this }, step: function (t) { return this.__step = t, this } }), n }(i.controllers.Controller, i.utils.common), i.controllers.NumberControllerBox = function (t, e, i) { function n(t, e) { var i = Math.pow(10, e); return Math.round(t * i) / i } var o = function (t, n, s) { function r() { var t = parseFloat(d.__input.value); i.isNaN(t) || d.setValue(t) } function a() { r(), d.__onFinishChange && d.__onFinishChange.call(d, d.getValue()) } function u(t) { e.bind(window, "mousemove", h), e.bind(window, "mouseup", l), c = t.clientY } function h(t) { var e = c - t.clientY; d.setValue(d.getValue() + e * d.__impliedStep), c = t.clientY } function l() { e.unbind(window, "mousemove", h), e.unbind(window, "mouseup", l) } this.__truncationSuspended = !1, o.superclass.call(this, t, n, s); var c, d = this; this.__input = document.createElement("input"), this.__input.setAttribute("type", "text"), e.bind(this.__input, "change", r), e.bind(this.__input, "blur", a), e.bind(this.__input, "mousedown", u), e.bind(this.__input, "keydown", function (t) { 13 === t.keyCode && (d.__truncationSuspended = !0, this.blur(), d.__truncationSuspended = !1) }), this.updateDisplay(), this.domElement.appendChild(this.__input) }; return o.superclass = t, i.extend(o.prototype, t.prototype, { updateDisplay: function () { return this.__input.value = this.__truncationSuspended ? this.getValue() : n(this.getValue(), this.__precision), o.superclass.prototype.updateDisplay.call(this) } }), o }(i.controllers.NumberController, i.dom.dom, i.utils.common), i.controllers.NumberControllerSlider = function (t, e, i, n, o) { function s(t, e, i, n, o) { return n + (o - n) * ((t - e) / (i - e)) } var r = function (t, i, n, o, a) { function u(t) { e.bind(window, "mousemove", h), e.bind(window, "mouseup", l), h(t) } function h(t) { t.preventDefault(); var i = e.getOffset(c.__background), n = e.getWidth(c.__background); return c.setValue(s(t.clientX, i.left, i.left + n, c.__min, c.__max)), !1 } function l() { e.unbind(window, "mousemove", h), e.unbind(window, "mouseup", l), c.__onFinishChange && c.__onFinishChange.call(c, c.getValue()) } r.superclass.call(this, t, i, { min: n, max: o, step: a }); var c = this; this.__background = document.createElement("div"), this.__foreground = document.createElement("div"), e.bind(this.__background, "mousedown", u), e.addClass(this.__background, "slider"), e.addClass(this.__foreground, "slider-fg"), this.updateDisplay(), this.__background.appendChild(this.__foreground), this.domElement.appendChild(this.__background) }; return r.superclass = t, r.useDefaultStyles = function () { i.inject(o) }, n.extend(r.prototype, t.prototype, { updateDisplay: function () { var t = (this.getValue() - this.__min) / (this.__max - this.__min); return this.__foreground.style.width = 100 * t + "%", r.superclass.prototype.updateDisplay.call(this) } }), r }(i.controllers.NumberController, i.dom.dom, i.utils.css, i.utils.common, ".slider {\n  box-shadow: inset 0 2px 4px rgba(0,0,0,0.15);\n  height: 1em;\n  border-radius: 1em;\n  background-color: #eee;\n  padding: 0 0.5em;\n  overflow: hidden;\n}\n\n.slider-fg {\n  padding: 1px 0 2px 0;\n  background-color: #aaa;\n  height: 1em;\n  margin-left: -0.5em;\n  padding-right: 0.5em;\n  border-radius: 1em 0 0 1em;\n}\n\n.slider-fg:after {\n  display: inline-block;\n  border-radius: 1em;\n  background-color: #fff;\n  border:  1px solid #aaa;\n  content: '';\n  float: right;\n  margin-right: -1em;\n  margin-top: -1px;\n  height: 0.9em;\n  width: 0.9em;\n}"), i.controllers.FunctionController = function (t, e, i) { var n = function (t, i, o) { n.superclass.call(this, t, i); var s = this; this.__button = document.createElement("div"), this.__button.innerHTML = void 0 === o ? "Fire" : o, e.bind(this.__button, "click", function (t) { return t.preventDefault(), s.fire(), !1 }), e.addClass(this.__button, "button"), this.domElement.appendChild(this.__button) }; return n.superclass = t, i.extend(n.prototype, t.prototype, { fire: function () { this.__onChange && this.__onChange.call(this), this.__onFinishChange && this.__onFinishChange.call(this, this.getValue()), this.getValue().call(this.object) } }), n }(i.controllers.Controller, i.dom.dom, i.utils.common), i.controllers.BooleanController = function (t, e, i) { var n = function (t, i) { function o() { s.setValue(!s.__prev) } n.superclass.call(this, t, i); var s = this; this.__prev = this.getValue(), this.__checkbox = document.createElement("input"), this.__checkbox.setAttribute("type", "checkbox"), e.bind(this.__checkbox, "change", o, !1), this.domElement.appendChild(this.__checkbox), this.updateDisplay() }; return n.superclass = t, i.extend(n.prototype, t.prototype, { setValue: function (t) { var e = n.superclass.prototype.setValue.call(this, t); return this.__onFinishChange && this.__onFinishChange.call(this, this.getValue()), this.__prev = this.getValue(), e }, updateDisplay: function () { return this.getValue() === !0 ? (this.__checkbox.setAttribute("checked", "checked"), this.__checkbox.checked = !0) : this.__checkbox.checked = !1, n.superclass.prototype.updateDisplay.call(this) } }), n }(i.controllers.Controller, i.dom.dom, i.utils.common), i.color.toString = function (t) { return function (e) { if (1 == e.a || t.isUndefined(e.a)) { for (var i = e.hex.toString(16); i.length < 6;)i = "0" + i; return "#" + i } return "rgba(" + Math.round(e.r) + "," + Math.round(e.g) + "," + Math.round(e.b) + "," + e.a + ")" } }(i.utils.common), i.color.interpret = function (t, e) { var i, n, o = function () { n = !1; var t = arguments.length > 1 ? e.toArray(arguments) : arguments[0]; return e.each(s, function (o) { return o.litmus(t) ? (e.each(o.conversions, function (o, s) { return i = o.read(t), n === !1 && i !== !1 ? (n = i, i.conversionName = s, i.conversion = o, e.BREAK) : void 0 }), e.BREAK) : void 0 }), n }, s = [{ litmus: e.isString, conversions: { THREE_CHAR_HEX: { read: function (t) { var e = t.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i); return null === e ? !1 : { space: "HEX", hex: parseInt("0x" + e[1].toString() + e[1].toString() + e[2].toString() + e[2].toString() + e[3].toString() + e[3].toString()) } }, write: t }, SIX_CHAR_HEX: { read: function (t) { var e = t.match(/^#([A-F0-9]{6})$/i); return null === e ? !1 : { space: "HEX", hex: parseInt("0x" + e[1].toString()) } }, write: t }, CSS_RGB: { read: function (t) { var e = t.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/); return null === e ? !1 : { space: "RGB", r: parseFloat(e[1]), g: parseFloat(e[2]), b: parseFloat(e[3]) } }, write: t }, CSS_RGBA: { read: function (t) { var e = t.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\,\s*(.+)\s*\)/); return null === e ? !1 : { space: "RGB", r: parseFloat(e[1]), g: parseFloat(e[2]), b: parseFloat(e[3]), a: parseFloat(e[4]) } }, write: t } } }, { litmus: e.isNumber, conversions: { HEX: { read: function (t) { return { space: "HEX", hex: t, conversionName: "HEX" } }, write: function (t) { return t.hex } } } }, { litmus: e.isArray, conversions: { RGB_ARRAY: { read: function (t) { return 3 != t.length ? !1 : { space: "RGB", r: t[0], g: t[1], b: t[2] } }, write: function (t) { return [t.r, t.g, t.b] } }, RGBA_ARRAY: { read: function (t) { return 4 != t.length ? !1 : { space: "RGB", r: t[0], g: t[1], b: t[2], a: t[3] } }, write: function (t) { return [t.r, t.g, t.b, t.a] } } } }, { litmus: e.isObject, conversions: { RGBA_OBJ: { read: function (t) { return e.isNumber(t.r) && e.isNumber(t.g) && e.isNumber(t.b) && e.isNumber(t.a) ? { space: "RGB", r: t.r, g: t.g, b: t.b, a: t.a } : !1 }, write: function (t) { return { r: t.r, g: t.g, b: t.b, a: t.a } } }, RGB_OBJ: { read: function (t) { return e.isNumber(t.r) && e.isNumber(t.g) && e.isNumber(t.b) ? { space: "RGB", r: t.r, g: t.g, b: t.b } : !1 }, write: function (t) { return { r: t.r, g: t.g, b: t.b } } }, HSVA_OBJ: { read: function (t) { return e.isNumber(t.h) && e.isNumber(t.s) && e.isNumber(t.v) && e.isNumber(t.a) ? { space: "HSV", h: t.h, s: t.s, v: t.v, a: t.a } : !1 }, write: function (t) { return { h: t.h, s: t.s, v: t.v, a: t.a } } }, HSV_OBJ: { read: function (t) { return e.isNumber(t.h) && e.isNumber(t.s) && e.isNumber(t.v) ? { space: "HSV", h: t.h, s: t.s, v: t.v } : !1 }, write: function (t) { return { h: t.h, s: t.s, v: t.v } } } } }]; return o }(i.color.toString, i.utils.common), i.GUI = i.gui.GUI = function (t, e, i, n, o, s, r, a, u, h, l, c, d, p, _) {
            function f(t, e, i, s) { if (void 0 === e[i]) throw new Error("Object " + e + ' has no property "' + i + '"'); var r; if (s.color) r = new l(e, i); else { var a = [e, i].concat(s.factoryArgs); r = n.apply(t, a) } s.before instanceof o && (s.before = s.before.__li), y(t, r), p.addClass(r.domElement, "c"); var u = document.createElement("span"); p.addClass(u, "property-name"), u.innerHTML = r.property; var h = document.createElement("div"); h.appendChild(u), h.appendChild(r.domElement); var c = m(t, h, s.before); return p.addClass(c, j.CLASS_CONTROLLER_ROW), p.addClass(c, typeof r.getValue()), g(t, c, r), t.__controllers.push(r), r } function m(t, e, i) { var n = document.createElement("li"); return e && n.appendChild(e), i ? t.__ul.insertBefore(n, params.before) : t.__ul.appendChild(n), t.onResize(), n } function g(t, e, i) { if (i.__li = e, i.__gui = t, _.extend(i, { options: function (e) { return arguments.length > 1 ? (i.remove(), f(t, i.object, i.property, { before: i.__li.nextElementSibling, factoryArgs: [_.toArray(arguments)] })) : _.isArray(e) || _.isObject(e) ? (i.remove(), f(t, i.object, i.property, { before: i.__li.nextElementSibling, factoryArgs: [e] })) : void 0 }, name: function (t) { return i.__li.firstElementChild.firstElementChild.innerHTML = t, i }, listen: function () { return i.__gui.listen(i), i }, remove: function () { return i.__gui.remove(i), i } }), i instanceof u) { var n = new a(i.object, i.property, { min: i.__min, max: i.__max, step: i.__step }); _.each(["updateDisplay", "onChange", "onFinishChange"], function (t) { var e = i[t], o = n[t]; i[t] = n[t] = function () { var t = Array.prototype.slice.call(arguments); return e.apply(i, t), o.apply(n, t) } }), p.addClass(e, "has-slider"), i.domElement.insertBefore(n.domElement, i.domElement.firstElementChild) } else if (i instanceof a) { var o = function (e) { return _.isNumber(i.__min) && _.isNumber(i.__max) ? (i.remove(), f(t, i.object, i.property, { before: i.__li.nextElementSibling, factoryArgs: [i.__min, i.__max, i.__step] })) : e }; i.min = _.compose(o, i.min), i.max = _.compose(o, i.max) } else i instanceof s ? (p.bind(e, "click", function () { p.fakeEvent(i.__checkbox, "click") }), p.bind(i.__checkbox, "click", function (t) { t.stopPropagation() })) : i instanceof r ? (p.bind(e, "click", function () { p.fakeEvent(i.__button, "click") }), p.bind(e, "mouseover", function () { p.addClass(i.__button, "hover") }), p.bind(e, "mouseout", function () { p.removeClass(i.__button, "hover") })) : i instanceof l && (p.addClass(e, "color"), i.updateDisplay = _.compose(function (t) { return e.style.borderLeftColor = i.__color.toString(), t }, i.updateDisplay), i.updateDisplay()); i.setValue = _.compose(function (e) { return t.getRoot().__preset_select && i.isModified() && z(t.getRoot(), !0), e }, i.setValue) } function y(t, e) { var i = t.getRoot(), n = i.__rememberedObjects.indexOf(e.object); if (-1 != n) { var o = i.__rememberedObjectIndecesToControllers[n]; if (void 0 === o && (o = {}, i.__rememberedObjectIndecesToControllers[n] = o), o[e.property] = e, i.load && i.load.remembered) { var s, r = i.load.remembered; if (r[t.preset]) s = r[t.preset]; else { if (!r[P]) return; s = r[P] } if (s[n] && void 0 !== s[n][e.property]) { var a = s[n][e.property]; e.initialValue = a, e.setValue(a) } } } } function v(t, e) { return document.location.href + "." + e } function b(t) {
                function e() { h.style.display = t.useLocalStorage ? "block" : "none" } var i = t.__save_row = document.createElement("li"); p.addClass(t.domElement, "has-save"), t.__ul.insertBefore(i, t.__ul.firstChild), p.addClass(i, "save-row"); var n = document.createElement("span"); n.innerHTML = "&nbsp;", p.addClass(n, "button gears"); var o = document.createElement("span"); o.innerHTML = "Save", p.addClass(o, "button"), p.addClass(o, "save"); var s = document.createElement("span"); s.innerHTML = "New", p.addClass(s, "button"), p.addClass(s, "save-as"); var r = document.createElement("span"); r.innerHTML = "Revert", p.addClass(r, "button"), p.addClass(r, "revert"); var a = t.__preset_select = document.createElement("select"); if (t.load && t.load.remembered ? _.each(t.load.remembered, function (e, i) { k(t, i, i == t.preset) }) : k(t, P, !1), p.bind(a, "change", function () {
                    for (var e = 0; e < t.__preset_select.length; e++)t.__preset_select[e].innerHTML = t.__preset_select[e].value; t.preset = this.value
                }), i.appendChild(a), i.appendChild(n), i.appendChild(o), i.appendChild(s), i.appendChild(r), L) { var u = document.getElementById("dg-save-locally"), h = document.getElementById("dg-local-explain"); u.style.display = "block"; var l = document.getElementById("dg-local-storage"); "true" === localStorage.getItem(v(t, "isLocal")) && l.setAttribute("checked", "checked"), e(), p.bind(l, "change", function () { t.useLocalStorage = !t.useLocalStorage, e() }) } var c = document.getElementById("dg-new-constructor"); p.bind(c, "keydown", function (t) { !t.metaKey || 67 !== t.which && 67 != t.keyCode || C.hide() }), p.bind(n, "click", function () { c.innerHTML = JSON.stringify(t.getSaveObject(), void 0, 2), C.show(), c.focus(), c.select() }), p.bind(o, "click", function () { t.save() }), p.bind(s, "click", function () { var e = prompt("Enter a new preset name."); e && t.saveAs(e) }), p.bind(r, "click", function () { t.revert() })
            } function w(t) { function e(e) { return e.preventDefault(), o = e.clientX, p.addClass(t.__closeButton, j.CLASS_DRAG), p.bind(window, "mousemove", i), p.bind(window, "mouseup", n), !1 } function i(e) { return e.preventDefault(), t.width += o - e.clientX, t.onResize(), o = e.clientX, !1 } function n() { p.removeClass(t.__closeButton, j.CLASS_DRAG), p.unbind(window, "mousemove", i), p.unbind(window, "mouseup", n) } t.__resize_handle = document.createElement("div"), _.extend(t.__resize_handle.style, { width: "6px", marginLeft: "-3px", height: "200px", cursor: "ew-resize", position: "absolute" }); var o; p.bind(t.__resize_handle, "mousedown", e), p.bind(t.__closeButton, "mousedown", e), t.domElement.insertBefore(t.__resize_handle, t.domElement.firstElementChild) } function x(t, e) { t.domElement.style.width = e + "px", t.__save_row && t.autoPlace && (t.__save_row.style.width = e + "px"), t.__closeButton && (t.__closeButton.style.width = e + "px") } function E(t, e) { var i = {}; return _.each(t.__rememberedObjects, function (n, o) { var s = {}, r = t.__rememberedObjectIndecesToControllers[o]; _.each(r, function (t, i) { s[i] = e ? t.initialValue : t.getValue() }), i[o] = s }), i } function k(t, e, i) { var n = document.createElement("option"); n.innerHTML = e, n.value = e, t.__preset_select.appendChild(n), i && (t.__preset_select.selectedIndex = t.__preset_select.length - 1) } function T(t) { for (var e = 0; e < t.__preset_select.length; e++)t.__preset_select[e].value == t.preset && (t.__preset_select.selectedIndex = e) } function z(t, e) { var i = t.__preset_select[t.__preset_select.selectedIndex]; e ? i.innerHTML = i.value + "*" : i.innerHTML = i.value } function R(t) { 0 != t.length && c(function () { R(t) }), _.each(t, function (t) { t.updateDisplay() }) } t.inject(i); var C, A, H = "dg", M = 72, S = 20, P = "Default", L = function () { try { return "localStorage" in window && null !== window.localStorage } catch (t) { return !1 } }(), O = !0, I = !1, F = [], j = function (t) { function e() { localStorage.setItem(v(n, "gui"), JSON.stringify(n.getSaveObject())) } function i() { var t = n.getRoot(); t.width += 1, _.defer(function () { t.width -= 1 }) } var n = this; this.domElement = document.createElement("div"), this.__ul = document.createElement("ul"), this.domElement.appendChild(this.__ul), p.addClass(this.domElement, H), this.__folders = {}, this.__controllers = [], this.__rememberedObjects = [], this.__rememberedObjectIndecesToControllers = [], this.__listening = [], t = t || {}, t = _.defaults(t, { autoPlace: !0, width: j.DEFAULT_WIDTH }), t = _.defaults(t, { resizable: t.autoPlace, hideable: t.autoPlace }), _.isUndefined(t.load) ? t.load = { preset: P } : t.preset && (t.load.preset = t.preset), _.isUndefined(t.parent) && t.hideable && F.push(this), t.resizable = _.isUndefined(t.parent) && t.resizable, t.autoPlace && _.isUndefined(t.scrollable) && (t.scrollable = !0); var o = L && "true" === localStorage.getItem(v(this, "isLocal")); if (Object.defineProperties(this, { parent: { get: function () { return t.parent } }, scrollable: { get: function () { return t.scrollable } }, autoPlace: { get: function () { return t.autoPlace } }, preset: { get: function () { return n.parent ? n.getRoot().preset : t.load.preset }, set: function (e) { n.parent ? n.getRoot().preset = e : t.load.preset = e, T(this), n.revert() } }, width: { get: function () { return t.width }, set: function (e) { t.width = e, x(n, e) } }, name: { get: function () { return t.name }, set: function (e) { t.name = e, r && (r.innerHTML = t.name) } }, closed: { get: function () { return t.closed }, set: function (e) { t.closed = e, t.closed ? p.addClass(n.__ul, j.CLASS_CLOSED) : p.removeClass(n.__ul, j.CLASS_CLOSED), this.onResize(), n.__closeButton && (n.__closeButton.innerHTML = e ? j.TEXT_OPEN : j.TEXT_CLOSED) } }, load: { get: function () { return t.load } }, useLocalStorage: { get: function () { return o }, set: function (t) { L && (o = t, t ? p.bind(window, "unload", e) : p.unbind(window, "unload", e), localStorage.setItem(v(n, "isLocal"), t)) } } }), _.isUndefined(t.parent)) { if (t.closed = !1, p.addClass(this.domElement, j.CLASS_MAIN), p.makeSelectable(this.domElement, !1), L && o) { n.useLocalStorage = !0; var s = localStorage.getItem(v(this, "gui")); s && (t.load = JSON.parse(s)) } this.__closeButton = document.createElement("div"), this.__closeButton.innerHTML = j.TEXT_CLOSED, p.addClass(this.__closeButton, j.CLASS_CLOSE_BUTTON), this.domElement.appendChild(this.__closeButton), p.bind(this.__closeButton, "click", function () { n.closed = !n.closed }) } else { void 0 === t.closed && (t.closed = !0); var r = document.createTextNode(t.name); p.addClass(r, "controller-name"); var a = m(n, r), u = function (t) { return t.preventDefault(), n.closed = !n.closed, !1 }; p.addClass(this.__ul, j.CLASS_CLOSED), p.addClass(a, "title"), p.bind(a, "click", u), t.closed || (this.closed = !1) } t.autoPlace && (_.isUndefined(t.parent) && (O && (A = document.createElement("div"), p.addClass(A, H), p.addClass(A, j.CLASS_AUTO_PLACE_CONTAINER), document.body.appendChild(A), O = !1), A.appendChild(this.domElement), p.addClass(this.domElement, j.CLASS_AUTO_PLACE)), this.parent || x(n, t.width)), p.bind(window, "resize", function () { n.onResize() }), p.bind(this.__ul, "webkitTransitionEnd", function () { n.onResize() }), p.bind(this.__ul, "transitionend", function () { n.onResize() }), p.bind(this.__ul, "oTransitionEnd", function () { n.onResize() }), this.onResize(), t.resizable && w(this); n.getRoot(); t.parent || i() }; return j.toggleHide = function () { I = !I, _.each(F, function (t) { t.domElement.style.zIndex = I ? -999 : 999, t.domElement.style.opacity = I ? 0 : 1 }) }, j.CLASS_AUTO_PLACE = "a", j.CLASS_AUTO_PLACE_CONTAINER = "ac", j.CLASS_MAIN = "main", j.CLASS_CONTROLLER_ROW = "cr", j.CLASS_TOO_TALL = "taller-than-window", j.CLASS_CLOSED = "closed", j.CLASS_CLOSE_BUTTON = "close-button", j.CLASS_DRAG = "drag", j.DEFAULT_WIDTH = 245, j.TEXT_CLOSED = "Close Controls", j.TEXT_OPEN = "Open Controls", p.bind(window, "keydown", function (t) { "text" === document.activeElement.type || t.which !== M && t.keyCode != M || j.toggleHide() }, !1), _.extend(j.prototype, { add: function (t, e) { return f(this, t, e, { factoryArgs: Array.prototype.slice.call(arguments, 2) }) }, addColor: function (t, e) { return f(this, t, e, { color: !0 }) }, remove: function (t) { this.__ul.removeChild(t.__li), this.__controllers.slice(this.__controllers.indexOf(t), 1); var e = this; _.defer(function () { e.onResize() }) }, destroy: function () { this.autoPlace && A.removeChild(this.domElement) }, addFolder: function (t) { if (void 0 !== this.__folders[t]) throw new Error('You already have a folder in this GUI by the name "' + t + '"'); var e = { name: t, parent: this }; e.autoPlace = this.autoPlace, this.load && this.load.folders && this.load.folders[t] && (e.closed = this.load.folders[t].closed, e.load = this.load.folders[t]); var i = new j(e); this.__folders[t] = i; var n = m(this, i.domElement); return p.addClass(n, "folder"), i }, open: function () { this.closed = !1 }, close: function () { this.closed = !0 }, onResize: function () { var t = this.getRoot(); if (t.scrollable) { var e = p.getOffset(t.__ul).top, i = 0; _.each(t.__ul.childNodes, function (e) { t.autoPlace && e === t.__save_row || (i += p.getHeight(e)) }), window.innerHeight - e - S < i ? (p.addClass(t.domElement, j.CLASS_TOO_TALL), t.__ul.style.height = window.innerHeight - e - S + "px") : (p.removeClass(t.domElement, j.CLASS_TOO_TALL), t.__ul.style.height = "auto") } t.__resize_handle && _.defer(function () { t.__resize_handle.style.height = t.__ul.offsetHeight + "px" }), t.__closeButton && (t.__closeButton.style.width = t.width + "px") }, remember: function () { if (_.isUndefined(C) && (C = new d, C.domElement.innerHTML = e), this.parent) throw new Error("You can only call remember on a top level GUI."); var t = this; _.each(Array.prototype.slice.call(arguments), function (e) { 0 == t.__rememberedObjects.length && b(t), -1 == t.__rememberedObjects.indexOf(e) && t.__rememberedObjects.push(e) }), this.autoPlace && x(this, this.width) }, getRoot: function () { for (var t = this; t.parent;)t = t.parent; return t }, getSaveObject: function () { var t = this.load; return t.closed = this.closed, this.__rememberedObjects.length > 0 && (t.preset = this.preset, t.remembered || (t.remembered = {}), t.remembered[this.preset] = E(this)), t.folders = {}, _.each(this.__folders, function (e, i) { t.folders[i] = e.getSaveObject() }), t }, save: function () { this.load.remembered || (this.load.remembered = {}), this.load.remembered[this.preset] = E(this), z(this, !1) }, saveAs: function (t) { this.load.remembered || (this.load.remembered = {}, this.load.remembered[P] = E(this, !0)), this.load.remembered[t] = E(this), this.preset = t, k(this, t, !0) }, revert: function (t) { _.each(this.__controllers, function (e) { this.getRoot().load.remembered ? y(t || this.getRoot(), e) : e.setValue(e.initialValue) }, this), _.each(this.__folders, function (t) { t.revert(t) }), t || z(this.getRoot(), !1) }, listen: function (t) { var e = 0 == this.__listening.length; this.__listening.push(t), e && R(this.__listening) } }), j
        }(i.utils.css, '<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n      \n    </div>\n    \n  </div>\n\n</div>', ".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity 0.1s linear;-o-transition:opacity 0.1s linear;-moz-transition:opacity 0.1s linear;transition:opacity 0.1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity 0.1s linear;-o-transition:opacity 0.1s linear;-moz-transition:opacity 0.1s linear;transition:opacity 0.1s linear;border:0;position:absolute;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-x:hidden}.dg.a.has-save ul{margin-top:27px}.dg.a.has-save ul.closed{margin-top:0}.dg.a .save-row{position:fixed;top:0;z-index:1002}.dg li{-webkit-transition:height 0.1s ease-out;-o-transition:height 0.1s ease-out;-moz-transition:height 0.1s ease-out;transition:height 0.1s ease-out}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;overflow:hidden;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li > *{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:9px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2fa1d6}.dg .cr.number input[type=text]{color:#2fa1d6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2fa1d6}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\n", i.controllers.factory = function (t, e, i, n, o, s, r) { return function (a, u) { var h = a[u]; return r.isArray(arguments[2]) || r.isObject(arguments[2]) ? new t(a, u, arguments[2]) : r.isNumber(h) ? r.isNumber(arguments[2]) && r.isNumber(arguments[3]) ? new i(a, u, arguments[2], arguments[3]) : new e(a, u, { min: arguments[2], max: arguments[3] }) : r.isString(h) ? new n(a, u) : r.isFunction(h) ? new o(a, u, "") : r.isBoolean(h) ? new s(a, u) : void 0 } }(i.controllers.OptionController, i.controllers.NumberControllerBox, i.controllers.NumberControllerSlider, i.controllers.StringController = function (t, e, i) { var n = function (t, i) { function o() { r.setValue(r.__input.value) } function s() { r.__onFinishChange && r.__onFinishChange.call(r, r.getValue()) } n.superclass.call(this, t, i); var r = this; this.__input = document.createElement("input"), this.__input.setAttribute("type", "text"), e.bind(this.__input, "keyup", o), e.bind(this.__input, "change", o), e.bind(this.__input, "blur", s), e.bind(this.__input, "keydown", function (t) { 13 === t.keyCode && this.blur() }), this.updateDisplay(), this.domElement.appendChild(this.__input) }; return n.superclass = t, i.extend(n.prototype, t.prototype, { updateDisplay: function () { return e.isActive(this.__input) || (this.__input.value = this.getValue()), n.superclass.prototype.updateDisplay.call(this) } }), n }(i.controllers.Controller, i.dom.dom, i.utils.common), i.controllers.FunctionController, i.controllers.BooleanController, i.utils.common), i.controllers.Controller, i.controllers.BooleanController, i.controllers.FunctionController, i.controllers.NumberControllerBox, i.controllers.NumberControllerSlider, i.controllers.OptionController, i.controllers.ColorController = function (t, e, i, n, o) { function s(t, e, i, n) { t.style.background = "", o.each(u, function (o) { t.style.cssText += "background: " + o + "linear-gradient(" + e + ", " + i + " 0%, " + n + " 100%); " }) } function r(t) { t.style.background = "", t.style.cssText += "background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);", t.style.cssText += "background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);", t.style.cssText += "background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);", t.style.cssText += "background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);", t.style.cssText += "background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);" } var a = function (t, u) { function h(t) { p(t), e.bind(window, "mousemove", p), e.bind(window, "mouseup", l) } function l() { e.unbind(window, "mousemove", p), e.unbind(window, "mouseup", l) } function c() { var t = n(this.value); t !== !1 ? (f.__color.__state = t, f.setValue(f.__color.toOriginal())) : this.value = f.__color.toString() } function d() { e.unbind(window, "mousemove", _), e.unbind(window, "mouseup", d) } function p(t) { t.preventDefault(); var i = e.getWidth(f.__saturation_field), n = e.getOffset(f.__saturation_field), o = (t.clientX - n.left + document.body.scrollLeft) / i, s = 1 - (t.clientY - n.top + document.body.scrollTop) / i; return s > 1 ? s = 1 : 0 > s && (s = 0), o > 1 ? o = 1 : 0 > o && (o = 0), f.__color.v = s, f.__color.s = o, f.setValue(f.__color.toOriginal()), !1 } function _(t) { t.preventDefault(); var i = e.getHeight(f.__hue_field), n = e.getOffset(f.__hue_field), o = 1 - (t.clientY - n.top + document.body.scrollTop) / i; return o > 1 ? o = 1 : 0 > o && (o = 0), f.__color.h = 360 * o, f.setValue(f.__color.toOriginal()), !1 } a.superclass.call(this, t, u), this.__color = new i(this.getValue()), this.__temp = new i(0); var f = this; this.domElement = document.createElement("div"), e.makeSelectable(this.domElement, !1), this.__selector = document.createElement("div"), this.__selector.className = "selector", this.__saturation_field = document.createElement("div"), this.__saturation_field.className = "saturation-field", this.__field_knob = document.createElement("div"), this.__field_knob.className = "field-knob", this.__field_knob_border = "2px solid ", this.__hue_knob = document.createElement("div"), this.__hue_knob.className = "hue-knob", this.__hue_field = document.createElement("div"), this.__hue_field.className = "hue-field", this.__input = document.createElement("input"), this.__input.type = "text", this.__input_textShadow = "0 1px 1px ", e.bind(this.__input, "keydown", function (t) { 13 === t.keyCode && c.call(this) }), e.bind(this.__input, "blur", c), e.bind(this.__selector, "mousedown", function (t) { e.addClass(this, "drag").bind(window, "mouseup", function (t) { e.removeClass(f.__selector, "drag") }) }); var m = document.createElement("div"); o.extend(this.__selector.style, { width: "122px", height: "102px", padding: "3px", backgroundColor: "#222", boxShadow: "0px 1px 3px rgba(0,0,0,0.3)" }), o.extend(this.__field_knob.style, { position: "absolute", width: "12px", height: "12px", border: this.__field_knob_border + (this.__color.v < .5 ? "#fff" : "#000"), boxShadow: "0px 1px 3px rgba(0,0,0,0.5)", borderRadius: "12px", zIndex: 1 }), o.extend(this.__hue_knob.style, { position: "absolute", width: "15px", height: "2px", borderRight: "4px solid #fff", zIndex: 1 }), o.extend(this.__saturation_field.style, { width: "100px", height: "100px", border: "1px solid #555", marginRight: "3px", display: "inline-block", cursor: "pointer" }), o.extend(m.style, { width: "100%", height: "100%", background: "none" }), s(m, "top", "rgba(0,0,0,0)", "#000"), o.extend(this.__hue_field.style, { width: "15px", height: "100px", display: "inline-block", border: "1px solid #555", cursor: "ns-resize" }), r(this.__hue_field), o.extend(this.__input.style, { outline: "none", textAlign: "center", color: "#fff", border: 0, fontWeight: "bold", textShadow: this.__input_textShadow + "rgba(0,0,0,0.7)" }), e.bind(this.__saturation_field, "mousedown", h), e.bind(this.__field_knob, "mousedown", h), e.bind(this.__hue_field, "mousedown", function (t) { _(t), e.bind(window, "mousemove", _), e.bind(window, "mouseup", d) }), this.__saturation_field.appendChild(m), this.__selector.appendChild(this.__field_knob), this.__selector.appendChild(this.__saturation_field), this.__selector.appendChild(this.__hue_field), this.__hue_field.appendChild(this.__hue_knob), this.domElement.appendChild(this.__input), this.domElement.appendChild(this.__selector), this.updateDisplay() }; a.superclass = t, o.extend(a.prototype, t.prototype, { updateDisplay: function () { var t = n(this.getValue()); if (t !== !1) { var e = !1; o.each(i.COMPONENTS, function (i) { return o.isUndefined(t[i]) || o.isUndefined(this.__color.__state[i]) || t[i] === this.__color.__state[i] ? void 0 : (e = !0, {}) }, this), e && o.extend(this.__color.__state, t) } o.extend(this.__temp.__state, this.__color.__state), this.__temp.a = 1; var r = this.__color.v < .5 || this.__color.s > .5 ? 255 : 0, a = 255 - r; o.extend(this.__field_knob.style, { marginLeft: 100 * this.__color.s - 7 + "px", marginTop: 100 * (1 - this.__color.v) - 7 + "px", backgroundColor: this.__temp.toString(), border: this.__field_knob_border + "rgb(" + r + "," + r + "," + r + ")" }), this.__hue_knob.style.marginTop = 100 * (1 - this.__color.h / 360) + "px", this.__temp.s = 1, this.__temp.v = 1, s(this.__saturation_field, "left", "#fff", this.__temp.toString()), o.extend(this.__input.style, { backgroundColor: this.__input.value = this.__color.toString(), color: "rgb(" + r + "," + r + "," + r + ")", textShadow: this.__input_textShadow + "rgba(" + a + "," + a + "," + a + ",.7)" }) } }); var u = ["-moz-", "-o-", "-webkit-", "-ms-", ""]; return a }(i.controllers.Controller, i.dom.dom, i.color.Color = function (t, e, i, n) { function o(t, e, i) { Object.defineProperty(t, e, { get: function () { return "RGB" === this.__state.space ? this.__state[e] : (r(this, e, i), this.__state[e]) }, set: function (t) { "RGB" !== this.__state.space && (r(this, e, i), this.__state.space = "RGB"), this.__state[e] = t } }) } function s(t, e) { Object.defineProperty(t, e, { get: function () { return "HSV" === this.__state.space ? this.__state[e] : (a(this), this.__state[e]) }, set: function (t) { "HSV" !== this.__state.space && (a(this), this.__state.space = "HSV"), this.__state[e] = t } }) } function r(t, i, o) { if ("HEX" === t.__state.space) t.__state[i] = e.component_from_hex(t.__state.hex, o); else { if ("HSV" !== t.__state.space) throw "Corrupted color state"; n.extend(t.__state, e.hsv_to_rgb(t.__state.h, t.__state.s, t.__state.v)) } } function a(t) { var i = e.rgb_to_hsv(t.r, t.g, t.b); n.extend(t.__state, { s: i.s, v: i.v }), n.isNaN(i.h) ? n.isUndefined(t.__state.h) && (t.__state.h = 0) : t.__state.h = i.h } var u = function () { if (this.__state = t.apply(this, arguments), this.__state === !1) throw "Failed to interpret color arguments"; this.__state.a = this.__state.a || 1 }; return u.COMPONENTS = ["r", "g", "b", "h", "s", "v", "hex", "a"], n.extend(u.prototype, { toString: function () { return i(this) }, toOriginal: function () { return this.__state.conversion.write(this) } }), o(u.prototype, "r", 2), o(u.prototype, "g", 1), o(u.prototype, "b", 0), s(u.prototype, "h"), s(u.prototype, "s"), s(u.prototype, "v"), Object.defineProperty(u.prototype, "a", { get: function () { return this.__state.a }, set: function (t) { this.__state.a = t } }), Object.defineProperty(u.prototype, "hex", { get: function () { return "HEX" !== !this.__state.space && (this.__state.hex = e.rgb_to_hex(this.r, this.g, this.b)), this.__state.hex }, set: function (t) { this.__state.space = "HEX", this.__state.hex = t } }), u }(i.color.interpret, i.color.math = function () { var t; return { hsv_to_rgb: function (t, e, i) { var n = Math.floor(t / 60) % 6, o = t / 60 - Math.floor(t / 60), s = i * (1 - e), r = i * (1 - o * e), a = i * (1 - (1 - o) * e), u = [[i, a, s], [r, i, s], [s, i, a], [s, r, i], [a, s, i], [i, s, r]][n]; return { r: 255 * u[0], g: 255 * u[1], b: 255 * u[2] } }, rgb_to_hsv: function (t, e, i) { var n, o, s = Math.min(t, e, i), r = Math.max(t, e, i), a = r - s; return 0 == r ? { h: NaN, s: 0, v: 0 } : (o = a / r, n = t == r ? (e - i) / a : e == r ? 2 + (i - t) / a : 4 + (t - e) / a, n /= 6, 0 > n && (n += 1), { h: 360 * n, s: o, v: r / 255 }) }, rgb_to_hex: function (t, e, i) { var n = this.hex_with_component(0, 2, t); return n = this.hex_with_component(n, 1, e), n = this.hex_with_component(n, 0, i) }, component_from_hex: function (t, e) { return t >> 8 * e & 255 }, hex_with_component: function (e, i, n) { return n << (t = 8 * i) | e & ~(255 << t) } } }(), i.color.toString, i.utils.common), i.color.interpret, i.utils.common), i.utils.requestAnimationFrame = function () { return window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame || function (t, e) { window.setTimeout(t, 1e3 / 60) } }(), i.dom.CenteredDiv = function (t, e) { var i = function () { this.backgroundElement = document.createElement("div"), e.extend(this.backgroundElement.style, { backgroundColor: "rgba(0,0,0,0.8)", top: 0, left: 0, display: "none", zIndex: "1000", opacity: 0, WebkitTransition: "opacity 0.2s linear" }), t.makeFullscreen(this.backgroundElement), this.backgroundElement.style.position = "fixed", this.domElement = document.createElement("div"), e.extend(this.domElement.style, { position: "fixed", display: "none", zIndex: "1001", opacity: 0, WebkitTransition: "-webkit-transform 0.2s ease-out, opacity 0.2s linear" }), document.body.appendChild(this.backgroundElement), document.body.appendChild(this.domElement); var i = this; t.bind(this.backgroundElement, "click", function () { i.hide() }) }; return i.prototype.show = function () { var t = this; this.backgroundElement.style.display = "block", this.domElement.style.display = "block", this.domElement.style.opacity = 0, this.domElement.style.webkitTransform = "scale(1.1)", this.layout(), e.defer(function () { t.backgroundElement.style.opacity = 1, t.domElement.style.opacity = 1, t.domElement.style.webkitTransform = "scale(1)" }) }, i.prototype.hide = function () { var e = this, i = function () { e.domElement.style.display = "none", e.backgroundElement.style.display = "none", t.unbind(e.domElement, "webkitTransitionEnd", i), t.unbind(e.domElement, "transitionend", i), t.unbind(e.domElement, "oTransitionEnd", i) }; t.bind(this.domElement, "webkitTransitionEnd", i), t.bind(this.domElement, "transitionend", i), t.bind(this.domElement, "oTransitionEnd", i), this.backgroundElement.style.opacity = 0, this.domElement.style.opacity = 0, this.domElement.style.webkitTransform = "scale(1.1)" }, i.prototype.layout = function () { this.domElement.style.left = window.innerWidth / 2 - t.getWidth(this.domElement) / 2 + "px", this.domElement.style.top = window.innerHeight / 2 - t.getHeight(this.domElement) / 2 + "px" }, i }(i.dom.dom, i.utils.common), i.dom.dom, i.utils.common)
    }, function (t, e) {
        var i = t.exports = i || {}; i.color = i.color || {}, i.utils = i.utils || {}, i.utils.common = function () { var t = Array.prototype.forEach, e = Array.prototype.slice; return { BREAK: {}, extend: function (t) { return this.each(e.call(arguments, 1), function (e) { for (var i in e) this.isUndefined(e[i]) || (t[i] = e[i]) }, this), t }, defaults: function (t) { return this.each(e.call(arguments, 1), function (e) { for (var i in e) this.isUndefined(t[i]) && (t[i] = e[i]) }, this), t }, compose: function () { var t = e.call(arguments); return function () { for (var i = e.call(arguments), n = t.length - 1; n >= 0; n--)i = [t[n].apply(this, i)]; return i[0] } }, each: function (e, i, n) { if (t && e.forEach === t) e.forEach(i, n); else if (e.length === e.length + 0) { for (var o = 0, s = e.length; s > o; o++)if (o in e && i.call(n, e[o], o) === this.BREAK) return } else for (var o in e) if (i.call(n, e[o], o) === this.BREAK) return }, defer: function (t) { setTimeout(t, 0) }, toArray: function (t) { return t.toArray ? t.toArray() : e.call(t) }, isUndefined: function (t) { return void 0 === t }, isNull: function (t) { return null === t }, isNaN: function (t) { return t !== t }, isArray: Array.isArray || function (t) { return t.constructor === Array }, isObject: function (t) { return t === Object(t) }, isNumber: function (t) { return t === t + 0 }, isString: function (t) { return t === t + "" }, isBoolean: function (t) { return t === !1 || t === !0 }, isFunction: function (t) { return "[object Function]" === Object.prototype.toString.call(t) } } }(), i.color.toString = function (t) { return function (e) { if (1 == e.a || t.isUndefined(e.a)) { for (var i = e.hex.toString(16); i.length < 6;)i = "0" + i; return "#" + i } return "rgba(" + Math.round(e.r) + "," + Math.round(e.g) + "," + Math.round(e.b) + "," + e.a + ")" } }(i.utils.common), i.Color = i.color.Color = function (t, e, i, n) { function o(t, e, i) { Object.defineProperty(t, e, { get: function () { return "RGB" === this.__state.space ? this.__state[e] : (r(this, e, i), this.__state[e]) }, set: function (t) { "RGB" !== this.__state.space && (r(this, e, i), this.__state.space = "RGB"), this.__state[e] = t } }) } function s(t, e) { Object.defineProperty(t, e, { get: function () { return "HSV" === this.__state.space ? this.__state[e] : (a(this), this.__state[e]) }, set: function (t) { "HSV" !== this.__state.space && (a(this), this.__state.space = "HSV"), this.__state[e] = t } }) } function r(t, i, o) { if ("HEX" === t.__state.space) t.__state[i] = e.component_from_hex(t.__state.hex, o); else { if ("HSV" !== t.__state.space) throw "Corrupted color state"; n.extend(t.__state, e.hsv_to_rgb(t.__state.h, t.__state.s, t.__state.v)) } } function a(t) { var i = e.rgb_to_hsv(t.r, t.g, t.b); n.extend(t.__state, { s: i.s, v: i.v }), n.isNaN(i.h) ? n.isUndefined(t.__state.h) && (t.__state.h = 0) : t.__state.h = i.h } var u = function () { if (this.__state = t.apply(this, arguments), this.__state === !1) throw "Failed to interpret color arguments"; this.__state.a = this.__state.a || 1 }; return u.COMPONENTS = ["r", "g", "b", "h", "s", "v", "hex", "a"], n.extend(u.prototype, { toString: function () { return i(this) }, toOriginal: function () { return this.__state.conversion.write(this) } }), o(u.prototype, "r", 2), o(u.prototype, "g", 1), o(u.prototype, "b", 0), s(u.prototype, "h"), s(u.prototype, "s"), s(u.prototype, "v"), Object.defineProperty(u.prototype, "a", { get: function () { return this.__state.a }, set: function (t) { this.__state.a = t } }), Object.defineProperty(u.prototype, "hex", { get: function () { return "HEX" !== !this.__state.space && (this.__state.hex = e.rgb_to_hex(this.r, this.g, this.b)), this.__state.hex }, set: function (t) { this.__state.space = "HEX", this.__state.hex = t } }), u }(i.color.interpret = function (t, e) {
            var i, n, o = function () { n = !1; var t = arguments.length > 1 ? e.toArray(arguments) : arguments[0]; return e.each(s, function (o) { return o.litmus(t) ? (e.each(o.conversions, function (o, s) { return i = o.read(t), n === !1 && i !== !1 ? (n = i, i.conversionName = s, i.conversion = o, e.BREAK) : void 0 }), e.BREAK) : void 0 }), n }, s = [{ litmus: e.isString, conversions: { THREE_CHAR_HEX: { read: function (t) { var e = t.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i); return null === e ? !1 : { space: "HEX", hex: parseInt("0x" + e[1].toString() + e[1].toString() + e[2].toString() + e[2].toString() + e[3].toString() + e[3].toString()) } }, write: t }, SIX_CHAR_HEX: { read: function (t) { var e = t.match(/^#([A-F0-9]{6})$/i); return null === e ? !1 : { space: "HEX", hex: parseInt("0x" + e[1].toString()) } }, write: t }, CSS_RGB: { read: function (t) { var e = t.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/); return null === e ? !1 : { space: "RGB", r: parseFloat(e[1]), g: parseFloat(e[2]), b: parseFloat(e[3]) } }, write: t }, CSS_RGBA: { read: function (t) { var e = t.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\,\s*(.+)\s*\)/); return null === e ? !1 : { space: "RGB", r: parseFloat(e[1]), g: parseFloat(e[2]), b: parseFloat(e[3]), a: parseFloat(e[4]) } }, write: t } } }, { litmus: e.isNumber, conversions: { HEX: { read: function (t) { return { space: "HEX", hex: t, conversionName: "HEX" } }, write: function (t) { return t.hex } } } }, { litmus: e.isArray, conversions: { RGB_ARRAY: { read: function (t) { return 3 != t.length ? !1 : { space: "RGB", r: t[0], g: t[1], b: t[2] } }, write: function (t) { return [t.r, t.g, t.b] } }, RGBA_ARRAY: { read: function (t) { return 4 != t.length ? !1 : { space: "RGB", r: t[0], g: t[1], b: t[2], a: t[3] } }, write: function (t) { return [t.r, t.g, t.b, t.a] } } } }, {
                litmus: e.isObject, conversions: {
                    RGBA_OBJ: { read: function (t) { return e.isNumber(t.r) && e.isNumber(t.g) && e.isNumber(t.b) && e.isNumber(t.a) ? { space: "RGB", r: t.r, g: t.g, b: t.b, a: t.a } : !1 }, write: function (t) { return { r: t.r, g: t.g, b: t.b, a: t.a } } }, RGB_OBJ: {
                        read: function (t) {
                            return e.isNumber(t.r) && e.isNumber(t.g) && e.isNumber(t.b) ? {
                                space: "RGB", r: t.r, g: t.g,
                                b: t.b
                            } : !1
                        }, write: function (t) { return { r: t.r, g: t.g, b: t.b } }
                    }, HSVA_OBJ: { read: function (t) { return e.isNumber(t.h) && e.isNumber(t.s) && e.isNumber(t.v) && e.isNumber(t.a) ? { space: "HSV", h: t.h, s: t.s, v: t.v, a: t.a } : !1 }, write: function (t) { return { h: t.h, s: t.s, v: t.v, a: t.a } } }, HSV_OBJ: { read: function (t) { return e.isNumber(t.h) && e.isNumber(t.s) && e.isNumber(t.v) ? { space: "HSV", h: t.h, s: t.s, v: t.v } : !1 }, write: function (t) { return { h: t.h, s: t.s, v: t.v } } }
                }
            }]; return o
        }(i.color.toString, i.utils.common), i.color.math = function () { var t; return { hsv_to_rgb: function (t, e, i) { var n = Math.floor(t / 60) % 6, o = t / 60 - Math.floor(t / 60), s = i * (1 - e), r = i * (1 - o * e), a = i * (1 - (1 - o) * e), u = [[i, a, s], [r, i, s], [s, i, a], [s, r, i], [a, s, i], [i, s, r]][n]; return { r: 255 * u[0], g: 255 * u[1], b: 255 * u[2] } }, rgb_to_hsv: function (t, e, i) { var n, o, s = Math.min(t, e, i), r = Math.max(t, e, i), a = r - s; return 0 == r ? { h: NaN, s: 0, v: 0 } : (o = a / r, n = t == r ? (e - i) / a : e == r ? 2 + (i - t) / a : 4 + (t - e) / a, n /= 6, 0 > n && (n += 1), { h: 360 * n, s: o, v: r / 255 }) }, rgb_to_hex: function (t, e, i) { var n = this.hex_with_component(0, 2, t); return n = this.hex_with_component(n, 1, e), n = this.hex_with_component(n, 0, i) }, component_from_hex: function (t, e) { return t >> 8 * e & 255 }, hex_with_component: function (e, i, n) { return n << (t = 8 * i) | e & ~(255 << t) } } }(), i.color.toString, i.utils.common)
    }, function (t, e, i) { var n, o, s; s = i(9), o = i(11), e.user = new THREE.PerspectiveCamera(80, s.width / s.height, .1, 1e5), e.dev = new THREE.PerspectiveCamera(80, s.width / s.height, .1, 1e5), o = o.addFolder("controller::cameras"), n = 2e4, e.user.name = "user", e.dev.name = "dev", o.add(e.user, "name"), o.add(e.user, "fov", 10, 200).listen(), o.add(e.user.position, "x", -n, n).name("position x"), o.add(e.user.position, "y", -n, n).name("position y"), o.add(e.user.position, "z", -n, n).name("position z"), o.add(e.user.rotation, "x", -PI_2, PI_2).name("rotation x"), o.add(e.user.rotation, "y", -PI_2, PI_2).name("rotation y"), o.add(e.user.rotation, "z", -PI_2, PI_2).name("rotation z"), o.add(e.dev, "name"), o.add(e.dev, "fov", 10, 200).listen(), o.add(e.dev.position, "x", -n, n).name("position x").listen(), o.add(e.dev.position, "y", -n, n).name("position y").listen(), o.add(e.dev.position, "z", -n, n).name("position z").listen(), o.add(e.dev.rotation, "x", -PI_2, PI_2).name("rotation x").listen(), o.add(e.dev.rotation, "y", -PI_2, PI_2).name("rotation y").listen(), o.add(e.dev.rotation, "z", -PI_2, PI_2).name("rotation z").listen() }, function (t, e) { t.exports = new THREE.Scene }, function (t, e, i) { var n; n = i(10), t.exports = new THREE.WebGLRenderer({ alpha: !1, antialias: !0, preserveDrawingBuffer: !n.live }) }, function (t, e, i) { var n, o, s, r, a; a = i(10), o = i(16), r = i(18), n = o.dev, s = new THREE.TrackballControls(n, $("canvas")[0]), s.rotateSpeed = 1, s.zoomSpeed = 1.2, s.panSpeed = .8, s.noZoom = !1, s.noPan = !1, s.staticMoving = !0, s.dynamicDampingFactor = .5, t.exports = s }, function (t, e, i) { var n, o; o = i(18), n = i(8), t.exports = function () { function t() { n(this) } return t.prototype["export"] = function (t, e) { var i; return i = Canvas2Image.convertToImage(o.domElement, t, e, "jpeg"), $.ajax({ type: "POST", url: "save_image.php", dataType: "text", data: { base64Data: i.src }, success: function (t) { return function (e) { return SaveToDisk("exports/" + e, e), t.emit("done"), c.log("emit done") } }(this), error: function (t) { return function () { return console.log("error") } }(this) }) }, t }() }, function (t, e, i) { var n, o, s, r, a = function (t, e) { return function () { return t.apply(e, arguments) } }; r = i(10), s = i(22), o = i(8), t.exports = new (n = function () { function t() { this.on_state_change = a(this.on_state_change, this); var t, e, n, r, u; for (o(this), History.Adapter.bind(window, "statechange", this.on_state_change), this.routes = [], n = 0, r = s.length; r > n; n++)u = s[n], t = i(23), e = new t(u.id), this.routes.push({ url: u.url, run: e.run, destroy: e.destroy, controller: e }) } return t.prototype.route_index = -1, t.prototype.start = function () { return this.on_state_change() }, t.prototype.on_state_change = function () { var t, e, i, n, o; for (t = History.getState(), this._url = this.get_url(), this.previous_route_index = this.route_index, e = i = 0, n = s.length; n > i; e = ++i)if (o = s[e], this._url === o.url) { this.route_index = e; break } return null != this.routes[this.previous_route_index] ? this.routes[this.previous_route_index].controller.has_transitioned_out() ? this.routes[this.previous_route_index].destroy(function (t) { return function () { return t.run() } }(this)) : (this.routes[this.previous_route_index].controller.once("next", function (t) { return function () { return c.log("router now destroy the view"), t.routes[t.previous_route_index].destroy(function () { return c.log("view destroyed"), t.run() }) } }(this)), this.routes[this.previous_route_index].controller.transition_out()) : this.run(), this.emit("url:changed", this._url) }, t.prototype.run = function () { return this.routes[this.route_index].controller.once("transition:in:complete", function (t) { return function () { return t.emit("nav:enable") } }(this)), this.routes[this.route_index].run(function (t) { return function () { return c.log("router::run -> done") } }(this)) }, t.prototype.go = function (t, e, i) { return null == e && (e = ""), null == i && (i = {}), c.debug("go", t, e, i), t !== this._url ? (History.pushState(null, document.title, r.base_path + t), this.emit("nav:disable"), this.emit("go", t)) : void 0 }, t.prototype.transition_out_then_go = function (t) { return t !== this._url ? c.log("url", t) : void 0 }, t.prototype.next = function () { var t, e, i, n, o, a, u; for (t = i = 0, n = s.length; n > i; t = ++i)if (a = s[t], u = a.url.match("/") ? r.base_path + a.url : a.url, u.match(window.location.pathname)) { e = t + 1 < s.length ? t + 1 : 0, o = s[e]; break } return this.go(o.url) }, t.prototype.get_url = function () { return window.location.pathname.replace(r.base_path, "") }, t }()) }, function (t, e) { t.exports = [{ id: "home", url: "/", controller: "controllers/scene" }, { id: "blackice", url: "/blackice", controller: "controllers/scene" }, { id: "elements", url: "/elements", controller: "controllers/scene" }, { id: "kubik", url: "/kubik", controller: "controllers/scene" }, { id: "hires", url: "/hires", controller: "controllers/scene" }, { id: "calvarium", url: "/calvarium", controller: "controllers/scene" }, { id: "liquidice", url: "/liquidice", controller: "controllers/scene" }, { id: "epilogue", url: "/epilogue", controller: "controllers/epilogue" }] }, function (t, e, i) { var n, o, s, r, a, u = function (t, e) { return function () { return t.apply(e, arguments) } }; r = i(8), o = i(7), s = i(11), a = i(21), t.exports = n = function () { function t(t) { this.id = t, this.next = u(this.next, this), this.destroy = u(this.destroy, this), this.run = u(this.run, this), r(this), this.gui = s.addFolder("controller::" + this.id), this.gui.open() } return t.prototype.run = function (t) { var e, n, s; return c.log("controller::scene -> run " + this.id), this.scene = new THREE.Scene, e = i(24)("./" + this.id + "/index"), n = i(88)("./" + this.id + "/assets"), s = i(90)("./" + this.id + "/config"), this.view = new e(this.scene, this.gui, n, s), o.set_scene(), this.view.once("setup:complete", function (e) { return function () { return o.set_scene(e.scene, s), e.view.transition_in(), t() } }(this)), this.view.once("next", this.next), this.view.once("transition:in:complete", function (t) { return function () { return t.emit("transition:in:complete") } }(this)), this.view.load() }, t.prototype.destroy = function (t) { return c.log("controller::" + this.id + " -> destroy"), this.view.once("destroyed", function (e) { return function () { return t() } }(this)), this.view.destroy() }, t.prototype.has_transitioned_out = function () { return this.view.has_transitioned_out }, t.prototype.transition_out = function () { return c.log("transition out scene"), this.view.off("next", this.next), this.view.once("next", function (t) { return function () { return c.log("next route"), t.emit("next") } }(this)), this.view.transition_out_forward(!0), this.view.disable_transition() }, t.prototype.next = function () { return i(21).next() }, t }() }, function (t, e, i) { function n(t) { return i(o(t)) } function o(t) { return s[t] || function () { throw new Error("Cannot find module '" + t + "'.") }() } var s = { "./blackice/index": 25, "./calvarium/index": 49, "./elements/index": 54, "./epilogue/index": 61, "./hires/index": 70, "./home/index": 75, "./kubik/index": 80, "./liquidice/index": 84 }; n.keys = function () { return Object.keys(s) }, n.resolve = o, t.exports = n, n.id = 24 }, function (t, e, i) { var n, o, s, r, a, u, h, l, c, d, p, _, f, m, g, y, v = function (t, e) { return function () { return t.apply(e, arguments) } }, b = function (t, e) { function i() { this.constructor = t } for (var n in e) w.call(e, n) && (t[n] = e[n]); return i.prototype = e.prototype, t.prototype = new i, t.__super__ = e.prototype, t }, w = {}.hasOwnProperty, x = [].indexOf || function (t) { for (var e = 0, i = this.length; i > e; e++)if (e in this && this[e] === t) return e; return -1 }; f = i(8), m = i(10), p = i(16), _ = i(7), a = i(26), u = i(33), g = i(34), r = i(35), y = i(9), o = i(36), c = i(37), d = i(45), s = i(46), l = i(47), h = i(48), t.exports = n = function (t) { function e() { return this.on_click = v(this.on_click, this), this.update = v(this.update, this), this.generate_mesh = v(this.generate_mesh, this), this.on_cubemap_url_loaded = v(this.on_cubemap_url_loaded, this), this.on_drop = v(this.on_drop, this), this.on_dragover = v(this.on_dragover, this), this.setup = v(this.setup, this), e.__super__.constructor.apply(this, arguments) } return b(e, t), e.prototype.material = null, e.prototype.accel_x = .1, e.prototype.accel_y = .1, e.prototype.accel_z = .1, e.prototype.iteration = 0, e.prototype.interation_lock = !0, e.prototype.first_time = !1, e.prototype.base_mult = 0, e.prototype.user_added_texture = !1, e.prototype.setup = function (t) { var e, i, n, o, r, a; for (this.manifest = t, this.gui.add(this, "audio_pos_z", -30, 30), this.first_time = !0, _.fov = this.config.camera_fov, this.ui = new c("blackice", this.scene, this.gui), this.config.fog_enabled && (this.scene.fog = new THREE.FogExp2(0, this.config.fog_in_start), this.gui.add(this.scene.fog, "density", 0, 1)), m.debug && (this.scene.add(new THREE.GridHelper(50, 10)), this.scene.add(new THREE.AxisHelper(10)), this.scene.add(new THREE.CameraHelper(p.user))), this.hotspot = new s(this.ui.ui.hitarea, "sphere", 70), this.scene.add(this.hotspot.mesh), this.path_in = new l("path_in", this.scene, this.config.path_in, this.config.path_in_lookat, 65280), this.path_out = new h("path_out", this.scene, this.config.path_out, this.config.path_out_lookat, 65280), this.mouse = new u($("body")), this.audio_pos_z = this.config.audio_pos_z_in, this.sounds = { base_1: g.get_asset("base_1", this.manifest).data, base_2: g.get_asset("base_2", this.manifest).data, base_3: g.get_asset("base_3", this.manifest).data, melody: g.get_asset("melody", this.manifest).data }, this.sounds.melody.volume(.7), this.sounds.melody.play(), this.sound_bases = [this.sounds.base_1, this.sounds.base_2, this.sounds.base_3], o = this.sound_bases, e = 0, n = o.length; n > e; e++)a = o[e], a.volume(0), a.play(); r = this.sounds; for (i in r) a = r[i], a.loop(!0); return this.container = new THREE.Object3D, this.scene.add(this.container), this.materials = [], this.materials.push(this.generate_material("lvl0")), this.materials.push(this.generate_material("lvl1")), this.materials.push(this.generate_material("lvl2")), this.user_material = this.generate_material("lvl0"), this.iteration = 1, this.generate_mesh(this.iteration), this.bind(), this.emit("setup:complete") }, e.prototype.generate_material = function (t) { var e, i, n, o, s, r, a, u, h; for (h = [], u = [t + "-pos-x", t + "-neg-x", t + "-pos-y", t + "-neg-y", t + "-pos-z", t + "-neg-z"], r = this.manifest, n = 0, o = r.length; o > n; n++)e = r[n], a = e.id, x.call(u, a) >= 0 && h.push(e.src); return i = THREE.ImageUtils.loadTextureCube(h), i.format = THREE.RGBFormat, s = new THREE.MeshBasicMaterial({ color: 13421772, envMap: i, shading: THREE.FlatShading, side: THREE.DoubleSide }) }, e.prototype.bind = function () { return e.__super__.bind.call(this), this.hotspot.on("click", this.on_click), this.ui.bind(), this.hotspot.bind(), this.mouse.bind(), $(window).on("dragover", this.on_dragover).on("drop", this.on_drop) }, e.prototype.unbind = function () { return e.__super__.unbind.call(this), this.hotspot.off("click", this.on_click), this.ui.unbind(), this.hotspot.unbind(), this.mouse.unbind(), $(window).off("dragover", this.on_dragover).on("drop", this.on_drop) }, e.prototype.on_dragover = function (t) { return t.preventDefault(), t.stopPropagation() }, e.prototype.on_drop = function (t) { var e, i; return t.preventDefault(), t.stopPropagation(), e = t.originalEvent.dataTransfer.files[0], "image/jpeg" !== e.type && "image/png" !== e.type ? void alert("File not supported, use an image instead") : (i = new FileReader, i.onload = function (t) { return function (e) { var i; return t.user_added_texture = !0, i = e.target.result, t.update_cube_map(i) } }(this), i.readAsDataURL(e)) }, e.prototype.update_cube_map = function (t) { var e, i; return e = $("#cubemap"), i = new Image, i.onload = function (n) { return function () { var o, s, r, a, u, h, l, c, d, p, _; for (_ = i.width, r = i.height, c = 4, e.css({ width: _ / c + "px", height: r / c + "px" }), e.find("img").attr("src", t), o = document.createElement("canvas"), o.setAttribute("width", _), o.setAttribute("height", r), s = o.getContext("2d"), s.drawImage(i, 0, 0), d = r / _ > 1 ? i.width / 3 : i.height / 3, n.urls = [], n.urls.push(n.get_cubemap_tile(s, d, 0, d)), n.urls.push(n.get_cubemap_tile(s, 0, d, d)), n.urls.push(n.get_cubemap_tile(s, d, d, d)), n.urls.push(n.get_cubemap_tile(s, 2 * d, d, d)), n.urls.push(n.get_cubemap_tile(s, 3 * d, d, d)), n.urls.push(n.get_cubemap_tile(s, d, 2 * d, d)), n.counter_url = 0, h = n.urls, l = [], a = 0, u = h.length; u > a; a++)p = h[a], i = new Image, i.onload = n.on_cubemap_url_loaded, l.push(i.setAttribute("src", p)); return l } }(this), i.setAttribute("src", t) }, e.prototype.on_cubemap_url_loaded = function () { var t, e, i, n, o; if (this.counter_url++, this.counter_url === this.urls.length) { for (o = this.user_material.envMap.image, t = i = 0, n = o.length; n > i; t = ++i)e = o[t], e.removeAttribute("crossorigin"), e.setAttribute("src", this.urls[t]); this.user_material.envMap.needsUpdate = !0, this.user_material.needsUpdate = !0 } return this.generate_mesh() }, e.prototype.get_cubemap_tile = function (t, e, i, n) { var o, s, r, a; return o = $("<canvas/>"), o.attr("width", n), o.attr("height", n), s = o[0].getContext("2d"), a = t.getImageData(e, i, n, n), s.putImageData(a, 0, 0), r = o[0].toDataURL("image/jpeg") }, e.prototype.generate_mesh = function () { var t, e, i, n, o, s, r, a, u, h, l, c, d, p, _; for (this.container.remove(this.mesh), n = [.35, .3, .2], t = n[this.iteration - 1], this.vertex_sets = [0], e = new THREE.IcosahedronGeometry(50, 2), i = o = 0, l = this.iteration; l >= 0 ? l > o : o > l; i = l >= 0 ? ++o : --o)for (e = this.smooth_geometry(e, i), d = e.vertices.slice(this.vertex_sets[i], this.vertex_sets[i + 1]), s = 0, a = d.length; a > s; s++)_ = d[s], _.multiplyScalar(1 + Math.random() * t); if (h = this.user_added_texture ? this.user_material : this.materials[this.iteration - 1], this.mesh = new THREE.Mesh(e, h), this.container.add(this.mesh), !this.first_time) for (c = this.sound_bases, r = 0, u = c.length; u > r; r++)p = c[r], p.fade(1, 0, 500); return this.sound_bases[this.iteration - 1].fade(0, 1, 500), this.first_time = !1 }, e.prototype.smooth_geometry = function (t, e) { var i, n; return i = new THREE.SubdivisionModifier(e), n = t.clone(), i.modify(n), this.vertex_sets.push(n.vertices.length), n }, e.prototype.transition_in = function () { var t; return e.__super__.transition_in.call(this), t = { x: .3 * Math.PI, y: .5 * Math.PI, z: .2 * Math.PI, ease: Power1.easeOut }, TweenLite.to(this.mesh.rotation, this.config.camera_in_duration, t), g.delay(8, function (t) { return function () { return t.interation_lock = !1, TweenLite.killTweensOf(t.mesh.rotation) } }(this)), t = { audio_pos_z: 0, ease: Power1.easeOut }, TweenLite.to(this, this.config.camera_in_duration, t) }, e.prototype.update = function () { var t, e, i, n, o; return e = this.get_preset(), i = Math.abs(this.mouse.normal_center_x), n = this.mouse.normal_center_y, o = this.audio_pos_z, t = this.sound_bases[this.iteration - 1], t.pos(i, n, o), this.sounds.melody.pos(0, 0, o), i *= e.vel_x, this.mesh.rotation.x += this.accel_x * (this.mouse.normal_center_x * e.movement_speed), this.mesh.rotation.y += this.accel_x * (this.mouse.normal_center_y * e.movement_speed), this.mesh.rotation.z += this.accel_y * (this.mouse.normal_center_y * e.movement_speed) }, e.prototype.get_preset = function () { return this.config.iteration_preset[this.iteration - 1] }, e.prototype.on_click = function () { return this.is_transitioning_out ? void 0 : (this.force_transition_in_complete(), this.iteration > 2 ? this.iteration = 1 : this.iteration++, this.generate_mesh(this.iteration)) }, e }(o) }, function (t, e, i) { var n, o, s, r, a, u, h, l, d, p = function (t, e) { return function () { return t.apply(e, arguments) } }; d = i(8), s = i(27), o = i(28), a = i(29), u = i(30), r = i(31), l = i(32), Element.prototype.remove = function () { this.parentElement.removeChild(this) }, NodeList.prototype.remove = HTMLCollection.prototype.remove = function () { var t, e; for (t = 0, e = this.length; e > t;)this[t] && this[t].parentElement && this[t].parentElement.removeChild(this[t]), t++ }, t.exports = n = function () { function t() { this.error = p(this.error, this), this.success = p(this.success, this), d(this), this.manifest = [] } return t.prototype.add = function (t, e, i, n) { var o; return o = { id: t, src: e, type: i, data: n }, this.manifest.push(o) }, t.prototype.load = function () { var t, e, i, n, c, d; for (this.count = 0, this.total = this.manifest.length, this.date = new Date, c = this.manifest, d = [], e = 0, n = c.length; n > e; e++)switch (t = c[e], t.type) { case "json": case "xml": i = new s, i.once("loaded", this.success), d.push(i.load(t)); break; case "image": i = new a, i.once("loaded", this.success), d.push(i.load(t)); break; case "binary": i = new o, i.once("loaded", this.success), d.push(i.load(t)); break; case "js": i = new u, i.once("loaded", this.success), d.push(i.load(t)); break; case "geometry": i = new r, i.once("loaded", this.success), d.push(i.load(t)); break; case "sound": i = new l, i.once("loaded", this.success), d.push(i.load(t)); break; case "sequence": i = new h, i.once("loaded", this.success), d.push(i.load(t)); break; default: d.push(void 0) }return d }, t.prototype.dispose = function () { var t, e, i, n, o; for (n = this.manifest, o = [], e = 0, i = n.length; i > e; e++)switch (t = n[e], t.type) { case "js": o.push(document.getElementById(t.id).remove()); break; default: o.push(void 0) }return o }, t.prototype.success = function (t) { return this.count++, this.count >= this.total ? this.emit("loaded", this.manifest) : void 0 }, t.prototype.error = function (t) { return c.log("error", t) }, t.prototype.get_asset = function (t) { var e, i, n, o, s; for (s = !1, o = this.manifest, i = 0, n = o.length; n > i; i++)e = o[i], e.id.match(t) && (s = e); return s }, t }(), h = function () { function t() { this.images_loaded = p(this.images_loaded, this), this.data_loaded = p(this.data_loaded, this), d(this), this.images = [], this.data_loader = new s, this.img_loader = new n, this.data_loader.once("loaded", this.data_loaded), this.img_loader.once("loaded", this.images_loaded) } return t.prototype.load = function (t) { return this.asset = t, this.data_loader.load({ src: this.asset.src }) }, t.prototype.data_loaded = function (t) { var e, i, n, o, s, r; for (this.asset.data = t.data, r = t.src.split("/"), o = r.splice(0, r.length - 1).join("/"), i = n = 0, s = t.data.total_spritesheets; s >= 0 ? s > n : n > s; i = s >= 0 ? ++n : --n)e = o + "/" + i + "." + t.data.extensions[0], this.img_loader.add("frame_" + i, e, "image", {}); return this.img_loader.load() }, t.prototype.images_loaded = function (t) { var e, i, n; for (this.asset.images = [], i = 0, n = t.length; n > i; i++)e = t[i], this.asset.images.push(e.data); return delete this.data_loader, delete this.img_loader, this.emit("loaded", this.asset) }, t }() }, function (t, e, i) { var n, o; o = i(8), t.exports = n = function () { function t() { o(this) } return t.prototype.load = function (t) { return $.ajax({ url: t.src, dataType: t.type, success: function (e) { return function (i) { return t.data = i, e.emit("loaded", t) } }(this), error: function (t) { return function (t) { return c.error("error", t) } }(this) }) }, t }() }, function (t, e, i) { var n, o; o = i(8), t.exports = n = function () { function t() { o(this) } return t.prototype.load = function (t) { var e, i; if (i = this.req(), !e) { e = "arraybuffer"; try { Blob.prototype.slice && (e = "blob") } catch (n) { } } return i.open("GET", t.src, !0), i.responseType = e, i.onprogress = function (t) { }, i.onreadystatechange = function (e) { return function (n) { 4 === i.readyState && (t.data = i.response, e.emit("loaded", t), i.onreadystatechange = null) } }(this), i.send(null) }, t.prototype.req = function () { return window.XMLHttpRequest ? new XMLHttpRequest : window.ActiveXObject ? new ActiveXObject("MSXML2.XMLHTTP.3.0") : void 0 }, t }() }, function (t, e, i) { var n, o; o = i(8), t.exports = n = function () { function t() { o(this) } return t.prototype.load = function (t) { var e; return e = new Image, e.onload = function (i) { return function () { return t.data = e, i.emit("loaded", t) } }(this), e.src = t.src }, t }() }, function (t, e, i) { var n, o; o = i(8), t.exports = n = function () { function t() { o(this) } return t.prototype.load = function (t) { var e; return e = document.createElement("script"), e.setAttribute("type", "text/javascript"), e.setAttribute("src", t.src), e.setAttribute("id", t.id), e.onload = function (e) { return function () { return e.emit("loaded", t) } }(this), document.getElementsByTagName("head")[0].appendChild(e) }, t }() }, function (t, e, i) { var n, o; o = i(8), t.exports = n = function () { function t() { o(this) } return t.prototype.load = function (t) { var e; return e = new THREE.JSONLoader, e.load(t.src, function (e) { return function (i) { return t.data = i, e.emit("loaded", t) } }(this)) }, t }() }, function (t, e, i) { var n, o; o = i(8), t.exports = n = function () { function t() { o(this) } return t.prototype.load = function (t) { var e; return e = new Howl({ src: [t.src], onload: function (i) { return function () { return t.data = e, i.emit("loaded", t) } }(this) }) }, t }() }, function (t, e, i) { var n, o, s, r = function (t, e) { return function () { return t.apply(e, arguments) } }; o = i(8), s = i(9), t.exports = n = function () { function t(t) { this.el = t, this.mouseup = r(this.mouseup, this), this.mousedown = r(this.mousedown, this), this.mousemove = r(this.mousemove, this), o(this) } return t.prototype.mouse_x = 0, t.prototype.mouse_y = 0, t.prototype.mouse_last_x = 0, t.prototype.mouse_last_y = 0, t.prototype.normal_x = 0, t.prototype.normal_y = 0, t.prototype.normal_center_x = 0, t.prototype.normal_center_y = 0, t.prototype.clicked_x = 0, t.prototype.clicked_y = 0, t.prototype.is_down = !1, t.prototype.is_dragging = !1, t.prototype.bind = function () { return this.el.on("mousedown", this.mousedown), this.el.on("mouseup", this.mouseup), this.el.on("mousemove", this.mousemove) }, t.prototype.unbind = function () { return this.el.off("mousedown", this.mousedown), this.el.off("mouseup", this.mouseup), this.el.off("click", this.click) }, t.prototype.mousemove = function (t) { var e; return this.mouse_last_x = this.mouse_x, this.mouse_last_y = this.mouse_y, e = this._get_event_position(t), this.mouse_x = e.x, this.mouse_y = e.y, this.normal_x = this.mouse_x / s.width, this.normal_y = this.mouse_y / s.height, this.normal_center_x = -.5 + this.normal_x, this.normal_center_y = -.5 + this.normal_y, this.is_down ? this.is_dragging = !0 : this.is_dragging = !1, this.emit("move") }, t.prototype.mousedown = function (t) { var e; return this.is_down = !0, e = this._get_event_position(t), this.clicked_x = e.x, this.clicked_y = e.y, this.emit("down", e) }, t.prototype.mouseup = function (t) { return this.is_down = !1, this.emit("up") }, t.prototype.distance_to = function (t, e) { return Math.sqrt((t - this.normal_x) * (t - this.normal_x) + (e - this.normal_y) * (e - this.normal_y)) }, t.prototype._get_event_position = function (t) { var e, i; return e = t.pageX, i = t.pageY, { x: e, y: i } }, t }() }, function (t, e) { t.exports = { lerp: function (t, e, i) { return t + (e - t) * i }, random: function (t, e) { return t + Math.random() * (e - t) }, radians: function (t) { return t * Math.PI / 180 }, degrees: function (t) { return 180 * t / Math.PI }, spline: function (t) { var e, i, n, o; for (o = [], e = 0, i = t.length; i > e; e++)n = t[e], o.push(n.clone()); return new THREE.SplineCurve3(o) }, delay: function (t, e) { return setTimeout(e, 1e3 * t) }, merge: function (t, e) { var i, n, o, s; "object" != typeof t && (t = {}); for (o in e) if (e.hasOwnProperty(o)) { if (s = e[o], "object" == typeof s) { t[o] = this.merge(t[o], s); continue } t[o] = s } for (i = 2, n = arguments.length; n > i;)merge(t, arguments[i]), i++; return t }, path: function (t, e, i, n, o) { var s, r, a, u, h, l, c, d, p, _, f, m, g, y, v; for (null == e && (e = []), null == i && (i = 16711680), null == n && (n = null), null == o && (o = 100), _ = function () { var t, i, n; for (n = [], a = t = 0, i = e.length; i >= 0 ? i > t : t > i; a = i >= 0 ? ++t : --t)n.push("" + a); return n }(), s = 1e4, p = [], y = 50, a = u = 0, g = _.length; g >= 0 ? g > u : u > g; a = g >= 0 ? ++u : --u)d = new THREE.Mesh(new THREE.SphereGeometry(y, 16, 16), new THREE.MeshBasicMaterial({ color: i, wireframe: !0 })), d.name = "path_" + a, d.position.fromArray(e[a]), n && (n.add(d, "name"), n.add(d.position, "x", -s, s).name("position x"), n.add(d.position, "y", -s, s).name("position y"), n.add(d.position, "z", -s, s).name("position z")), p.push(d); for (e = function () { var t, e, i; for (i = [], t = 0, e = p.length; e > t; t++)d = p[t], i.push(d.position.clone()); return i }(), v = this.spline(e), m = v.getPoints(o), r = new THREE.Geometry, h = 0, l = m.length; l > h; h++)f = m[h], r.vertices.push(f.clone()); return c = new THREE.Line(r, new THREE.LineBasicMaterial({ color: i })), this.spline(m) }, gui_controls: function (t, e, i, n) { var o, s; return null == n && (n = 100), s = 2 * Math.PI, e.updateMatrix(), o = t.addFolder(i), o.add(e.position, "x", -n, n), o.add(e.position, "y", -n, n), o.add(e.position, "z", -n, n), o.add(e.rotation, "x", -s, s), o.add(e.rotation, "y", -s, s), o.add(e.rotation, "z", -s, s) }, get_asset: function (t, e) { var i, n, o, s; for (s = !1, n = 0, o = e.length; o > n; n++)i = e[n], i.id.match(t) && (s = i); return s } }, window.PI = Math.PI, window.HALF_PI = Math.PI / 2, window.PI_2 = 2 * Math.PI, Number.prototype.map = function (t, e, i, n) { return (this - t) * (n - i) / (e - t) + i }, String.prototype.capitalizeFirstLetter = function () { return this.charAt(0).toUpperCase() + this.slice(1) } }, function (t, e, i) { var n, o, s, r = function (t, e) { return function () { return t.apply(e, arguments) } }; o = i(8), s = i(9), t.exports = n = function () { function t(t) { this.el = t, this.keyup = r(this.keyup, this), this.keydown = r(this.keydown, this), o(this) } return t.prototype.key = 0, t.prototype._enabled = !1, t.prototype.bind = function () { return this._enabled = !0, this.el.on("keydown", this.keydown), this.el.on("keyup", this.keyup) }, t.prototype.unbind = function () { return this._enabled = !1 }, t.prototype.keydown = function (t) { if (t.preventDefault(), this._enabled) switch (this.key = t.keyCode, this.key) { case 32: return this.emit("key:down:space") } }, t.prototype.keyup = function (t) { return 32 === this.key ? this.emit("key:up:space") : void 0 }, t }() }, function (t, e, i) { var n, o, s, r, a, u, h, l, d = function (t, e) { return function () { return t.apply(e, arguments) } }; u = i(8), s = i(26), r = i(16), h = i(18), o = i(35), a = i(7), l = i(34), t.exports = n = function () { function t(t, e, i, n) { this.scene = t, this.gui = e, this.assets = i, this.config = n, this.next = d(this.next, this), this.transition_out_forward = d(this.transition_out_forward, this), this.transition_out_backward = d(this.transition_out_backward, this), this.on_key_up = d(this.on_key_up, this), this.on_key_down = d(this.on_key_down, this), u(this), this.tweens = [], this.keyboard = new o($(window)) } return t.prototype.has_transitioned_out = !1, t.prototype.is_transitioning = !1, t.prototype.is_transitioning_in = !1, t.prototype.is_transitioning_out = !1, t.prototype.transition_progress = 0, t.prototype.is_transition_disabled = !1, t.prototype.transition_lock = !1, t.prototype.audio_pos_x = 0, t.prototype.audio_pos_y = 0, t.prototype.audio_pos_z = 0, t.prototype.sounds = Array, t.prototype.load = function () { var t, e, i, n; for (this.loader = new s, n = this.assets, e = 0, i = n.length; i > e; e++)t = n[e], this.loader.add(t.id, t.url, t.type); return this.loader.once("loaded", this.setup), this.loader.load() }, t.prototype.bind = function () { return a.on("update", this.update), this.keyboard.on("key:down:space", this.on_key_down), this.keyboard.on("key:up:space", this.on_key_up), this.keyboard.bind() }, t.prototype.unbind = function () { return a.off("update", this.update), this.keyboard.off("key:down:space", this.on_key_down), this.keyboard.off("key:up:space", this.on_key_up) }, t.prototype.on_key_down = function () { return this.is_transitioning_in || this.is_transition_disabled ? void 0 : this.transition_out_forward() }, t.prototype.on_key_up = function () { return this.transition_out_backward() }, t.prototype.transition_in = function () { var t, e, i, n; return this.emit("transition:in:complete"), this.is_transitioning = !0, this.is_transitioning_in = !0, e = this.config.path_in[0], r.user.position.set(e.x, e.y, e.z), r.user.lookAt(new THREE.Vector3), this.ui.transition_in(), i = { progress: 0 }, t = { progress: 1, ease: Power2.easeOut, onStart: function (t) { return function () { return t.emit("transition:in:start") } }(this), onUpdate: function (t) { return function () { return e = t.path_in.spline.getPointAt(i.progress), r.user.position.copy(e), r.user.lookAt(new THREE.Vector3), t.emit("transition:in:update", i.progress) } }(this), onComplete: function (t) { return function () { return t.is_transitioning = !1, t.is_transitioning_in = !1 } }(this) }, this.config.transition_debug && (this.config.camera_in_duration = .1), this.camera_tween = TweenLite.to(i, this.config.camera_in_duration, t), n = { progress: 0 }, t = { progress: 1, onComplete: function (t) { return function () { return t.ui.transition_out() } }(this) }, this.ui_tween = TweenLite.to(n, this.config.camera_in_duration, t), t = { audio_pos_z: 0, ease: Power1.easeOut }, TweenLite.to(this, this.config.camera_in_duration, t), this.config.fog_enabled ? (this.scene.fog.density = this.config.fog_in_start, t = { density: this.config.fog_in_end, ease: Power2.easeOut }, this.config.transition_debug && (this.config.fog_in_duration = 0), this.fog_tween = TweenLite.to(this.scene.fog, this.config.fog_in_duration, t)) : void 0 }, t.prototype.force_transition_in_complete = function () { return l.delay(2, function (t) { return function () { return t.ui_tween.totalProgress(1).kill() } }(this)) }, t.prototype.transition_out_backward = function () { var t, e, i; if (!(this.is_transition_disabled || 0 === this.transition_progress || this.transition_progress > .6)) return this.kill_tweens(), this.ui.show(), i = { progress: this.transition_progress }, e = { progress: 0, ease: Power3.easeOut, onUpdate: function (t) { return function () { var e, n; return e = t.path_out.spline.getPointAt(i.progress), r.user.position.copy(e), e = t.path_out.spline_camera.getPointAt(i.progress), r.user.lookAt(e), n = Math.max(n, 0), n = Math.min(n, 1), t.audio_pos_z = l.lerp(0, t.config.audio_pos_z_out, i.progress) } }(this), onComplete: function (t) { return function () { return t.is_transitioning = !1, t.is_transitioning_out = !1 } }(this) }, t = 1 + 1 * this.transition_progress, this.tweens.push(TweenLite.to(i, t, e)), e = { opacity: 0, ease: Power3.easeOut }, this.tweens.push(TweenLite.to(this.ui.ui.transition_black, t, e)), this.config.fog_enabled ? (e = { density: this.config.fog_in_end, ease: Power2.easeInOut }, this.tweens.push(TweenLite.to(this.scene.fog, t, e))) : void 0 }, t.prototype.transition_out_forward = function (t) { var e, i, n, o; if (null == t && (t = !1), !this.is_transitioning_out && !this.is_transition_disabled) { if (this.is_transitioning) return void this.transition_out_fast(); if (!this.is_transitioning) return this.is_transitioning = !0, this.is_transitioning_out = !0, this.kill_tweens(), this.ui.hide(), o = new THREE.Vector3(0, 0, -1), e = new THREE.Vector3, n = { progress: 0 }, i = { progress: 1, ease: Power2.easeIn, onUpdate: function (t) { return function () { var e; return t.transition_progress = n.progress, e = t.path_out.spline.getPointAt(n.progress), r.user.position.copy(e), e = t.path_out.spline_camera.getPointAt(n.progress), r.user.lookAt(e), t.audio_pos_z = l.lerp(0, t.config.audio_pos_z_out, n.progress) } }(this), onComplete: function (t) { return function () { return t.next() } }(this) }, this.tweens.push(TweenLite.to(n, this.config.camera_out_duration, i)), i = { opacity: 1, ease: Power2.easeIn }, this.tweens.push(TweenLite.to(this.ui.ui.transition_black, this.config.camera_out_duration, i)), this.config.fog_enabled ? (this.scene.fog.density = this.config.fog_out_start, i = { density: this.config.fog_out_end, ease: Power2.easeInOut }, this.tweens.push(TweenLite.to(this.scene.fog, this.config.fog_out_duration, i))) : void 0 } }, t.prototype.transition_out_fast = function () { return this.ui.once("transition:out:fast:complete", function (t) { return function () { return t.kill_tweens(), t.next() } }(this)), this.ui.transition_out_fast() }, t.prototype.next = function () { return this.has_transitioned_out = !0, this.emit("next") }, t.prototype.kill_tweens = function () { var t, e, i, n, o; for (i = this.tweens, n = [], t = 0, e = i.length; e > t; t++)o = i[t], n.push(null != o ? o.kill() : void 0); return n }, t.prototype.enable_transition = function () { return this.is_transition_disabled = !1 }, t.prototype.disable_transition = function () { return this.is_transition_disabled = !0 }, t.prototype.destroy = function () { var t, e, i, n, o, s, r; for (c.log("destroy"), o = this.scene.children, t = 0, i = o.length; i > t; t++)n = o[t], this.scene.remove(n); s = this.sounds; for (e in s) r = s[e], r.stop(), r.unload(); return h.shadowMapEnabled = !1, h.shadowMapSoft = !1, this.unbind(), this.ui.destroy(), this.loader.dispose(), this.emit("destroyed") }, t }() }, function (t, e, i) {
        var n, o, s, r, a, u, h, l, c = function (t, e) { return function () { return t.apply(e, arguments) } }; a = i(8), r = i(38), u = i(39), l = i(34), s = i(16), n = i(41), h = i(10), t.exports = o = function () {
            function t(t, e) { var n, o, s, r, l, d; this.id = t, this.assets = e, this.show_about = c(this.show_about, this), a(this), this.ui = { ui: ".ui", dim: ".dim", hitarea: ".hitarea", transition_black: ".transition_black", chapter: ".chapter", chapter_index: ".chapter_index", title: "h2", about: ".about", interactions: ".interactions", authors: ".authors", next: ".next", next_title: ".next h3", next_text: ".next .caps-text" }, d = i(42), n = u.get(this.id), r = { data: n, base_path: h.base_path }, $("main").append(d(r)), this.el = $("#" + n.id), l = this.ui; for (s in l) o = l[s], this.ui[s] = this.el.find(o); this.ui.letters = this.ui.about.lettering().children(), this.ui.next_letters = this.ui.next_text.lettering().children(), this.tweens = [] } return t.prototype.is_overlay_open = !0, t.prototype.ui = Object, t.prototype._disabled = !1, t.prototype.bind = function () { return this.ui.next_title.on("click", this.show_about) }, t.prototype.unbind = function () {
                return this.ui.next_title.off("click", this.show_about)
            }, t.prototype.disable_ui = function () { return this._disabled = !0, this.el.addClass("disable") }, t.prototype.enable_ui = function () { return this._disabled = !1, this.el.removeClass("disable") }, t.prototype.transition_in = function () { var t, e; return e = { ease: Power2.easeIn, z: 100 }, TweenLite.to(this.ui.chapter, 1.6, e), e = { autoAlpha: 1, ease: Power2.easeIn }, TweenLite.to(this.ui.chapter_index, 1.6, e), e = { autoAlpha: 1, ease: Power1.easeInOut, delay: 1.6 }, TweenLite.to(this.ui.title, 3, e), t = new n, t.animate(this.ui.letters, 2e3), e = { autoAlpha: 1, ease: Power2.easeInOut, delay: 5.7 }, TweenLite.to(this.ui.interactions, 1.6, e), e = { autoAlpha: 1, ease: Power2.easeInOut, delay: 5.7 }, TweenLite.to(this.ui.authors, 1.6, e) }, t.prototype.transition_out = function () { var t; return t = { autoAlpha: 0, ease: Power2.easeOut }, TweenLite.to(this.ui.dim, 1.6, t), t = { autoAlpha: 0, ease: Power2.easeOut, onComplete: function (e) { return function () { return t = { autoAlpha: 1, ease: Power2.easeIn, onComplete: function () { var t; return t = new n, t.animate(e.ui.next_letters, 0) } }, TweenLite.to(e.ui.next, 1.6, t) } }(this) }, TweenLite.to(this.ui.chapter, 1.6, t) }, t.prototype.transition_out_fast = function () { var t; return this.ui.transition_black.removeClass("layer-0").addClass("layer-5"), t = { autoAlpha: 1, ease: Power2.easeOut, onComplete: function (t) { return function () { return t.emit("transition:out:fast:complete") } }(this) }, TweenLite.to(this.ui.transition_black, 1.3, t) }, t.prototype.hide = function () { var t; if (!this._disabled) return this.kill_tweens(), t = { autoAlpha: 0, ease: Power2.easeOut }, this.tweens.push(TweenLite.to(this.ui.ui, 1.6, t)) }, t.prototype.show = function () { var t; return this.kill_tweens(), t = { autoAlpha: 1, delay: 1, ease: Power2.easeOut }, this.tweens.push(TweenLite.to(this.ui.ui, 1, t)) }, t.prototype.show_about = function (t) { var e; return t.preventDefault(), this.is_overlay_open = !this.is_overlay_open, TweenLite.killTweensOf(this.ui.dim), TweenLite.killTweensOf(this.ui.chapter), this.is_overlay_open ? (e = { autoAlpha: 0, ease: Power2.easeOut }, TweenLite.to(this.ui.dim, .6, e), e = { autoAlpha: 0, ease: Power2.easeOut }, TweenLite.to(this.ui.chapter, .6, e)) : (e = { autoAlpha: 1, ease: Power2.easeOut }, TweenLite.to(this.ui.dim, 1.6, e), e = { autoAlpha: 1, delay: .5, ease: Power2.easeOut }, TweenLite.to(this.ui.chapter, 1.6, e)) }, t.prototype.kill_tweens = function () { var t, e, i, n, o; for (i = this.tweens, n = [], t = 0, e = i.length; e > t; t++)o = i[t], n.push(null != o ? o.kill() : void 0); return n }, t.prototype.destroy = function () { return this.unbind, this.el.remove() }, t
        }()
    }, function (t, e, i) { var n, o, s, r; s = i(8), r = i(10), o = i(26), n = function () { function t() { s(this), this.objs = {} } return t.prototype.default_dictionary = "dictionary.xml", t.prototype.load = function () { var t; return t = new o, t.on("loading", function (t) { return function (t) { return c.info("[ PERCENT LOADED ] ->", t) } }(this)), t.once("loaded", function (t) { return function (e) { var i, n, o; for (n = 0, o = e.length; o > n; n++)i = e[n], t.objs[i.id] = $(i.data); return t.emit("loaded") } }(this)), t.add("dictionary.xml", r.base_path + "/xml/dictionary.xml", "xml"), t.add("scenes.xml", r.base_path + "/xml/scenes.xml", "xml"), t.load() }, t.prototype.get = function (t, e) { var i; return null == e && (e = this.default_dictionary), i = this.get_raw(t, e), i ? i.text() : "" }, t.prototype.get_raw = function (t, e) { return null == e && (e = this.default_dictionary), this.objs[e].find(t).length ? this.objs[e].find(t) : !1 }, t.prototype.get_dictionary = function (t) { return null == t && (t = this.default_dictionary), this.objs[t] }, t }(), t.exports = new n }, function (t, e, i) { var n, o, s, r, a; a = i(38), s = i(40).Scene, n = i(40).Author, o = i(40).Interaction, t.exports = new (r = function () { function t() { } return t.prototype.get = function (t) { var e, i, r; return r = $(a.get_dictionary("scenes.xml")), i = r.find('scene[id="' + t + '"]'), e = new s, e.id = i.attr("id"), e.chapter = i.find("chapter").text(), e.title = i.find("title").text(), e.nav_title = i.find("nav_title").text(), e.paragraphs = [], e.interactions = [], i.find("paragraph").each(function (t) { return function (t, i) { return e.paragraphs.push($(i).text()) } }(this)), e.authors = [], i.find("author").each(function (t) { return function (t, i) { var o, s; return o = $(i), s = new n, s.name = o.find("name").text(), s.role = o.find("role").text(), e.authors.push(s) } }(this)), i.find("interaction").each(function (t) { return function (t, i) { var n, s; return n = $(i), s = new o, s.id = n.attr("id"), s.text = n.text(), e.interactions.push(s) } }(this)), e }, t.prototype.all = function () { var t, e; return e = $(a.get_dictionary("scenes.xml")), t = [], e.find("scene").each(function (e) { return function (i, n) { var o; return o = $(n).attr("id"), t.push(e.get(o)) } }(this)), t }, t }()) }, function (t, e) { var i, n, o; e.Scene = o = function () { function t() { } return t.prototype.id = String, t.prototype.title = String, t.prototype.paragraphs = Array, t.prototype.authors = Array, t.prototype.interactions = Array, t }(), e.Author = i = function () { function t() { } return t.prototype.role = String, t.prototype.name = String, t }(), e.Interaction = n = function () { function t() { } return t.prototype.id = String, t.prototype.text = String, t }() }, function (t, e, i) { var n, o, s = [].indexOf || function (t) { for (var e = 0, i = this.length; i > e; e++)if (e in this && this[e] === t) return e; return -1 }; o = i(34), t.exports = function () { function t() { this.exclude = [] } return t.prototype.exclude = Array, t.prototype.animate = function (t, e) { var i, o, r, a, u, h; for (h = [], o = i = 0, r = t.length; r > i; o = ++i)a = t[o], u = new n($(a), e), s.call(this.exclude, o) >= 0 ? h.push(u.once = !0) : h.push(void 0); return h }, t }(), n = function () { function t(t, e) { this.el = t, this.base_delay = e, this.increment = 1 / this.passes, this.animate() } return t.prototype.passes = 5, t.prototype.opacity = 0, t.prototype.progress = 0, t.prototype.once = !1, t.prototype.animate = function () { var t, e, i, n; return this.progress++, this.progress <= this.passes ? (this.opacity += this.increment, e = 1 === this.progress ? this.base_delay + 2400 * Math.random() : 2400 * Math.random(), this.el.delay(e).animate({ opacity: this.opacity }, 500, function (t) { return function () { return t.animate() } }(this))) : this.once ? void 0 : (t = function () { n = []; for (var t = 0, e = this.passes; e >= 0 ? e > t : t > e; e >= 0 ? t++ : t--)n.push(t); return n }.apply(this), i = t[Math.ceil(o.random(2, t.length)) - 1], this.opacity = i * this.increment, this.progress = i, this.el.delay(e).animate({ opacity: this.opacity }, 500, function (t) { return function () { return t.animate() } }(this))) }, t }() }, function (t, e, i) { var n = i(43); t.exports = function (t) { var e, i = [], o = t || {}; return function (o, s, r, a, u) { if (i.push("<div" + n.attr("id", "" + t.data.id, !0, !1) + ' class="section scene layer layer_0"><div class="transition_black layer layer-0"></div><div class="ui"><div class="dim layer layer-0"></div><div class="content"><section class="chapter layer layer-0"><p class="chapter_index">' + n.escape(null == (e = t.data.chapter) ? "" : e) + "</p><h2>" + n.escape(null == (e = t.data.title) ? "" : e) + "</h2>"), function () { var o = t.data.paragraphs; if ("number" == typeof o.length) for (var s = 0, r = o.length; r > s; s++) { var a = o[s]; i.push('<p class="about">' + n.escape(null == (e = a) ? "" : e) + "</p>") } else { var r = 0; for (var s in o) { r++; var a = o[s]; i.push('<p class="about">' + n.escape(null == (e = a) ? "" : e) + "</p>") } } }.call(this), i.push('<ul class="interactions">'), function () { var n = t.data.interactions; if ("number" == typeof n.length) for (var o = 0, s = n.length; s > o; o++) { var r = n[o]; i.push('<li><div class="icon dragdrop"></div><br/><span>' + (null == (e = r.text) ? "" : e) + "</span></li>") } else { var s = 0; for (var o in n) { s++; var r = n[o]; i.push('<li><div class="icon dragdrop"></div><br/><span>' + (null == (e = r.text) ? "" : e) + "</span></li>") } } }.call(this), i.push('</ul></section><div class="hitarea layer layer-1"></div>'), "elements" == t.data.id) { a = ["hexahedron", "octahedron", "tetrahedron", "icosahedron", "dodecahedron"], s = ["earth", "air", "fire", "water", "universe"], i.push('<section class="titles layer layer-1">'); for (var h = 0; h < a.length; ++h)r = a[h], o = s[h], i.push("<div" + n.attr("data-id", "" + r, !0, !1) + ' class="title layer"><img' + n.attr("src", "" + t.base_path + "/img/elements/" + r + ".png", !0, !1) + "/><h3>" + n.escape(null == (e = o) ? "" : e) + "</h3></div>"); i.push('</section><nav class="geometry layer layer-2"><ul>'), function () { var t = a; if ("number" == typeof t.length) for (var e = 0, o = t.length; o > e; e++) { var s = t[e]; i.push('<li><a href="#"' + n.attr("data-id", "" + s, !0, !1) + '><div href="#"' + n.attr("data-id", "" + s, !0, !1) + ' data-sequence="data-sequence" class="layer"></div></a></li>') } else { var o = 0; for (var e in t) { o++; var s = t[e]; i.push('<li><a href="#"' + n.attr("data-id", "" + s, !0, !1) + '><div href="#"' + n.attr("data-id", "" + s, !0, !1) + ' data-sequence="data-sequence" class="layer"></div></a></li>') } } }.call(this), i.push("</ul></nav>") } i.push('<nav class="next layer layer-2"><h3><a href="#">' + n.escape(null == (e = t.data.title) ? "" : e) + '</a></h3><div class="caps-text">HOLD THE SPACE BAR TO CONTINUE</div></nav></div></div></div>') }.call(this, "element" in o ? o.element : "undefined" != typeof element ? element : void 0, "elements" in o ? o.elements : "undefined" != typeof elements ? elements : void 0, "solid" in o ? o.solid : "undefined" != typeof solid ? solid : void 0, "solids" in o ? o.solids : "undefined" != typeof solids ? solids : void 0, "undefined" in o ? o.undefined : void 0), i.join("") } }, function (t, e, i) { "use strict"; function n(t) { return null != t && "" !== t } function o(t) { return (Array.isArray(t) ? t.map(o) : t && "object" == typeof t ? Object.keys(t).filter(function (e) { return t[e] }) : [t]).filter(n).join(" ") } function s(t) { return a[t] || t } function r(t) { var e = String(t).replace(u, s); return e === "" + t ? t : e } e.merge = function h(t, e) { if (1 === arguments.length) { for (var i = t[0], o = 1; o < t.length; o++)i = h(i, t[o]); return i } var s = t["class"], r = e["class"]; (s || r) && (s = s || [], r = r || [], Array.isArray(s) || (s = [s]), Array.isArray(r) || (r = [r]), t["class"] = s.concat(r).filter(n)); for (var a in e) "class" != a && (t[a] = e[a]); return t }, e.joinClasses = o, e.cls = function (t, i) { for (var n = [], s = 0; s < t.length; s++)i && i[s] ? n.push(e.escape(o([t[s]]))) : n.push(o(t[s])); var r = o(n); return r.length ? ' class="' + r + '"' : "" }, e.style = function (t) { return t && "object" == typeof t ? Object.keys(t).map(function (e) { return e + ":" + t[e] }).join(";") : t }, e.attr = function (t, i, n, o) { return "style" === t && (i = e.style(i)), "boolean" == typeof i || null == i ? i ? " " + (o ? t : t + '="' + t + '"') : "" : 0 == t.indexOf("data") && "string" != typeof i ? (-1 !== JSON.stringify(i).indexOf("&") && console.warn("Since Jade 2.0.0, ampersands (`&`) in data attributes will be escaped to `&amp;`"), i && "function" == typeof i.toISOString && console.warn("Jade will eliminate the double quotes around dates in ISO form after 2.0.0"), " " + t + "='" + JSON.stringify(i).replace(/'/g, "&apos;") + "'") : n ? (i && "function" == typeof i.toISOString && console.warn("Jade will stringify dates in ISO form after 2.0.0"), " " + t + '="' + e.escape(i) + '"') : (i && "function" == typeof i.toISOString && console.warn("Jade will stringify dates in ISO form after 2.0.0"), " " + t + '="' + i + '"') }, e.attrs = function (t, i) { var n = [], s = Object.keys(t); if (s.length) for (var r = 0; r < s.length; ++r) { var a = s[r], u = t[a]; "class" == a ? (u = o(u)) && n.push(" " + a + '="' + u + '"') : n.push(e.attr(a, u, !1, i)) } return n.join("") }; var a = { "&": "&amp;", "<": "&lt;", ">": "&gt;", '"': "&quot;" }, u = /[&<>"]/g; e.escape = r, e.rethrow = function l(t, e, n, o) { if (!(t instanceof Error)) throw t; if (!("undefined" == typeof window && e || o)) throw t.message += " on line " + n, t; try { o = o || i(44).readFileSync(e, "utf8") } catch (s) { l(t, null, n) } var r = 3, a = o.split("\n"), u = Math.max(n - r, 0), h = Math.min(a.length, n + r), r = a.slice(u, h).map(function (t, e) { var i = e + u + 1; return (i == n ? "  > " : "    ") + i + "| " + t }).join("\n"); throw t.path = e, t.message = (e || "Jade") + ":" + n + "\n" + r + "\n\n" + t.message, t }, e.DebugItem = function (t, e) { this.lineno = t, this.filename = e } }, function (t, e) { }, function (t, e, i) { var n, o, s, r, a; for (a = i(10), o = [{ id: "lvl0-pos-x", url: "/img/blackice/lvl0/pos-x.jpg", type: "image" }, { id: "lvl0-neg-x", url: "/img/blackice/lvl0/neg-x.jpg", type: "image" }, { id: "lvl0-pos-y", url: "/img/blackice/lvl0/pos-y.jpg", type: "image" }, { id: "lvl0-neg-y", url: "/img/blackice/lvl0/neg-y.jpg", type: "image" }, { id: "lvl0-pos-z", url: "/img/blackice/lvl0/pos-z.jpg", type: "image" }, { id: "lvl0-neg-z", url: "/img/blackice/lvl0/neg-z.jpg", type: "image" }, { id: "lvl1-pos-x", url: "/img/blackice/lvl1/pos-x.jpg", type: "image" }, { id: "lvl1-neg-x", url: "/img/blackice/lvl1/neg-x.jpg", type: "image" }, { id: "lvl1-pos-y", url: "/img/blackice/lvl1/pos-y.jpg", type: "image" }, { id: "lvl1-neg-y", url: "/img/blackice/lvl1/neg-y.jpg", type: "image" }, { id: "lvl1-pos-z", url: "/img/blackice/lvl1/pos-z.jpg", type: "image" }, { id: "lvl1-neg-z", url: "/img/blackice/lvl1/neg-z.jpg", type: "image" }, { id: "lvl2-pos-x", url: "/img/blackice/lvl2/pos-x.jpg", type: "image" }, { id: "lvl2-neg-x", url: "/img/blackice/lvl2/neg-x.jpg", type: "image" }, { id: "lvl2-pos-y", url: "/img/blackice/lvl2/pos-y.jpg", type: "image" }, { id: "lvl2-neg-y", url: "/img/blackice/lvl2/neg-y.jpg", type: "image" }, { id: "lvl2-pos-z", url: "/img/blackice/lvl2/pos-z.jpg", type: "image" }, { id: "lvl2-neg-z", url: "/img/blackice/lvl2/neg-z.jpg", type: "image" }, { id: "base_1", url: "/sound/blackice/bass_layer_1.mp3", type: "sound" }, { id: "base_2", url: "/sound/blackice/bass_layer_2.mp3", type: "sound" }, { id: "base_3", url: "/sound/blackice/bass_layer_3_0.mp3", type: "sound" }, { id: "melody", url: "/sound/blackice/melody_layer.mp3", type: "sound" }], s = 0, r = o.length; r > s; s++)n = o[s], n.url = a.base_path + n.url; t.exports = o }, function (t, e, i) { var n, o, s, r = function (t, e) { return function () { return t.apply(e, arguments) } }; s = i(8), o = i(16).user, t.exports = n = function () { function t(t, e, i, n, o) { this.el = t, this.shape = null != e ? e : "box", this.size_x = null != i ? i : 10, this.size_y = null != n ? n : 10, this.size_z = null != o ? o : 10, this.on_click = r(this.on_click, this), this.on_mouse_move = r(this.on_mouse_move, this), s(this), "box" === this.shape && this.box(), "sphere" === this.shape && this.sphere(), "plane" === this.shape && this.plane() } return t.prototype.over = !1, t.prototype.mouse_x = 0, t.prototype.mouse_y = 0, t.prototype.enabled = !0, t.prototype.visible = !1, t.prototype.box = function () { var t; return t = new THREE.BoxGeometry(this.size_x, this.size_y, this.size_z), this.mesh = new THREE.Mesh(t, this.material()), this.mesh.visible = this.visible }, t.prototype.sphere = function () { var t; return t = new THREE.SphereGeometry(this.size_x, 8, 8), this.mesh = new THREE.Mesh(t, this.material()), this.mesh.visible = this.visible }, t.prototype.plane = function () { var t; return t = new THREE.PlaneGeometry(this.size_x, this.size_y, 1, 1), this.mesh = new THREE.Mesh(t, this.material()), this.mesh.visible = this.visible }, t.prototype.material = function () { var t; return t = { color: 65280, wireframe: !0, wireframeLinewidth: 5 }, new THREE.MeshBasicMaterial(t) }, t.prototype.bind = function () { return this.el.on("click", this.on_click), this.el.on("mousemove", this.on_mouse_move) }, t.prototype.unbind = function () { return this.el.off("click", this.on_click), this.el.off("mousemove", this.on_mouse_move) }, t.prototype.on_mouse_move = function (t) { var e, i, n, s, r; return this.mouse_x = t.clientX, this.mouse_y = t.clientY, i = this.mouse_x / window.innerWidth * 2 - 1, n = 2 * -(this.mouse_y / window.innerHeight) + 1, r = new THREE.Vector3(i, n, .5), r.unproject(o), s = new THREE.Raycaster(o.position, r.sub(o.position).normalize()), e = s.intersectObject(this.mesh), e.length > 0 ? this.on_over() : this.on_out() }, t.prototype.on_over = function () { return this.enabled && !this.over ? ($("body").css("cursor", "pointer"), this.over = !0, this.emit("over")) : void 0 }, t.prototype.on_out = function () { return this.enabled && this.over ? (this.over = !1, $("body").css("cursor", ""), this.emit("out")) : void 0 }, t.prototype.on_click = function (t) { return t.preventDefault(), this.over ? this.emit("click") : void 0 }, t.prototype.reset = function () { return this.enabled = !0 }, t }() }, function (t, e, i) { var n, o, s, r = function (t, e) { return function () { return t.apply(e, arguments) } }; o = i(16).user, s = i(34), t.exports = n = function () { function t(t, e, i, n, o, s, a) { var u, h, l, c, d, p, _, f; for (this.id = t, this.scene = e, this.points = i, this.lookat = n, this.color = o, this.gui = null != s ? s : null, null == a && (a = 100), this.update_camera = r(this.update_camera, this), this.update_path = r(this.update_path, this), this.gui && (h = this.gui.addFolder(this.id), h.add(this, "export_data"), h.add(this, "camera_position", 0, 1).onChange(function (t) { return function () { return t.update_camera() } }(this)), h.open()), this.gui && (this.lookat_marker = new THREE.Mesh(new THREE.SphereGeometry(2, 8, 8), new THREE.MeshBasicMaterial({ color: 16711680 })), this.lookat_marker.position.set(this.lookat.x, this.lookat.y, this.lookat.z), this.lookat_marker.visible = this.debug, this.scene.add(this.lookat_marker), u = h.addFolder("lookat"), u.add(this.lookat_marker.position, "x", -a, a), u.add(this.lookat_marker.position, "y", -a, a), u.add(this.lookat_marker.position, "z", -a, a), u.open()), this.markers = [], f = this.points, l = c = 0, d = f.length; d > c; l = ++c)_ = f[l], this.gui && (u = h.addFolder("point_" + l), u.add(_, "x", -a, a).onChange(function (t) { return function () { return t.update_path() } }(this)), u.add(_, "y", -a, a).onChange(function (t) { return function () { return t.update_path() } }(this)), u.add(_, "z", -a, a).onChange(function (t) { return function () { return t.update_path() } }(this)), u.open()), p = new THREE.Mesh(new THREE.SphereGeometry(1, 8, 8), new THREE.MeshBasicMaterial({ color: this.color })), p.visible = this.debug, this.markers.push(p), this.scene.add(p); this.update_path() } return t.prototype.path_curve = null, t.prototype.camera_position = .1, t.prototype.debug = !1, t.prototype.update_path = function () { var t, e, i, n, o, r, a, u, h, l, c; for (h = [], l = this.points, e = i = 0, o = l.length; o > i; e = ++i)a = l[e], this.markers[e].position.set(a.x, a.y, a.z), h.push(new THREE.Vector3(a.x, a.y, a.z)); for (this.scene.remove(this.path_curve), c = s.spline(h), u = c.getPoints(50), t = new THREE.Geometry, n = 0, r = u.length; r > n; n++)a = u[n], t.vertices.push(a.clone()); return this.path_curve = new THREE.Line(t, new THREE.LineBasicMaterial(16777215 * Math.random())), this.path_curve.visible = this.debug, this.scene.add(this.path_curve), this.spline = s.spline(u) }, t.prototype.update_camera = function () { var t; return t = this.spline.getPointAt(this.camera_position), o.position.copy(t), o.lookAt(this.lookat_marker.position) }, t.prototype.export_data = function () { var t, e, i, n, o, s, r; for (n = {}, n[this.id] = [], r = this.points, e = i = 0, o = r.length; o > i; e = ++i)s = r[e], t = { x: s.x, y: s.y, z: s.z }, n[this.id].push(t); return n[this.id + "_lookat"] = { x: this.lookat_marker.position.x, y: this.lookat_marker.position.y, z: this.lookat_marker.position.z }, c.log(JSON.stringify(n, void 0, 4)) }, t }() }, function (t, e, i) { var n, o, s, r = function (t, e) { return function () { return t.apply(e, arguments) } }; o = i(16).user, s = i(34), t.exports = n = function () { function t(t, e, i, n, o, s, a) { var u, h, l, c, d, p, _, f, m, g, y, v; for (this.id = t, this.scene = e, this.points = i, this.lookat_points = n, this.color = o, this.gui = null != s ? s : null, null == a && (a = 100), this.update_camera = r(this.update_camera, this), this.update_path = r(this.update_path, this), m = 1, this.gui && (h = this.gui.addFolder(this.id), h.add(this, "export_data"), h.add(this, "camera_position", 0, 1).onChange(function (t) { return function () { return t.update_camera() } }(this)), h.add(this, "lookat_position", 0, 1).onChange(function (t) { return function () { return t.update_camera() } }(this)), h.open()), this.gui && (this.lookat_marker = new THREE.Mesh(new THREE.SphereGeometry(m, 8, 8), new THREE.MeshBasicMaterial({ color: 16711680 })), this.lookat_marker.visible = !1, this.scene.add(this.lookat_marker), u = h.addFolder("lookat"), u.add(this.lookat_marker.position, "x", -a, a), u.add(this.lookat_marker.position, "y", -a, a), u.add(this.lookat_marker.position, "z", -a, a), u.open()), this.markers = [], y = this.points, l = c = 0, p = y.length; p > c; l = ++c)g = y[l], this.gui && (u = h.addFolder("point_" + l), u.add(g, "x", -a, a).onChange(function (t) { return function () { return t.update_path() } }(this)), u.add(g, "y", -a, a).onChange(function (t) { return function () { return t.update_path() } }(this)), u.add(g, "z", -a, a).onChange(function (t) { return function () { return t.update_path() } }(this)), u.open()), f = new THREE.Mesh(new THREE.SphereGeometry(m, 8, 8), new THREE.MeshBasicMaterial({ color: this.color })), f.visible = this.debug, this.markers.push(f), this.scene.add(f); for (this.lookat_markers = [], v = this.lookat_points, l = d = 0, _ = v.length; _ > d; l = ++d)g = v[l], this.gui && (u = h.addFolder("lookat_point_" + l), u.add(g, "x", -a, a).onChange(function (t) { return function () { return t.update_path() } }(this)), u.add(g, "y", -a, a).onChange(function (t) { return function () { return t.update_path() } }(this)), u.add(g, "z", -a, a).onChange(function (t) { return function () { return t.update_path() } }(this)), u.open()), f = new THREE.Mesh(new THREE.SphereGeometry(m, 8, 8), new THREE.MeshBasicMaterial({ color: this.color })), f.visible = this.debug, this.lookat_markers.push(f), this.scene.add(f); this.update_path() } return t.prototype.path_curve = null, t.prototype.camera_position = .1, t.prototype.lookat_position = .1, t.prototype.debug = !1, t.prototype.update_path = function () { var t, e, i, n, o, r, a, u, h, l, c, d, p, _, f, m; for (p = [], _ = this.points, e = i = 0, r = _.length; r > i; e = ++i)c = _[e], this.markers[e].position.set(c.x, c.y, c.z), p.push(new THREE.Vector3(c.x, c.y, c.z)); for (this.scene.remove(this.path_curve), m = s.spline(p), d = m.getPoints(50), t = new THREE.Geometry, n = 0, a = d.length; a > n; n++)c = d[n], t.vertices.push(c.clone()); for (this.path_curve = new THREE.Line(t, new THREE.LineBasicMaterial(16777215 * Math.random())), this.path_curve.visible = this.debug, this.scene.add(this.path_curve), this.spline = s.spline(d), p = [], f = this.lookat_points, e = o = 0, u = f.length; u > o; e = ++o)c = f[e], this.lookat_markers[e].position.set(c.x, c.y, c.z), p.push(new THREE.Vector3(c.x, c.y, c.z)); for (this.scene.remove(this.path_camera_curve), m = s.spline(p), d = m.getPoints(50), t = new THREE.Geometry, l = 0, h = d.length; h > l; l++)c = d[l], t.vertices.push(c.clone()); return this.path_camera_curve = new THREE.Line(t, new THREE.LineBasicMaterial(16777215 * Math.random())), this.path_camera_curve.visible = this.debug, this.scene.add(this.path_camera_curve), this.spline_camera = s.spline(d), this.update_camera() }, t.prototype.update_camera = function () { var t; return t = this.spline.getPointAt(this.camera_position), o.position.copy(t), t = this.spline_camera.getPointAt(this.lookat_position), this.gui ? (this.lookat_marker.position.copy(t), o.lookAt(this.lookat_marker.position)) : void 0 }, t.prototype.export_data = function () { var t, e, i, n, o, s, r; for (n = {}, n[this.id] = [], r = this.points, e = i = 0, o = r.length; o > i; e = ++i)s = r[e], t = { x: s.x, y: s.y, z: s.z }, n[this.id].push(t); return n[this.id + "_lookat"] = { x: this.lookat_marker.position.x, y: this.lookat_marker.position.y, z: this.lookat_marker.position.z }, c.log(JSON.stringify(n, void 0, 4)) }, t }() }, function (t, e, i) { var n, o, s, r, a, u, h, l, c, d, p, _, f, m, g, y, v, b, w = function (t, e) { return function () { return t.apply(e, arguments) } }, x = function (t, e) { function i() { this.constructor = t } for (var n in e) E.call(e, n) && (t[n] = e[n]); return i.prototype = e.prototype, t.prototype = new i, t.__super__ = e.prototype, t }, E = {}.hasOwnProperty; _ = i(8), g = i(10), c = i(16), p = i(7), m = i(18), o = i(26), s = i(33), v = i(34), b = i(9), n = i(36), f = i(50), d = i(51), y = i(52), h = i(37), l = i(53), a = i(47), r = i(48), t.exports = u = function (t) { function e() { return this.update = w(this.update, this), this.glitch = w(this.glitch, this), this.on_mouse_up = w(this.on_mouse_up, this), this.on_mouse_move = w(this.on_mouse_move, this), this.on_transition_in_start = w(this.on_transition_in_start, this), this.on_mouse_down = w(this.on_mouse_down, this), this.setup = w(this.setup, this), e.__super__.constructor.apply(this, arguments) } return x(e, t), e.prototype.xp = 0, e.prototype.yp = 0, e.prototype.accel = 1, e.prototype.reset_amplitude = !1, e.prototype.audio_pos_z = 0, e.prototype.setup = function (t) { var e, i, n; for (p.fov = d.camera_fov, this.ui = new h("calvarium", this.scene, this.gui), TweenLite.set(this.ui.ui.transition_black, { opacity: 1 }), d.fog_enabled && (this.scene.fog = new THREE.FogExp2(0, d.fog_in_start), this.gui.add(this.scene.fog, "density", 0, 1)), g.debug && (this.scene.add(new THREE.GridHelper(50, 10)), this.scene.add(new THREE.AxisHelper(10)), this.scene.add(new THREE.CameraHelper(c.user))), e = 0, i = f.length; i > e; e++)n = f[e], this.scene.add(n); return this.path_in = new a("path_in", this.scene, d.path_in, d.path_in_lookat, 65280), this.path_out = new r("path_out", this.scene, d.path_out, d.path_out_lookat, 65280), this.mouse = new s($(".hitarea")), this.audio_pos_z = this.config.audio_pos_z_in, this.sounds = { background: this.loader.get_asset("background").data, glitch: this.loader.get_asset("glitch").data, after: this.loader.get_asset("after").data }, this.update_sound_position(), this.sounds.glitch.volume(.5), this.sounds.background.play(), this.sounds.background.loop(!0), this.container = new THREE.Object3D, this.scene.add(this.container), this.attributes = { displacement: { type: "v3", value: [] }, customColor: { type: "c", value: [] } }, this.uniforms = { amplitude: { type: "f", value: 0 } }, d.fog_enabled && (this.uniforms.topColor = { type: "c", value: new THREE.Color(30719) }, this.uniforms.bottomColor = { type: "c", value: new THREE.Color(16777215) }, this.uniforms.offset = { type: "f", value: 33 }, this.uniforms.exponent = { type: "f", value: .6 }, this.uniforms.fogColor = { type: "c", value: this.scene.fog.color }, this.uniforms.fogNear = { type: "f", value: this.scene.fog.near }, this.uniforms.fogFar = { type: "f", value: this.scene.fog.far }, this.uniforms.fogDensity = { type: "f", value: this.scene.fog.density }), window.uniforms = this.uniforms, this.material = new THREE.ShaderMaterial({ uniforms: this.uniforms, attributes: this.attributes, vertexShader: y.vertex(), fragmentShader: y.fragment(), shading: THREE.FlatShading, side: THREE.DoubleSide, wireframe: !0, fog: d.fog_enabled }), this.geometry = this.loader.get_asset("skull").data, this.geometry.dynamic = !0, this.mesh = new THREE.Mesh(this.geometry, this.material), this.mesh.position.y = 4, this.container.add(this.mesh), this.lookat = new THREE.Vector3, this.tessellate_geometry(), this.explode_geometry(), this.colors_and_displacement(), this.glitch(), this.bind(), this.emit("setup:complete"), this.ready = !0 }, e.prototype.bind = function () { return e.__super__.bind.call(this), this.on("transition:in:start", this.on_transition_in_start), this.mouse.on("down", this.on_mouse_down), this.mouse.on("up", this.on_mouse_up), this.mouse.on("move", this.on_mouse_move), this.ui.bind(), this.mouse.bind() }, e.prototype.unbind = function () { return e.__super__.unbind.call(this), this.off("transition:in:start", this.on_transition_in_start), this.mouse.off("down", this.on_mouse_down), this.mouse.off("up", this.on_mouse_up), this.mouse.off("move", this.on_mouse_move), this.ui.unbind(), this.mouse.unbind() }, e.prototype.on_mouse_down = function () { return this.uniforms.amplitude.value = 0, this.glitch_pass.generateTrigger(), this.glitch_pass.goWild = !0, this.sounds.glitch.play(), this.sounds.glitch.loop(!0), this.force_transition_in_complete() }, e.prototype.on_transition_in_start = function () { return TweenLite.to(this.ui.ui.transition_black, 2, { opacity: 0, delay: 3 }) }, e.prototype.on_mouse_move = function () { var t, e, i, n, o; return n = 2 * Math.abs(this.mouse.normal_center_x), this.x = .5 * HALF_PI * this.mouse.normal_center_y, this.y = HALF_PI * this.mouse.normal_center_x, null != (o = this.rotation_tween) && o.kill(), this.mouse.is_down ? (e = Expo.easeOut, t = 1.2) : (e = Cubic.easeOut, t = 20), i = { x: this.x, y: this.y, ease: e }, this.rotation_tween = TweenLite.to(this.mesh.rotation, t, i) }, e.prototype.on_mouse_up = function () { var t, e; return this.glitch_pass.goWild = !1, null != (e = this.speed_tween) && e.kill(), this.accel = 80, t = { accel: 1, ease: Power1.easeOut }, this.speed_tween = TweenLite.to(this, .35, t), this.sounds.glitch.stop(), this.sounds.after.play() }, e.prototype.glitch = function () { return this.composer = new THREE.EffectComposer(m), this.composer.addPass(new THREE.RenderPass(this.scene, c.user)), this.glitch_pass = new THREE.GlitchPass, this.glitch_pass.renderToScreen = !0, this.composer.addPass(this.glitch_pass) }, e.prototype.tessellate_geometry = function () { var t, e, i, n; for (n = new THREE.TessellateModifier(1), i = [], t = e = 0; 12 >= e; t = ++e)i.push(n.modify(this.geometry)); return i }, e.prototype.explode_geometry = function () { var t; return t = new THREE.ExplodeModifier, t.modify(this.geometry) }, e.prototype.colors_and_displacement = function () { var t, e, i, n, o, s, r, a, u, h, l, c, d, p; for (t = this.attributes.customColor.value, e = this.attributes.displacement.value, l = 0, u = [], i = s = 0, a = this.geometry.faces.length; a >= 0 ? a > s : s > a; i = a >= 0 ? ++s : --s)n = 0 * Math.random(), h = 0 * Math.random(), r = .3 * Math.random(), c = 112 * (.5 - Math.random()), d = 112 * (.5 - Math.random()), p = 112 * (.5 - Math.random()), u.push(function () { var i, s; for (s = [], o = i = 0; 2 >= i; o = ++i)t[l] = new THREE.Color, t[l].setHSL(n, h, r), t[l].convertGammaToLinear(), e[l] = new THREE.Vector3, e[l].set(c, d, p), s.push(l += 1); return s }()); return u }, e.prototype.reset_amplitude = function () { var t, e; return null != (e = this.reset_tween) && e.kill(), this.animate_calvarium = !1, t = { value: 0, ease: Power1.easeInOut }, this.reset_tween = TweenLite.to(this.uniforms.amplitude, 1, t) }, e.prototype.update_sound_position = function () { return this.sounds.background.pos(0, 0, this.audio_pos_z), this.sounds.glitch.pos(0, 0, this.audio_pos_z) }, e.prototype.update = function () { return this.ready ? (this.mouse.is_down ? this.uniforms.amplitude.value -= .005 * this.accel : this.uniforms.amplitude.value += 8e-4 * this.accel, this.uniforms.amplitude.value = THREE.Math.clamp(this.uniforms.amplitude.value, 0, 1e4), this.update_sound_position(), m.setSize(b.width, b.height), this.composer.render()) : void 0 }, e.prototype.destroy = function () { return clearTimeout(this.render_interval), e.__super__.destroy.call(this) }, e }(n) }, function (t, e) { var i, n; i = new THREE.DirectionalLight(16777215, 1), i.position.set(0, 100, 10), n = new THREE.PointLight(16777215, 1, 1e3), n.position.set(0, -150, 0), e.lights = [n, i] }, function (t, e) { t.exports = { fog_enabled: !0, transition_debug: !1, has_composer: !0, camera_fov: 80, path_in: [{ x: 0, y: 0, z: 400 }, { x: 0, y: 0, z: 80 }], path_in_lookat: { x: 0, y: 0, z: 0 }, path_out: [{ x: 0, y: .5714285714285836, z: 80.57142857142856 }, { x: 0, y: -10, z: 0 }, { x: -20, y: -20, z: -30 }], path_out_lookat: [{ x: 0, y: 0, z: 0 }, { x: 0, y: 0, z: -400 }], camera_in_duration: 15, camera_out_duration: 6, fog_in_duration: 16, fog_out_duration: 4, fog_in_start: .03, fog_in_end: .01, fog_out_start: .001, fog_out_end: .01, audio_pos_z_in: 10, audio_pos_z_out: -10 } }, function (t, e) { e.vertex = function () { var t; return t = ["uniform float amplitude;", "attribute vec3 customColor;", "attribute vec3 displacement;", "varying vec3 vNormal;", "varying vec3 vColor;", "void main() {", "vNormal = normal;", "vColor = customColor;", "vec3 newPosition = position + amplitude * displacement;", "gl_Position = projectionMatrix * modelViewMatrix * vec4( newPosition, 1.0 );", "}"], t.join("\n") }, e.fragment = function () { var t; return t = ["varying vec3 vNormal;", "varying vec3 vColor;", THREE.ShaderChunk.fog_pars_fragment, "void main() {", "const float ambient = 0.005;", "vec3 light = vec3( 1.0 );", "light = normalize( light );", "float directional = max( dot( vNormal, light ), 0.0 );", "gl_FragColor = vec4( ( directional + ambient ) * vColor, 1.0 );", "gl_FragColor.xyz = sqrt( gl_FragColor.xyz );", THREE.ShaderChunk.fog_fragment, "}"], t.join("\n") } }, function (t, e, i) { var n, o, s, r, a; for (a = i(10), o = [{ id: "GlitchPass", url: "/js/calvarium/GlitchPass.js", type: "js" }, { id: "skull", url: "/js/calvarium/skull.js", type: "geometry" }, { id: "background", url: "/sound/calvarium/background.mp3", type: "sound" }, { id: "glitch", url: "/sound/calvarium/glitch.mp3", type: "sound" }, { id: "after", url: "/sound/calvarium/after.mp3", type: "sound" }], s = 0, r = o.length; r > s; s++)n = o[s], n.url = a.base_path + n.url; t.exports = o }, function (t, e, i) {
        var n, o, s, r, a, u, h, l, d, p, _, f, m, g, y, v, b, w = function (t, e) { return function () { return t.apply(e, arguments) } }, x = function (t, e) { function i() { this.constructor = t } for (var n in e) E.call(e, n) && (t[n] = e[n]); return i.prototype = e.prototype, t.prototype = new i, t.__super__ = e.prototype, t }, E = {}.hasOwnProperty; y = i(10), _ = i(16), f = i(7), a = i(26), u = i(33), v = i(34), b = i(9), g = i(18), o = i(36), m = i(55), p = i(56), d = i(59), s = i(60), l = i(47), h = i(48), r = i(35), t.exports = n = function (t) {
            function e() { return this.on_builder_complete = w(this.on_builder_complete, this), this.generate = w(this.generate, this), this.on_mouse_down = w(this.on_mouse_down, this), this.on_move = w(this.on_move, this), this.update = w(this.update, this), this.change_geometry = w(this.change_geometry, this), this.on_key_up = w(this.on_key_up, this), this.on_key_down = w(this.on_key_down, this), this.set_props = w(this.set_props, this), this.setup = w(this.setup, this), e.__super__.constructor.apply(this, arguments) } return x(e, t), e.prototype.ready = !1, e.prototype.geometry = "", e.prototype.distance = 0, e.prototype.rx = .1, e.prototype.ry = .1, e.prototype.rz = .1, e.prototype.fog_near = 0, e.prototype.audio_pos_z = 0, e.prototype.current_sound_vol = .5, e.prototype.fog_color = 0, e.prototype.setup = function (t) {
                var e, i, n, o, a, b, w, x, E, k; f.fov = this.config.camera_fov, this.ui = new p("elements", this.scene, t), this.keyboard = new r($(window)), this.config.fog_enabled && (this.scene.fog = new THREE.FogExp2(this.fog_color, this.config.fog_in_start), this.gui.add(this.scene.fog, "density", 0, 1), this.fog_near = this.config.fog_near), y.debug && (this.scene.add(new THREE.GridHelper(50, 10)), this.scene.add(new THREE.AxisHelper(10)), this.scene.add(new THREE.CameraHelper(_.user))), this.path_in = new l("path_in", this.scene, this.config.path_in, this.config.path_in_lookat, 65280), this.path_out = new h("path_out", this.scene, this.config.path_out, this.config.path_out_lookat, 65280), this.mouse = new u($("body")), this.set_props("octahedron"),
                    this.audio_pos_z = this.config.audio_pos_z_in, this.sounds = { background: v.get_asset("background", t).data, dodecahedron: v.get_asset("aether", t).data, octahedron: v.get_asset("air", t).data, hexahedron: v.get_asset("earth", t).data, tetrahedron: v.get_asset("fire", t).data, icosahedron: v.get_asset("water", t).data }, x = this.sounds; for (a in x) E = x[a], E.volume(0), E.play(), E.loop(!0); this.update_sound_position(), this.sounds.background.volume(.5), this.sounds.octahedron.fade(0, .5, 400), g.shadowMapEnabled = !0, g.shadowMapSoft = !0, this.scene.add(m.ambient), this.scene.add(m.directional), this.container = new THREE.Object3D, this.scene.add(this.container), this.mesh_container = new THREE.Object3D, this.container.add(this.mesh_container), this.builder = new s, this.sierpinski = new d.SierpinskiPolyhedron, w = { color: 16711680, wireframe: !0, visible: !1 }, k = this.config.sphere_radius, e = 64, this.sphere = new THREE.Mesh(new THREE.SphereGeometry(k, e, e), new THREE.MeshLambertMaterial(w)), this.scene.add(this.sphere), b = []; for (o in this.config.geometries) b.push(o); return n = this.gui.addFolder("controller::elements::mesh"), i = this.gui.addFolder("controller::elements::fog"), n.add(this, "geometry", b).onChange(function (t) { return function (t) { return c.log(t) } }(this)), n.add(this.config, "radius", 20, 100), n.add(this.config, "scale_ratio", 0, 10), n.addColor(this.config, "color"), n.add(this.config, "wireframe"), n.add(this.config, "wireframe_thickness", 1, 10), n.add(this.config, "blending", ["NormalBlending", "AdditiveBlending"]), n.add(this.config, "opacity", 0, 1), n.add(this.config, "deform", -5, 5).onChange(function (t) { return function () { return t.deform_mesh() } }(this)), n.add(this, "rx", 0, 2 * Math.PI), n.add(this, "ry", 0, 2 * Math.PI), n.add(this, "rz", 0, 2 * Math.PI), i.add(this.config, "fog_near", 0, .1), i.add(this.config, "fog_far", 0, .2), i.add(this.config, "fog", 0, .1).listen(), this.once("generated", function (t) { return function () { return t.bind(), t.emit("setup:complete") } }(this)), this.generate()
            }, e.prototype.set_props = function (t) { var e, i, n, o; this.geometry_id = t, e = this.preset(), n = []; for (i in e) o = e[i], n.push(this.config[i] = o); return n }, e.prototype.bind = function () { return c.debug("binding"), f.on("update", this.update), this.keyboard.on("key:down:space", this.on_key_down), this.keyboard.on("key:up:space", this.on_key_up), this.ui.on("change:geometry", this.change_geometry), this.mouse.on("move", this.on_move), this.mouse.on("down", this.on_mouse_down), this.ui.bind(), this.keyboard.bind(), this.mouse.bind() }, e.prototype.unbind = function () { return c.debug("unbinding"), f.off("update", this.update), this.keyboard.off("key:down:space", this.on_key_down), this.keyboard.off("key:up:space", this.on_key_up), this.ui.off("change:geometry", this.generate), this.mouse.off("move", this.on_move), this.mouse.off("down", this.on_mouse_down), this.ui.unbind(), this.keyboard.unbind(), this.mouse.unbind() }, e.prototype.on_key_down = function () { return c.log("down"), this.is_transitioning_in || this.is_transition_disabled ? void 0 : (c.log("x"), this.transition_out_forward()) }, e.prototype.on_key_up = function () { return this.transition_out_backward() }, e.prototype.change_geometry = function (t) { var e, i; return this.sounds[this.geometry_id].fade(this.current_sound_vol, 0, 400), this.set_props(t), this.disable_transition(), this.ui.show_title(t), e = { opacity: 1, ease: Power3.easeOut, onComplete: function (t) { return function () { return t.unbind(), t.generate() } }(this) }, TweenLite.to(this.ui.ui.transition_black, 3.5, e), i = this.preset(), this.sounds[this.geometry_id].fade(0, .5, 400) }, e.prototype.calc_fog = function () { return this.config.fog_far + this.fog_near }, e.prototype.update = function () { var t, e, i; return this.config.fog_enabled && (e = Math.max(this.config.fog_near, this.fog_near), this.mouse.is_dragging && !this.is_transitioning_out && (i = 2 * Math.abs(this.mouse.normal_center_x), this.fog_near = v.lerp(this.config.fog_near, .012, i), this.sounds.background.volume(this.mouse.normal_x), this.current_sound_vol = 1 - this.mouse.normal_x, this.sounds[this.geometry_id].volume(this.current_sound_vol)), this.config.fog = this.calc_fog(), this.scene.fog.density = this.config.fog), this.ready ? (this.mesh.material.wireframe = this.config.wireframe, this.mesh.material.wireframeLinewidth = this.config.wireframe_thickness, this.mesh.material.opacity = this.config.opacity, t = this.config.color.replace("#", "0x"), this.mesh.material.color.setHex(t), this.mesh.rotation.x += 5e-4, this.mesh.rotation.y += 5e-4, this.mesh.rotation.z += 5e-4, this.update_sound_position()) : void 0 }, e.prototype.update_sound_position = function () { return this.sounds.background.pos(0, 0, this.audio_pos_z), this.sounds[this.geometry_id].pos(0, 0, this.audio_pos_z) }, e.prototype.on_move = function () { var t, e, i, n, o, s, r, a, u, h, l, c, d; if (!this.is_transitioning_out) return this.mouse.is_down && (l = .5 * b.width / b.width, c = .5 * b.height / b.height, i = this.mouse.normal_x, null != (r = this.deform_tween) && r.kill(), s = { distance: i, ease: Power2.easeOut, onUpdate: function (t) { return function () { return t.config.deform = t.distance.map(0, 1, -1, 1, i), t.deform_mesh() } }(this) }, this.deform_tween = TweenLite.to(this, .3, s), d = -60 * Math.abs(this.mouse.normal_center_x), this.mesh_container.position.z = d), this.ready ? (null != (a = this.mesh_rotate_tween) && a.kill(), t = .01 * Math.PI, c = v.lerp(-t, t, this.mouse.normal_x), s = { y: c, ease: Power4.easeOut }, this.mesh_rotate_tween = TweenLite.to(this.mesh_container.rotation, 5, s), e = this.config.cam_move_bounds, o = new THREE.Vector2(-e, -e), n = new THREE.Vector2(e, e), null != (u = this.mesh_position_tween) && u.kill(), l = v.lerp(o.x, n.x, this.mouse.normal_x), c = v.lerp(o.y, n.y, this.mouse.normal_y), s = { x: l, y: -c, ease: Power4.easeOut }, this.mesh_position_tween = TweenLite.to(this.mesh_container.position, 5, s), null != (h = this.cam_position_tween) ? h.kill() : void 0) : void 0 }, e.prototype.on_mouse_down = function () { return this.force_transition_in_complete() }, e.prototype.preset = function () { return this.config.geometries[this.geometry_id] }, e.prototype.generate = function () { var t; return this.mesh && this.mesh_container.remove(this.mesh), this.ready = !1, t = this.sierpinski.generate(this.config.geometry, this.config.radius, this.config.iteration, this.config.scale_ratio, 0), this.builder.build(this.config.geometry, t, this.sierpinski.logarithmic_scale(), 0, this.on_builder_complete) }, e.prototype.on_builder_complete = function (t) { var e, i, n, o, s, r, a, u, h, l, c, d, p, _, f; for (d = { color: this.config.color, wireframe: this.config.wireframe, wireframeLinewidth: this.config.wireframe_thickness, blending: THREE[this.config.blending], opacity: this.config.opacity, transparent: !0 }, this.mesh = new THREE.Mesh(t, new THREE.MeshLambertMaterial(d)), this.mesh.castShadow = !0, this.mesh.receiveShadow = !0, this.mesh.rotation.x = this.preset().rotate_x, this.mesh.rotation.y = this.preset().rotate_y, this.mesh.rotation.z = this.preset().rotate_z, this.mesh_container.add(this.mesh), this.data_map = [], p = this.mesh.geometry.vertices, s = u = 0, l = p.length; l > u; s = ++u) { for (o = p[s], i = 1 / 0, r = 0, o.weight = Math.random(), o.position = new THREE.Vector3(o.x, o.y, o.z), _ = this.sphere.geometry.vertices, a = h = 0, c = _.length; c > h; a = ++h)f = _[a], n = f.distanceTo(o), i > n && (i = n, r = a); this.data_map.push({ vertex: r, distance: i }) } return this.config.deform = 0, this.distance = .5, this.deform_mesh(), e = this.config.geometries[this.geometry], this.ready = !0, this.bind(), this.enable_transition(), this.mesh_container.position.z = 0, this.fog_near = this.config.fog_near, d = { opacity: 0, ease: Power4.easeOut, delay: 1.5, onComplete: function (t) { return function () { return t.ui.hide_title() } }(this) }, TweenLite.to(this.ui.ui.transition_black, 2, d), v.delay(.3, function (t) { return function () { return t.emit("generated") } }(this)) }, e.prototype.deform_mesh = function () { var t, e, i, n, o, s, r, a, u, h, l; for (a = this.data_map, e = i = 0, n = a.length; n > i; e = ++i)t = a[e], o = e, u = t.vertex, r = t.distance / 50, h = this.mesh.geometry.vertices[o].position, l = this.sphere.geometry.vertices[u], 0 === h.x && 0 === h.y && 0 === h.z || (s = h.clone().lerp(l.clone(), this.config.deform), this.mesh.geometry.vertices[o].x = s.x, this.mesh.geometry.vertices[o].y = s.y, this.mesh.geometry.vertices[o].z = s.z); return this.mesh.geometry.verticesNeedUpdate = !0 }, e
        }(o)
    }, function (t, e) { var i, n; i = new THREE.AmbientLight(11645361), n = new THREE.DirectionalLight(16777215, .7), n.position.x = 30, n.position.y = 30, n.position.z = 30, n.shadowCameraNear = 25, n.castShadow = !0, e.ambient = i, e.directional = n }, function (t, e, i) { var n, o, s, r, a, u = function (t, e) { return function () { return t.apply(e, arguments) } }, h = function (t, e) { function i() { this.constructor = t } for (var n in e) l.call(e, n) && (t[n] = e[n]); return i.prototype = e.prototype, t.prototype = new i, t.__super__ = e.prototype, t }, l = {}.hasOwnProperty; r = i(37), a = i(34), s = i(57), o = i(58), t.exports = r = function (t) { function e(t, i, o) { var s, r; this.id = t, this.gui = i, this.assets = o, this.on_navlink_click = u(this.on_navlink_click, this), this.on_mouse_out = u(this.on_mouse_out, this), this.on_mouse_over = u(this.on_mouse_over, this), e.__super__.constructor.call(this, this.id, this.assets), this.ui.sequences = this.el.find("[data-sequence]"), this.ui.nav_geometry = this.el.find("nav.geometry"), this.ui.titles = this.el.find(".titles"), this.sequences = {}, s = this.ui.sequences.length, r = 300, this.ui.sequences.each(function (t) { return function (e, i) { var o, s, r; return o = $(i), r = o.data("id"), s = a.get_asset(r + "_sequence", t.assets), t.sequences[r] = new n(o, s) } }(this)) } return h(e, t), e.prototype.curent_id = "octahedron", e.prototype.transition_in = function () { var t, i; return e.__super__.transition_in.call(this), t = 9.5, i = [1, .7, .3, .7, 1], this.ui.sequences.each(function (e) { return function (e, n) { var o, s; return o = $(n), s = { autoAlpha: 1, ease: Power2.easeIn, delay: t + i[e] }, TweenLite.to(o.parent(), 1.5, s) } }(this)), a.delay(t, function (t) { return function () { return t.bind() } }(this)) }, e.prototype.bind = function () { return e.__super__.bind.call(this), this.ui.sequences.on("mouseover", this.on_mouse_over), this.ui.sequences.on("mouseleave", this.on_mouse_out), this.ui.sequences.on("click", this.on_navlink_click) }, e.prototype.unbind = function () { return e.__super__.unbind.call(this), this.ui.sequences.off("mouseover", this.on_mouse_over), this.ui.sequences.off("mouseleave", this.on_mouse_out), this.ui.sequences.off("click", this.on_navlink_click) }, e.prototype.on_mouse_over = function (t) { var e, i; return e = $(t.currentTarget), i = e.data("id"), this.sequences[i].play() }, e.prototype.on_mouse_out = function () { var t, e; return t = $(event.currentTarget), e = t.data("id"), this.sequences[e].stop() }, e.prototype.on_navlink_click = function (t) { var e, i; return t.preventDefault(), e = $(t.currentTarget), i = e.data("id"), this.curent_id !== i ? (this.curent_id = i, this.ui.nav_geometry.find("a").removeClass("active"), this.ui.nav_geometry.find('a[data-id="' + i + '"]').addClass("active"), this.disable_ui(), this.emit("change:geometry", i)) : void 0 }, e.prototype.show_title = function (t) { var e; return TweenLite.set(this.ui.titles.find(".title"), { autoAlpha: 0 }), TweenLite.set(this.ui.titles.find('[data-id="' + t + '"]'), { autoAlpha: 1 }), e = { ease: Power2.easeIn, autoAlpha: 1 }, TweenLite.to(this.ui.titles, 1.6, e), e = { ease: Power2.easeIn, autoAlpha: 0 }, TweenLite.to(this.ui.next_text, 1.6, e) }, e.prototype.hide_title = function () { var t; return this.enable_ui(), t = { ease: Power2.easeIn, autoAlpha: 0 }, TweenLite.to(this.ui.titles, 1.6, t), t = { ease: Power2.easeIn, autoAlpha: 1 }, TweenLite.to(this.ui.next_text, 1.6, t) }, e.prototype.destroy = function () { var t, i, n; i = this.sequences; for (t in i) n = i[t], n.destroy(); return e.__super__.destroy.call(this) }, e }(r), n = function () { function t(t, e) { this.el = t, this.repeat_for_hover = u(this.repeat_for_hover, this), this.player = new s(this.el[0]), this.player.on("setup_complete", function (t) { return function () { return t.mode = new o.LinearMode(t.player.data), t.player.set_mode(t.mode), t.mode.frame = 0, t.mode._update() } }(this)), this.player.noload(e.data, e.images) } return t.prototype.play = function () { return this.mode.play(1, this.mode.total_frames()), this.mode.on("complete", this.repeat_for_hover) }, t.prototype.stop = function () { return this.mode.off("complete", this.repeat_for_hover) }, t.prototype.repeat_for_hover = function () { return this.mode.play(1, this.mode.total_frames()) }, t.prototype.destroy = function () { return this.mode = null, this.player.destroy() }, t }() }, function (t, e, i) { var n, o, s, r = function (t, e) { return function () { return t.apply(e, arguments) } }; s = i(8), t.exports = n = function () { function t(t) { this.el = t, this.update = r(this.update, this), this.set_size = r(this.set_size, this), this.set_mode = r(this.set_mode, this), this.load = r(this.load, this), this._resize = r(this._resize, this), this._update = r(this._update, this), this._setup = r(this._setup, this), s(this), this.el.style.overflow = "hidden" } return t.prototype.el = null, t.prototype.current_frame = -1, t.prototype.spritesheet_index = -1, t.prototype.offset_x = 0, t.prototype.offset_y = 0, t.prototype.mode = null, t.prototype._create_frame = function (t, e) { var i; return i = document.createElement("div"), i.className = e, i.style.position = "absolute", i.style.width = "100%", i.style.height = "100%", t && (i.style.backgroundImage = "url(" + t + ")"), i.style.backgroundRepeat = "no-repeat", i.style.visibility = "hidden", i }, t.prototype._setup = function () { var t, e, i, n, o, s, r, a; for (this.container = document.createElement("div"), this.container.style.position = "absolute", this.el.appendChild(this.container), a = this.data.frame.width * this.data.frame.scale, e = this.data.frame.height * this.data.frame.scale, this.frame_width = this.data.frame.width, this.frame_height = this.data.frame.height, this.max_frames_horizontal = Math.round(this.data.width / this.data.frame.width), this.max_frames_vertical = Math.round(this.data.height / this.data.frame.height), this._frames = [], r = this._cache, i = o = 0, s = r.length; s > o; i = ++o)n = r[i], t = this._create_frame(n.src, "sd_frame"), this._frames.push(t), this.container.appendChild(t); return this._cache = null, this.set_size(a, e), this.emit("setup_complete", this) }, t.prototype._update = function (t) { var e, i, n, o, s, r, a, u, h, l, c, d, p, _, f; for (null == t && (t = !1), n = this.mode.get_frame(), l = Math.floor(n / this.data.frames_per_spritesheet), o = l * this.data.frames_per_spritesheet, c = n - o, s = -1, p = 0, f = 0, _ = r = 0, u = this.max_frames_vertical; u >= 0 ? u > r : r > u; _ = u >= 0 ? ++r : --r)for (d = a = 0, h = this.max_frames_horizontal; h >= 0 ? h > a : a > h; d = h >= 0 ? ++a : --a)if (s++, s === c) { p = d, f = _; break } return e = -(p * this.frame_width), i = -(f * this.frame_height), e += this.offset_x, i += this.offset_y, n !== this.current_frame || t ? (null != this._frames[this.spritesheet_index] && (this._frames[this.spritesheet_index].style.visibility = "hidden", this._frames[this.spritesheet_index].style.zIndex = 0), this.current_frame = n, this.spritesheet_index = l, d = e + "px", _ = i + "px", this._frames[l].style.backgroundPosition = d + " " + _, this._frames[l].style.visibility = "visible", this._frames[l].style.zIndex = 1) : void 0 }, t.prototype._resize = function () { var t; return t = $(window), this.set_size(t.width(), t.height()), this._update(!0) }, t.prototype.load = function (t, e) { return this.path = t, $.ajax({ url: this.path + "/" + e, complete: function (t) { return function (e) { return t.data = JSON.parse(e.responseText), t._load_images() } }(this), error: function (t) { return function (t) { } }(this) }) }, t.prototype.noload = function (t, e) { return this.data = t, this._cache = e, this._setup() }, t.prototype.set_mode = function (t) { var e; return null != (e = this.mode) && e.off("update", this.update), this.mode = t, this.mode.on("update", this.update) }, t.prototype.set_size = function (t, e) { var i, n; return this.width = t, this.height = e, this.el.style.width = this.width + "px", this.el.style.height = this.height + "px", this.container.style.width = this.width + "px", this.container.style.height = this.height + "px", i = $(this.container).find(".sd_frame"), n = o.resize_spritesheet(i, this.data.frame.width, this.data.frame.height, this.width, this.height, this.max_frames_horizontal, this.max_frames_vertical), this.frame_width = n[0], this.frame_height = n[1], this.offset_x = n[2], this.offset_y = n[3], this.frame_width = Math.floor(this.frame_width), this.frame_height = Math.floor(this.frame_height) }, t.prototype.update = function () { return null != this.mode ? this._update() : void 0 }, t.prototype.enable_automatic_resize = function () { return $(window).on("resize", this._resize), this._resize() }, t.prototype.disable_automatic_resize = function () { return $(window).off("resize", this._resize) }, t.prototype.get_total_frames = function () { return this.data.total_frames - 1 }, t.prototype.get_total_spritesheets = function () { return this.data.total_spritesheets - 1 }, t.prototype.destroy = function () { return this.mode.off("update", this.update), this.mode = null, this.__init = null, this.on = null, this.off = null, this.once = null, this.emit = null, this.data = null, this.el.innerHTML = "" }, t }(), o = { calculate_resize: function (t, e, i, n) { var o, s, r, a, u, h, l; return l = i / n, o = t / e, s = e / t, o > l ? (r = n, h = Math.round(r * o), u = 0, a = .5 * i - .5 * h) : (h = i, r = Math.round(h * s), u = .5 * n - .5 * r, a = 0), { x: a, y: u, width: h, height: r } }, resize: function (t, e, i, n, o, s) { var r; return r = this.calculate_resize(e, i, n, o), s ? t.css({ "background-size": r.width + "px " + r.height + "px", "background-position": r.x + "px " + r.y + "px" }) : t.css({ "margin-top": r.y + "px", "margin-left": r.x + "px", width: r.width + "px", height: r.height + "px" }) }, resize_spritesheet: function (t, e, i, n, o, s, r) { var a, u, h; return a = this.calculate_resize(e, i, n, o), u = a.width * s, h = a.height * r, t.css({ "background-size": u + "px " + h + "px" }), [a.width, a.height, a.x, a.y] } } }, function (t, e, i) { var n, o = function (t, e) { return function () { return t.apply(e, arguments) } }; n = i(8), e.FrameMode = function () { function t(t, e) { this.frames = t, this.data = e, this._update = o(this._update, this), this.get_frame = o(this.get_frame, this), n(this) } return t.prototype.id = "Delay", t.prototype.frame = 0, t.prototype.set_frame = function (t) { this.frame = t }, t.prototype.get_frame = function () { var t; return t = Math.floor(this.frame), t = Math.min(t, this.total_frames()), t = Math.max(t, 0) }, t.prototype.total_frames = function () { return this.frames.total_frames - 1 }, t.prototype._update = function () { return this.emit("update") }, t }(), e.LinearMode = function () { function t(t) { this.data = t, this._complete = o(this._complete, this), this._update = o(this._update, this), this.get_frame = o(this.get_frame, this), n(this) } return t.prototype.id = "Linear", t.prototype.frame = 0, t.prototype.play = function (t, e, i) { var n; return null == t && (t = 1), null == e && (e = 1), null == i && (i = Linear.easeNone), this.stop(), this.frame = 0, n = { frame: e, onUpdate: this._update, onComplete: this._complete, ease: i }, this.tween = TweenLite.to(this, t, n) }, t.prototype.stop = function () { return TweenLite.killTweensOf(this.tween) }, t.prototype.get_frame = function () { var t; return t = Math.floor(this.frame), 0 > t ? t = 0 : t > this.total_frames() && (t = this.total_frames()), t }, t.prototype.total_frames = function () { return this.data.total_frames - 1 }, t.prototype._update = function () { return this.emit("update") }, t.prototype._complete = function () { return this.frame = 0, this._update(), this.emit("complete") }, t }(), e.RepeatMode = function () { function t(t) { this.data = t, this._reverse_complete = o(this._reverse_complete, this), this._complete = o(this._complete, this), this._update = o(this._update, this), this.get_frame = o(this.get_frame, this), this.play = o(this.play, this), n(this) } return t.prototype.id = "Linear", t.prototype.frame = 0, t.prototype.repeat = 1, t.prototype.play = function (t, e, i) { var n; return this.duration = null != t ? t : 1, null == e && (e = 1), this.ease = null != i ? i : Linear.easeNone, n = { frame: this.total_frames(), onUpdate: this._update, onComplete: this._complete, ease: this.ease, repeat: this.repeat }, TweenMax.to(this, this.duration, n) }, t.prototype.stop = function () { return TweenMax.killTweensOf(this) }, t.prototype.get_frame = function () { var t; return t = Math.floor(this.frame), 0 > t ? t = 0 : t > this.total_frames() && (t = this.total_frames()), t }, t.prototype.total_frames = function () { return this.data.total_frames - 1 }, t.prototype._update = function () { return this.emit("update") }, t.prototype._complete = function () { return this.emit("complete") }, t.prototype._reverse_complete = function () { return this.emit("reverse_complete"), this.tween.play() }, t }() }, function (t, e) { var i, n; i = function () { function t() { } var e, i; return e = 1.61803399, i = Array, t.prototype.presets = { IcosahedronGeometry: { scale_ratio: 1 + e }, TetrahedronGeometry: { scale_ratio: 2 }, OctahedronGeometry: { scale_ratio: 2 } }, t.prototype.type = null, t.prototype.radius = null, t.prototype.iterations = null, t.prototype.scale_ratio = null, t.prototype.generate = function (t, e, n, o, s) { var r, a, u, h, l, c, d, p, _, f, m, g, y; for (this.geometry_class = null != t ? t : "IcosahedronGeometry", this.radius = null != e ? e : 20, this.iterations = null != n ? n : 1, this.scale_ratio = null != o ? o : 2.61803399, this.detail = null != s ? s : 0, m = 1, r = "BoxGeometry" === this.geometry_class ? new THREE[this.geometry_class](this.radius, this.radius, this.radius) : new THREE[this.geometry_class](this.radius, this.detail), c = [{ vertices: [], center: new THREE.Vector3 }], i = [], p = r.vertices, u = 0, l = p.length; l > u; u++)y = p[u], i.push(y.clone().normalize()), c[0].vertices.push(y.clone()); for (f = 1 - 1 / this.scale_ratio, a = h = 0, _ = this.iterations; _ >= 0 ? _ > h : h > _; a = _ >= 0 ? ++h : --h)m /= this.scale_ratio, d = this.radius * m, g = this._generate_data(c, d, f, a + 1), c = g; return r.dispose(), c }, t.prototype._generate_data = function (t, e, n, o) { var s, r, a, u, h, l, c, d, p, _, f, m, g, y, v, b, w, x, E; for (g = [], h = 0, c = t.length; c > h; h++)for (m = t[h], y = m.vertices, a = l = 0, d = y.length; d > l; a = ++l) { for (v = y[a], b = [], s = m.center.clone().lerp(v.clone(), n), u = _ = 0, p = i.length; p > _; u = ++_)f = i[u], w = s.x + e * i[u].x, x = s.y + e * i[u].y, E = s.z + e * i[u].z, b.push(new THREE.Vector3(w, x, E)); r = { vertices: b, center: s }, g.push(r) } return g }, t.prototype.logarithmic_scale = function () { return this.radius / Math.pow(this.scale_ratio, this.iterations) }, t }(), n = function () { function t() { } var e; return t.prototype.size = null, t.prototype.iterations = null, t.prototype.generate = function (t, e, i, n) { var o, s, r, a, u, h, l, c, d, p, _, f, m; for (this.size = null != t ? t : 20, this.iterations = null != e ? e : 2, this.grid = null != i ? i : 3, this.holes = null != n ? n : [4, 10, 12, 13, 14, 16, 22], r = 1 / this.grid, s = this.size * r, _ = [new THREE.Vector3], a = u = 0, f = this.iterations; f >= 0 ? f > u : u > f; a = f >= 0 ? ++u : --u) { for (m = [], h = 0, l = _.length; l > h; h++)p = _[h], m = m.concat(this._sponge(p, s, this.grid, this.holes)); s *= r, _ = m } for (o = this.size / 2 - this.logarithmic_scale() / 2, d = 0, c = _.length; c > d; d++)p = _[d], p.x -= o, p.y -= o, p.z -= o; return _ }, t.prototype._sponge = function (t, i, n, o) { var s, r, a, u, h, l, c, d, p, _, f, m; for (r = 0, d = [], h = a = 0, p = n; p >= 0 ? p > a : a > p; h = p >= 0 ? ++a : --a)for (m = u = 0, _ = n; _ >= 0 ? _ > u : u > _; m = _ >= 0 ? ++u : --u)for (s = l = 0, f = n; f >= 0 ? f > l : l > f; s = f >= 0 ? ++l : --l)c = new THREE.Vector3, c.x = t.x + m * i, c.y = t.y + h * i, c.z = t.z + s * i, e(r, o) || d.push(c), r++; return d }, e = function (t, e) { var i, n, o, s; for (s = !1, n = 0, o = e.length; o > n; n++)if (i = e[n], i === t) { s = !0; break } return s }, t.prototype.logarithmic_scale = function () { return this.size / Math.pow(this.grid, this.iterations) }, t }(), e.SierpinskiPolyhedron = i, e.SierpinskiSponge = n }, function (t, e) { var i, n, o = function (t, e) { return function () { return t.apply(e, arguments) } }; t.exports = n = function () { function t() { this._on_chunk_complete = o(this._on_chunk_complete, this) } return t.prototype.chunk_size = 10, t.prototype.count = 0, t.prototype.total = 0, t.prototype.progress = 0, t.prototype.geometries = [], t.prototype.build = function (t, e, n, o, s) { var r, a, u, h, l, c; for (this.geometry_class = t, this.data = e, this.size = n, this.detail = o, this.callback = s, this._reset(), a = []; this.data.length > 0;)a.push(this.data.splice(0, this.chunk_size)); for (this.total = a.length, c = [], u = h = 0, l = a.length; l > h; u = ++h)r = a[u], c.push(new i(this.geometry_class, r, this.size, this.detail, this._on_chunk_complete)); return c }, t.prototype._on_chunk_complete = function (t) { var e, i, n, o, s; if (this.count++, this.progress = this.count / this.total, this.geometries.push(t), this.count === this.total) { for (o = new THREE.Geometry, s = this.geometries, i = 0, n = s.length; n > i; i++)e = s[i], o.merge(e); return this.callback(o), this._reset() } }, t.prototype._reset = function () { return this.count = 0, this.total = 0, this.progress = 0, this.geometries = [] }, t }(), i = function () { function t(t, e, i, n, s) { this.geometry_class = t, this.data = e, this.size = i, this.detail = n, this.callback = s, this._build = o(this._build, this), this.progress = 0, this.time_total = 0, this.total = this.data.length, this.geometry = new THREE.Geometry, this._build() } return t.prototype._build = function () { var t, e, i, n, o, s; for (o = "BoxGeometry" === this.geometry_class ? new THREE[this.geometry_class](this.size, this.size, this.size) : new THREE[this.geometry_class](this.size, this.detail), n = this.data[this.progress].vertices, t = e = 0, i = n.length; i > e; t = ++e)s = n[t], o.vertices[t].x = s.x, o.vertices[t].y = s.y, o.vertices[t].z = s.z; return this.geometry.merge(o), this.progress++, this.progress === this.total ? this.callback(this.geometry) : window.setTimeout(this._build, 10) }, t }() }, function (t, e, i) { var n, o, s, r, a, u, h, l, d, p, _, f, m, g, y = function (t, e) { return function () { return t.apply(e, arguments) } }; p = i(8), f = i(10), h = i(16), d = i(7), s = i(26), g = i(34), o = i(35), _ = i(62), m = i(63), l = i(64), a = i(65), u = i(69), r = i(48), t.exports = n = function () { function t(t, e) { this.scene = t, this.gui = e, this.next = y(this.next, this), this.update = y(this.update, this), this.setup = y(this.setup, this), p(this) } return t.prototype.camera_path = null, t.prototype.attributes = null, t.prototype.ready = !1, t.prototype.tweens = Array, t.prototype.has_transitioned_out = !1, t.prototype.is_transitioning = !1, t.prototype.transition_progress = 0, t.prototype.fov_transition_progress = 0, t.prototype.dolly_transition_progress = 0, t.prototype.load = function () { var t, e, i; for (this.loader = new s, e = 0, i = u.length; i > e; e++)t = u[e], this.loader.add(t.id, t.url, t.type); return this.loader.once("loaded", this.setup), this.loader.load() }, t.prototype.setup = function (t) { var e, i, n, s, u, c, p, y, v, b, w, x, E, k, T, z, R, C, A, H, M, S, P, L, O, I, F; for (d.fov = l.camera_fov, this.ui = new a(this.scene, this.gui, t), this.keyboard = new o($(window)), this.tweens = [], l.fog_enabled && (this.scene.fog = new THREE.FogExp2(0, l.fog_in_start), this.gui.add(this.scene.fog, "density", 0, .001)), f.debug && (this.scene.add(new THREE.GridHelper(50, 10)), this.scene.add(new THREE.AxisHelper(10)), this.scene.add(new THREE.CameraHelper(h.user))), u = 0, y = _.length; y > u; u++)v = _[u], this.scene.add(v); for (this.sounds = { start: this.loader.get_asset("start").data, loop: this.loader.get_asset("loop").data, transition_in: this.loader.get_asset("transition_in").data, transition_out: this.loader.get_asset("transition_out").data }, this.sounds.start.play(), this.sounds.transition_in.play(), g.delay(19, function (t) { return function () { return t.sounds.loop.volume(0), t.sounds.loop.fade(0, 1, 1e3), t.sounds.loop.play(), t.sounds.loop.loop(!0) } }(this)), this.container = new THREE.Object3D, this.scene.add(this.container), this.container.position.fromArray(l.container_position), this.container.rotation.fromArray(l.container_rotation), i = 1e4, l.add_controls && (this.gui.add(this.container.rotation, "x", 0, PI_2).name("rotation x"), this.gui.add(this.container.rotation, "y", 0, PI_2).name("rotation y"), this.gui.add(this.container.rotation, "z", 0, PI_2).name("rotation z"), this.gui.add(this.container.position, "x", -i, i).name("position x"), this.gui.add(this.container.position, "y", -i, i).name("position y"), this.gui.add(this.container.position, "z", -i, i).name("position z")), this.attributes = { size: { type: "f", value: [] }, alpha: { type: "f", value: [] } }, M = { color: { type: "c", value: new THREE.Color(16777215) }, texture: { type: "t", value: THREE.ImageUtils.loadTexture(this.loader.get_asset("particle").src) } }, l.fog_enabled && (M.topColor = { type: "c", value: new THREE.Color(30719) }, M.bottomColor = { type: "c", value: new THREE.Color(16777215) }, M.offset = { type: "f", value: 33 }, M.exponent = { type: "f", value: .6 }, M.fogColor = { type: "c", value: this.scene.fog.color }, M.fogNear = { type: "f", value: this.scene.fog.near }, M.fogFar = { type: "f", value: this.scene.fog.far }, M.fogDensity = { type: "f", value: this.scene.fog.density }), b = new THREE.ShaderMaterial({ uniforms: M, attributes: this.attributes, vertexShader: m.vertex(), fragmentShader: m.fragment(), blending: THREE.AdditiveBlending, transparent: !0, fog: l.fog_enabled }), n = new THREE.Geometry, z = 350 * l.scale, T = 2e3 * l.scale, O = 10, I = 400 * l.scale, H = 20, A = 40, s = c = 0, R = l.partices; R >= 0 ? R > c : c > R; s = R >= 0 ? ++c : --c)e = g.random(0, PI_2), k = g.random(z, T), P = k * Math.cos(e), L = I * Math.cos(k / T * Math.PI), F = k * Math.sin(e), n.vertices.push(new THREE.Vector3(P, L, F)), this.attributes.alpha.value[s] = g.random(.2, 1), this.attributes.size.value[s] = g.random(H, A); for (this.mesh = new THREE.PointCloud(n, b), this.container.add(this.mesh), H = 40, A = 80, n = new THREE.Geometry, T = z, z = 150 * l.scale, I = 1e3 * l.scale, s = p = 0, C = l.tunnel_particles; C >= 0 ? C > p : p > C; s = C >= 0 ? ++p : --p)e = g.random(0, PI_2), k = g.random(z, T), E = Math.random(), P = k * Math.cos(e), L = 13422 + I * Math.cos(k / T * Math.PI), F = k * Math.sin(e), n.vertices.push(new THREE.Vector3(P, L, F)), x = g.random(.2, 1), E = L / I, E > .5 && (x += g.lerp(x, 0, .5 + E)), this.attributes.alpha.value[s] = x, this.attributes.size.value[s] = g.random(H, A); return this.tunnel_mesh = new THREE.PointCloud(n, b), this.container.add(this.tunnel_mesh), w = new THREE.Mesh(new THREE.SphereGeometry(100, 4, 4)), w.position.y = 15e3, w.visible = !1, this.container.add(w), this.container.updateMatrixWorld(), S = new THREE.Vector3, S.setFromMatrixPosition(w.matrixWorld), l.path_camera_dolly.unshift(S.toArray()), l.path_in.unshift({ x: S.x, y: S.y, z: S.z }), l.path_out.push({ x: S.x, y: S.y, z: S.z }), l.path_in_lookat.unshift({ x: S.x, y: S.y, z: S.z }), this.path_in = new r("path_in", this.scene, l.path_in, l.path_in_lookat, 65280), this.path_out = new r("path_out", this.scene, l.path_out, l.path_in_lookat.reverse(), 65280), this.ready = !0, this.emit("setup:complete"), this.bind() }, t.prototype.bind = function () { return this.keyboard.bind(), d.on("update", this.update) }, t.prototype.unbind = function () { return this.keyboard.unbind(), d.off("update", this.update) }, t.prototype.transition_in = function () { var t, e; return this.is_transitioning = !0, this.emit("transition:in:complete"), h.user.position.fromArray(l.path_in[0]), h.user.lookAt(new THREE.Vector3), this.ui.transition_in(), this.kill_tweens(), e = { progress: 0 }, t = { progress: 1, ease: Power2.easeOut, onUpdate: function (t) { return function () { var i; return i = t.path_in.spline.getPointAt(e.progress), h.user.position.copy(i), i = t.path_in.spline_camera.getPointAt(e.progress), h.user.lookAt(i) } }(this), onComplete: function (t) { return function () { return t.is_transitioning = !1 } }(this) }, l.transition_debug && (l.camera_in_duration = .1), this.tweens.push(TweenLite.to(e, l.camera_in_duration, t)), l.fog_enabled ? (this.scene.fog.density = l.fog_in_start, t = { density: l.fog_in_end, ease: Power2.easeOut }, l.transition_debug && (l.fog_in_duration = 0), this.tweens.push(TweenLite.to(this.scene.fog, l.fog_in_duration, t))) : void 0 }, t.prototype.transition_out_forward = function (t) { var e, i; return null == t && (t = !1), this.is_transitioning ? void this.transition_out_fast() : (this.is_transitioning = !0, this.ui.transition_out(), this.kill_tweens(), i = { progress: 0 }, e = { progress: 1, ease: Power3.easeInOut, onStart: function (t) { return function () { return t.sounds.transition_out.play() } }(this), onUpdate: function (t) { return function () { var e; return e = t.path_out.spline.getPointAt(i.progress), h.user.position.copy(e), e = t.path_out.spline_camera.getPointAt(i.progress), h.user.lookAt(e) } }(this), onComplete: function (t) { return function () { return t.is_transitioning = !1, t.next() } }(this) }, this.tweens.push(TweenLite.to(i, l.camera_out_duration, e)), l.fog_enabled ? (this.scene.fog.density = l.fog_in_end, e = { density: l.fog_in_start, ease: Power2.easeOut, delay: l.camera_out_duration - 2 }, this.tweens.push(TweenLite.to(this.scene.fog, l.fog_out_duration, e))) : void 0) }, t.prototype.update = function () { var t; if (this.ready) return t = .001, this.mesh.rotation.y += t, this.tunnel_mesh.rotation.y += t }, t.prototype.transition_out_fast = function () { return c.log("transition_out_fast"), this.ui.once("transition:out:fast:complete", function (t) { return function () { return t.kill_tweens(), t.next() } }(this)), this.ui.transition_out_fast() }, t.prototype.next = function () { return this.has_transitioned_out = !0, this.emit("next") }, t.prototype.kill_tweens = function () { var t, e, i, n, o; for (i = this.tweens, n = [], t = 0, e = i.length; e > t; t++)o = i[t], n.push(null != o ? o.kill() : void 0); return n }, t.prototype.enable_transition = function () { }, t.prototype.disable_transition = function () { }, t.prototype.destroy = function () { var t, e, i; e = this.sounds; for (t in e) i = e[t], i.fade(1, 0, 1e3); return g.delay(1, function (e) { return function () { var n, o, s, r, a; for (r = e.scene.children, n = 0, o = r.length; o > n; n++)s = r[n], e.scene.remove(s); a = e.sounds; for (t in a) i = a[t], i.stop(), i.unload(); return e.kill_tweens(), e.unbind(), e.ui.destroy(), e.loader.dispose(), e.emit("destroyed") } }(this)) }, t }() }, function (t, e) { var i, n; i = new THREE.AmbientLight(16777215), n = new THREE.DirectionalLight(16777215, .6), t.exports = [i, n] }, function (t, e) {
        e.vertex = function () { var t; return t = ["attribute float alpha;", "attribute float size;", "varying float vAlpha;", "void main() {", "vAlpha = alpha;", "vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );", "gl_PointSize = size * ( 100.0 / length( mvPosition.xyz ) );", "gl_Position = projectionMatrix * mvPosition;", "}"], t.join("\n") }, e.fragment = function () {
            var t; return t = ["uniform vec3 color;", "varying float vAlpha;", "uniform sampler2D texture;", THREE.ShaderChunk.fog_pars_fragment, "void main() {", "gl_FragColor = vec4( color, vAlpha );", "gl_FragColor = gl_FragColor * texture2D( texture, gl_PointCoord );", THREE.ShaderChunk.fog_fragment, "}"],
                t.join("\n")
        }
    }, function (t, e) { t.exports = { add_controls: !1, transition_debug: !1, fog_enabled: !0, camera_fov: 80, camera_fov_out: 120, camera_fov_out_duration: 10, path_in: [{ x: 0, y: 0, z: 0 }, { x: 1200, y: 2571, z: 9257.142857142859 }, { x: -3164.0482279868447, y: 13828.571428571428, z: 9257.142857142859 }, { x: -5034.709535988308, y: 2e4, z: 8059.919620021923 }], path_out: [{ x: -5034.709535988308, y: 2e4, z: 8059.919620021923 }, { x: 1200, y: 3571, z: 5e3 }, { x: 0, y: 0, z: 0 }], path_in_lookat: [{ x: 0, y: 0, z: 0 }], path_camera_dolly: [[0, 0, 0]], camera_in_duration: 40, camera_out_duration: 10, fog_in_duration: 2, fog_out_duration: 2, ui_delay: 3, fog_in_start: 7e-4, fog_in_end: 7e-5, scale: 10, partices: 4e5, tunnel_particles: 3e4, container_position: [1500, 1050, 4400], container_rotation: [4.4, .01, .28] } }, function (t, e, i) { var n, o, s, r, a, u, h, l, c, d, p, _, f, m, g = function (t, e) { return function () { return t.apply(e, arguments) } }; d = i(8), h = i(16), m = i(34), _ = i(10), c = i(38), r = i(66), l = i(64), p = i(39), a = i(41), s = i(57), o = i(58), f = i(67), t.exports = u = function () { function t(t, e, i) { this.scene = t, this.gui = e, this.assets = i, this.on_social_click = g(this.on_social_click, this), this.ui = { dim: ".dim", hitarea: ".hitarea", transition_black: ".transition_black", hires: "h1 a", preface: "h2", paragraphs: ".paragraphs dd, .paragraphs dt", next: ".next", social: ".social", social_links: ".social a" }, d(this), this.tweens = [], this.render() } return t.prototype.render = function () { var t, e, o, s, r, a; e = p.get("epilogue"), a = i(68), $("main").append(a({ data: e })), this.el = $("#" + e.id), r = this.ui; for (s in r) o = r[s], this.ui[s] = this.el.find(o); return this.ui.letters = this.ui.paragraphs.lettering().children(), this.ui.next_letters = this.ui.next.lettering().children(), this.ui.dim.remove(), t = m.get_asset("hires_sequence", this.assets), this.ui.sequence = new n(this.ui.hires, t), this.bind() }, t.prototype.bind = function () { return this.ui.social_links.on("click", this.on_social_click) }, t.prototype.unbind = function () { return this.ui.social_links.off("click", this.on_social_click) }, t.prototype.on_social_click = function (t) { var e, i; switch (t.preventDefault(), e = $(t.currentTarget), i = e.data("share")) { case "facebook": return f.facebook(_.share_url, c.get("share_text")); case "twitter": return f.twitter(_.share_url, c.get("share_text")); case "google": return f.plus(_.share_url) } }, t.prototype.transition_in = function () { var t, e; return e = { delay: l.ui_delay + 10, autoAlpha: 1, ease: Power4.easeIn }, TweenLite.to(this.ui.preface, 1.2, e), m.delay(l.ui_delay + 14, function (t) { return function () { return t.ui.sequence.play() } }(this)), t = l.ui_delay + 15, m.delay(t, function (t) { return function () { var e; return e = new a, e.animate(t.ui.letters, 4e3) } }(this)), t = l.ui_delay + 21, e = { delay: t, autoAlpha: 1, ease: Power2.easeIn }, TweenLite.to(this.ui.social, 1, e) }, t.prototype.transition_out = function () { var t; return this.kill_tweens(), t = { autoAlpha: 0, ease: Power2.easeOut }, this.tweens.push(TweenLite.to(this.el, 1.6, t)) }, t.prototype.transition_out_fast = function () { var t; return this.ui.transition_black.removeClass("layer-0").addClass("layer-5"), t = { autoAlpha: 1, ease: Power2.easeOut, onComplete: function (t) { return function () { return t.emit("transition:out:fast:complete") } }(this) }, TweenLite.to(this.ui.transition_black, 1.3, t) }, t.prototype.kill_tweens = function () { var t, e, i, n, o; for (i = this.tweens, n = [], t = 0, e = i.length; e > t; t++)o = i[t], n.push(null != o ? o.kill() : void 0); return n }, t.prototype.destroy = function () { var t; return this.unbind(), null != (t = this.sequence) && t.destroy(), this.el.remove() }, t }(), n = function () { function t(t, e) { this.el = t, this.player = new s(this.el[0]), this.player.on("setup_complete", function (t) { return function () { return t.mode = new o.LinearMode(t.player.data), t.player.set_mode(t.mode) } }(this)), this.player.noload(e.data, e.images) } return t.prototype.play = function () { return this.mode.once("complete", function (t) { return function () { return t.mode.frame = t.mode.total_frames(), t.mode._update() } }(this)), this.mode.play(5, this.mode.total_frames()) }, t.prototype.destroy = function () { return this.mode = null, this.player.destroy() }, t }() }, function (t, e, i) { var n, o; o = i(34), t.exports = n = function () { function t() { } return t.prototype.create = function (t) { var e, i, n, s, r, a, u, h; for (u = { text: "x", size: 80, height: 10, curve_segments: 2, font: "montserrat", color: 16777215 }, o.merge(u, t), e = new THREE.TextGeometry(u.text, { size: u.size, height: u.height, curveSegments: u.curve_segments, font: u.font }), e.computeBoundingBox(), a = e.vertices, i = 0, n = a.length; n > i; i++)h = a[i], h.x += -.5 * (e.boundingBox.max.x - e.boundingBox.min.x); return s = new THREE.MeshBasicMaterial({ color: u.color, transparent: !0 }), r = new THREE.Mesh(e, s) }, t.prototype.create_multichar = function (t) { var e, i, n, s, r, a, u, h, l, c, d, p, _, f, m; for (f = { text: "x", size: 80, height: 10, line_height: 160, curve_segments: 2, font: "montserrat", color: 16777215 }, o.merge(f, t), a = f.text.length, c = [], d = a * f.size / 2 - f.size / 2, n = s = 0, p = a; p >= 0 ? p > s : s > p; n = p >= 0 ? ++s : --s) { for (e = f.text.charAt(n), i = new THREE.TextGeometry(e, { size: f.size, height: f.height, curveSegments: f.curve_segments, font: f.font }), i.computeBoundingBox(), _ = i.vertices, r = 0, u = _.length; u > r; r++)m = _[r], m.x += -.5 * (i.boundingBox.max.x - i.boundingBox.min.x), m.y += -.5 * (i.boundingBox.max.y - i.boundingBox.min.y); h = new THREE.MeshBasicMaterial({ color: f.color, transparent: !0, depthTest: !1 }), l = new THREE.Mesh(i, h), l.position.x = n * f.size - d, c.push(l) } return c }, t.prototype.create_multiline = function (t) { var e, i, n, s, r, a, u, h, l, c, d, p, _, f; for (_ = { text: "x", size: 80, height: 10, line_height: 160, curve_segments: 2, font: "montserrat", color: 16777215 }, o.merge(_, t), l = _.text.split("\\n"), i = new THREE.Geometry, n = s = 0, a = l.length; a > s; n = ++s) { for (h = l[n], e = new THREE.TextGeometry(h, { size: _.size, height: _.height, curveSegments: _.curve_segments, font: _.font }), e.computeBoundingBox(), p = e.vertices, r = 0, u = p.length; u > r; r++)f = p[r], f.x += -.5 * (e.boundingBox.max.x - e.boundingBox.min.x), f.y -= n * _.line_height; i.merge(e) } return c = new THREE.MeshBasicMaterial({ color: _.color, transparent: !0 }), d = new THREE.Mesh(i, c) }, t }() }, function (t, e) { var i, n = function (t, e) { return function () { return t.apply(e, arguments) } }; i = function () { function t() { this.weibo = n(this.weibo, this), this.renren = n(this.renren, this), this.twitter = n(this.twitter, this), this.facebook = n(this.facebook, this), this.tumblr = n(this.tumblr, this), this.pinterest = n(this.pinterest, this), this.plus = n(this.plus, this), this.open_window = n(this.open_window, this), this.url = window.location.href } return t.prototype.open_window = function (t, e, i) { var n, o; return n = screen.availWidth - e >> 1, o = screen.availHeight - i >> 1, window.open(t, "", "top=" + o + ",left=" + n + ",width=" + e + ",height=" + i + ",location=no,menubar=no"), !1 }, t.prototype.plus = function (t) { return t = encodeURIComponent(t || this.url), this.open_window("https://plus.google.com/share?url=" + t, 650, 385), !1 }, t.prototype.pinterest = function (t, e, i) { return t = encodeURIComponent(t || this.url), e = encodeURIComponent(e), i = encodeURIComponent(i), this.open_window("http://www.pinterest.com/pin/create/button/?url=" + t + "&media=" + e + "&description=" + i, 735, 310), !1 }, t.prototype.tumblr = function (t, e, i) { return t = encodeURIComponent(t || this.url), e = encodeURIComponent(e), i = encodeURIComponent(i), this.open_window("http://www.tumblr.com/share/photo?source=" + e + "&caption=" + i + "&click_thru=" + t, 450, 430), !1 }, t.prototype.facebook = function (t, e) { var i; return null == e && (e = ""), t = encodeURIComponent(t || this.url), i = encodeURIComponent(e), this.open_window("http://www.facebook.com/share.php?u=" + t + "&t=" + i, 600, 300), !1 }, t.prototype.twitter = function (t, e) { var i; return null == e && (e = ""), t = encodeURIComponent(t || this.url), "" === e && (e = "Generic share text here!"), i = encodeURIComponent(e), this.open_window("http://twitter.com/intent/tweet/?text=" + i + "&url=" + t, 600, 300), !1 }, t.prototype.renren = function (t) { return t = encodeURIComponent(t || this.url), this.open_window("http://share.renren.com/share/buttonshare.do?link=" + t, 600, 300), !1 }, t.prototype.weibo = function (t) { return t = encodeURIComponent(t || this.url), this.open_window("http://service.weibo.com/share/share.php?url=" + t + "&language=zh_cn", 600, 300), !1 }, t }(), t.exports = new i }, function (t, e, i) { var n = i(43); t.exports = function (t) { var e, i = [], o = t || {}; return function (o) { i.push("<div" + n.attr("id", "" + t.data.id, !0, !1) + ' class="section scene layer layer_0"><div class="transition_black layer layer-0"></div><div class="ui"><div class="dim layer layer-0"></div><div class="content"><div class="hitarea layer layer-0"></div><h2 class="layer layer-1 font-garamond bold">EPILOGUE</h2><h1 class="hi_res layer layer-1"><a href="http://hi-res.net" title="Hi-ReS!" target="_blank"></a></h1><div class="paragraphs layer"><dl>'), function () { var n = t.data.paragraphs; if ("number" == typeof n.length) for (var o = 0, s = n.length; s > o; o++) { var r = n[o]; i.push("" + (null == (e = r) ? "" : e) + "<br/>") } else { var s = 0; for (var o in n) { s++; var r = n[o]; i.push("" + (null == (e = r) ? "" : e) + "<br/>") } } }.call(this), i.push('</dl></div><ul class="social layer"><li><a href="#" data-share="facebook" class="facebook"></a></li><li><a href="#" data-share="twitter" class="twitter"></a></li><li><a href="#" data-share="google" class="googleplus"></a></li></ul></div></div></div>') }.call(this, "undefined" in o ? o.undefined : void 0), i.join("") } }, function (t, e, i) { var n, o, s, r, a; for (a = i(10), o = [{ id: "particle", url: "/img/home/particle.jpg", type: "image" }, { id: "hires_logo", url: "/img/home/hires.png", type: "image" }, { id: "hires_sequence", url: "/img/epilogue/hires.frames.json", type: "sequence" }, { id: "start", url: "/sound/home/start.mp3", type: "sound" }, { id: "loop", url: "/sound/home/loop.mp3", type: "sound" }, { id: "transition_in", url: "/sound/epilogue/transition_in.mp3", type: "sound" }, { id: "transition_out", url: "/sound/epilogue/transition_out.mp3", type: "sound" }], s = 0, r = o.length; r > s; s++)n = o[s], n.url = a.base_path + n.url; t.exports = o }, function (t, e, i) { var n, o, s, r, a, u, h, l, c, d, p, _, f, m, g, y = function (t, e) { return function () { return t.apply(e, arguments) } }, v = function (t, e) { function i() { this.constructor = t } for (var n in e) b.call(e, n) && (t[n] = e[n]); return i.prototype = e.prototype, t.prototype = new i, t.__super__ = e.prototype, t }, b = {}.hasOwnProperty; _ = i(8), m = i(10), c = i(16), p = i(7), s = i(26), r = i(33), g = i(34), n = i(36), f = i(71), d = i(72), h = i(37), l = i(73), u = i(47), a = i(48), t.exports = o = function (t) { function e() { return this.update = y(this.update, this), this.on_mouse_down = y(this.on_mouse_down, this), this.setup = y(this.setup, this), e.__super__.constructor.apply(this, arguments) } return v(e, t), e.prototype.material = null, e.prototype.holding_frames = 0, e.prototype.setup = function (t) { var e, n, o, s, l, _, g, y, v, b, w, x, E, k, T, z, R; for (p.fov = d.camera_fov, this.ui = new h("hires", this.scene, this.gui), d.fog_enabled && (this.scene.fog = new THREE.FogExp2(0, d.fog_in_start), this.gui.add(this.scene.fog, "density", 0, 1)), m.debug && (this.scene.add(new THREE.GridHelper(50, 10)), this.scene.add(new THREE.AxisHelper(10)), this.scene.add(new THREE.CameraHelper(c.user))), x = f.all, s = 0, g = x.length; g > s; s++)b = x[s], this.scene.add(b); for (this.path_in = new u("path_in", this.scene, d.path_in, d.path_in_lookat, 65280), this.path_out = new a("path_out", this.scene, d.path_out, d.path_out_lookat, 65280, this.gui, 100), this.mouse = new r($(".hitarea")), this.gui.addColor(d, "color_left").name("Left color"), this.gui.addColor(d, "color_right").name("Right color"), this.gui.addColor(d, "color_directional").name("Directional color"), this.gui.add(d, "speed", 0, 2).name("Movement speed"), this.gui.add(d, "camera_fov", 10, 200).listen().name("Field of vision"), this.gui.add(d, "line_thickness", 1, 8).name("Line thickness"), e = i(74), this.sound = new e, setTimeout(function (t) { return function () { return t.sound.klank(), t.sound.percolation(), t.sound.clickable_distortion(), t.sound.background_atmos(15) } }(this), 1e3), this.container = new THREE.Object3D, this.scene.add(this.container), z = [], l = 0, y = t.length; y > l; l++)n = t[l], "pos-x" !== (E = n.id) && "neg-x" !== E && "pos-y" !== E && "neg-y" !== E && "pos-z" !== E && "neg-z" !== E || z.push(n.src); for (this.cubemap = THREE.ImageUtils.loadTextureCube(z), this.cubemap.format = THREE.RGBFormat, T = THREE.ShaderLib.cube, T.uniforms.tCube.texture = this.cubemap, this.material = new THREE.ShaderMaterial({ fragmentShader: T.fragmentShader, vertexShader: T.vertexShader, uniforms: T.uniforms, depthWrite: !1, side: THREE.BackSide }), o = this.loader.get_asset("hires_logo").data, k = o.vertices, _ = 0, v = k.length; v > _; _++)R = k[_], R.multiplyScalar(10); return o.__dirtyVertices = !0, w = { shading: THREE.FlatShading, color: 16777215 }, this.mesh = new THREE.Mesh(o, new THREE.MeshLambertMaterial(w)), this.mesh.position.x = 20, this.scene.add(this.mesh), this.add_triangles(), this.bind(), this.emit("setup:complete") }, e.prototype.add_triangles = function () { var t, e, i, n, o, s, r, a, u, h, l, c, p, _, f, m, g, y, v, b, w, x, E, k, T, z, R, C, A; for (l = this.mesh.geometry.vertices.length, b = function (t) { return Math.floor(Math.random() * t) }, _ = [], t = 2 * Math.PI, e = function (e) { var i, n, o, s, r; return i = new THREE.Vector3, o = i.clone(), o.x += e * Math.cos(Math.random() * t), o.y += e * Math.sin(Math.random() * t), o.z += e * Math.sin(Math.random() * t), s = i.clone(), s.x += e * Math.cos(Math.random() * t), s.y += e * Math.sin(Math.random() * t), s.z += e * Math.sin(Math.random() * t), r = i.clone(), r.x += e * Math.cos(Math.random() * t), r.y += e * Math.sin(Math.random() * t), r.z += e * Math.sin(Math.random() * t), n = new THREE.Geometry, n.vertices.push(o), n.vertices.push(s), n.vertices.push(r), n.faces.push(new THREE.Face3(0, 1, 2)), n.computeFaceNormals(), n }, g = 1, m = 50, T = [], i = new THREE.Geometry, l = 1e3, s = a = 0, w = l; w >= 0 ? w > a : a > w; s = w >= 0 ? ++a : --a) { for (v = this.mesh.geometry.vertices[b(l)], k = g + Math.random() * (m - g), o = e(k), x = o.vertices, s = u = 0, c = x.length; c > u; s = ++u)z = x[s], o.vertices[s].x += v.x, o.vertices[s].y += v.y, o.vertices[s].z += v.z; i.merge(o) } for (y = { envMap: this.cubemap, shading: THREE.FlatShading, wireframe: !0, wireframeLinewidth: d.line_thickness }, f = new THREE.MeshLambertMaterial(y), this.triangles_mesh = new THREE.Mesh(i, f), this.scene.add(this.triangles_mesh), E = this.triangles_mesh.geometry.faces, r = h = 0, p = E.length; p > h; r = ++h)n = E[r], R = this.triangles_mesh.geometry.vertices[n.a], C = this.triangles_mesh.geometry.vertices[n.b], A = this.triangles_mesh.geometry.vertices[n.c], R.pos = new THREE.Vector3(R.x, R.y, R.z), C.pos = new THREE.Vector3(C.x, C.y, C.z), A.pos = new THREE.Vector3(A.x, A.y, A.z); return this.ready = !0 }, e.prototype.bind = function () { return e.__super__.bind.call(this), this.mouse.on("down", this.on_mouse_down), this.ui.bind(), this.mouse.bind() }, e.prototype.unbind = function () { return e.__super__.unbind.call(this), this.mouse.off("down", this.on_mouse_down), this.ui.unbind(), this.mouse.unbind() }, e.prototype.transition_in = function () { var t, e, i, n; return this.emit("transition:in:complete"), this.is_transitioning = !0, e = this.config.path_in[0], c.user.position.set(e.x, e.y, e.z), c.user.lookAt(new THREE.Vector3(e.x, e.y, e.z)), c.user.rotation.z = Math.PI, this.ui.transition_in(), i = { progress: 0 }, t = { progress: 1, ease: Power1.easeInOut, onStart: function () { }, onUpdate: function (t) { return function () { return e = t.path_in.spline.getPointAt(i.progress), c.user.position.copy(e) } }(this), onComplete: function (t) { return function () { return t.is_transitioning = !1 } }(this) }, this.config.transition_debug && (this.config.camera_in_duration = 0), TweenLite.to(i, this.config.camera_in_duration, t), n = { progress: 0 }, t = { progress: 1, onComplete: function (t) { return function () { return t.ui.transition_out() } }(this) }, this.ui_tween = TweenLite.to(n, this.config.camera_in_duration, t), t = { z: 2 * Math.PI }, this.config.transition_debug && (this.config.camera_rotation_in = 0), TweenLite.to(c.user.rotation, this.config.camera_rotation_in, t), this.config.fog_enabled && (this.scene.fog.density = this.config.fog_in_start, t = { density: this.config.fog_in_end, ease: Power2.easeOut }, this.config.transition_debug && (this.config.fog_in_duration = 0), TweenLite.to(this.scene.fog, this.config.fog_in_duration, t)), p.fov = 150, t = { fov: d.camera_fov, ease: Power3.easeOut }, this.config.transition_debug && (this.config.fov_in_duration = 0), TweenLite.to(p, this.config.fov_in_duration, t) }, e.prototype.on_mouse_down = function () { return this.force_transition_in_complete() }, e.prototype.update = function () { var t, e, i, n, o, s, r, a, u, h, l, c, p, _, m, g; if (this.ready) { for (a = this.mouse.normal_center_x, u = this.mouse.normal_center_y, c = .3 * Math.PI * -u, p = .3 * Math.PI * -a, h = this.triangles_mesh.rotation, t = c - h.x, e = p - h.y, i = Math.sqrt(t * t + e * e), this.triangles_mesh.rotation.x += t * d.speed, this.triangles_mesh.rotation.y += e * d.speed, this.mesh.rotation.x = this.triangles_mesh.rotation.x, this.mesh.rotation.y = this.triangles_mesh.rotation.y, this.normalize(this.triangles_mesh), this.normalize(this.mesh), this.mouse.is_down && !this.is_transitioning_out ? this.holding_frames += .5 : this.holding_frames -= 2, this.holding_frames = Math.max(this.holding_frames, 0), this.holding_frames = Math.min(this.holding_frames, 60), this.noise = this.holding_frames / 10 || .05, l = this.triangles_mesh.geometry.faces, o = s = 0, r = l.length; r > s; o = ++s)n = l[o], _ = this.triangles_mesh.geometry.vertices[n.a], m = this.triangles_mesh.geometry.vertices[n.b], g = this.triangles_mesh.geometry.vertices[n.c], _.x = _.pos.x + (-this.noise + Math.random() * (2 * this.noise)), _.y = _.pos.y + (-this.noise + Math.random() * (2 * this.noise)), _.z = _.pos.z + (-this.noise + Math.random() * (2 * this.noise)), m.x = m.pos.x + (-this.noise + Math.random() * (2 * this.noise)), m.y = m.pos.y + (-this.noise + Math.random() * (2 * this.noise)), m.z = m.pos.z + (-this.noise + Math.random() * (2 * this.noise)), g.x = g.pos.x + (-this.noise + Math.random() * (2 * this.noise)), g.y = g.pos.y + (-this.noise + Math.random() * (2 * this.noise)), g.z = g.pos.z + (-this.noise + Math.random() * (2 * this.noise)); return this.triangles_mesh.geometry.verticesNeedUpdate = !0, f.point1.intensity = .5 * Math.abs(2 * a), f.point2.intensity = Math.max(0, u), f.point1.color.setHex(String(d.color_left).replace("#", "0x")), f.point2.color.setHex(String(d.color_right).replace("#", "0x")), f.directional.color.setHex(String(d.color_directional).replace("#", "0x")), this.triangles_mesh.material.wireframeLinewidth = d.line_thickness } }, e.prototype.normalize = function (t) { return t.rotation.x = Math.min(.5, Math.max(-.5, t.rotation.x)), t.rotation.y = Math.min(.5, Math.max(-.5, t.rotation.y)) }, e.prototype.destroy = function () { return e.__super__.destroy.call(this), this.sound.stop() }, e }(n) }, function (t, e) { var i, n, o, s; i = new THREE.AmbientLight(4276545), n = new THREE.DirectionalLight(16777215, 1), n.position.x = 100, n.position.y = 100, n.position.z = 100, n.shadowCameraNear = 25, n.castShadow = !0, o = new THREE.PointLight(16777215, 1, 1e3), o.position.set(50, 50, 50), s = new THREE.PointLight(16777215, 1, 1e3), s.position.set(-50, 50, 50), o.intensity = .1, s.intensity = .1, e.directional = n, e.point1 = o, e.point2 = s, e.all = [i, n, o, s] }, function (t, e, i) { var n; n = i(10), t.exports = { fog_enabled: !0, transition_debug: !1, camera_fov: 66, path_in: [{ x: 0, y: 0, z: -34 }, { x: 0, y: 0, z: 142 }], path_in_lookat: { x: 0, y: 0, z: 0 }, path_out: [{ x: 0, y: 0, z: 142 }, { x: 0, y: -16, z: 47 }, { x: 0, y: -16, z: -53 }], path_out_lookat: [{ x: 0, y: 0, z: -70 }, { x: 0, y: -37, z: -70 }], camera_in_duration: 22.5, camera_out_duration: 4, camera_rotation_in: 21, fog_in_duration: 5, fog_out_duration: 7, fog_in_start: .1, fog_in_end: .001, fog_out_start: .001, fog_out_end: .01, audio_pos_z_in: 1, audio_pos_z_out: 1, fov_in_duration: 21, color_left: "#FFFFFF", color_right: "#0bfdfd", color_directional: "#FFFFFF", speed: .008, line_thickness: 2 } }, function (t, e, i) { var n, o, s, r, a; for (a = i(10), o = [{ id: "pos-x", url: "/img/hires/pos-x.jpg", type: "image" }, { id: "neg-x", url: "/img/hires/neg-x.jpg", type: "image" }, { id: "pos-y", url: "/img/hires/pos-y.jpg", type: "image" }, { id: "neg-y", url: "/img/hires/neg-y.jpg", type: "image" }, { id: "pos-z", url: "/img/hires/pos-z.jpg", type: "image" }, { id: "neg-z", url: "/img/hires/neg-z.jpg", type: "image" }, { id: "hires_logo", url: "/js/hires/hires_logo.js", type: "geometry" }], s = 0, r = o.length; r > s; s++)n = o[s], n.url = a.base_path + n.url; t.exports = o }, function (t, e, i) { var n, o, s = function (t, e) { return function () { return t.apply(e, arguments) } }; o = i(8), t.exports = n = function () { function t(t) { this.app = t, this.start = s(this.start, this), this.play = s(this.play, this), this.stop = s(this.stop, this), o(this), window.sound = this, c.log("x"), this.cc = window.cc = new CoffeeCollider, setTimeout(this.start, 750) } return t.prototype.playing = !0, t.prototype.rec = null, t.prototype.tape = function () { }, t.prototype.stop = function () { return cc.reset(), this.playing = !1 }, t.prototype.play = function () { return console.warn("asd") }, t.prototype.start = function () { return this.emit("started"), this.cc.on("sin", function () { return console.dir(arguments[0]) }) }, t.prototype.background_atmos = function (t) { return cc.run("(->\n\n	noise = PinkNoise.ar(0.2)\n\n	noise = Mix Array.fill 10, (i)->\n		Resonz.ar(noise, i * 55 + 220, 0.05)\n\n	noise = (noise * 0.2 + noise * Decay.kr(Dust.kr(0.5), 10))\n\n	noise = RHPF.ar( noise, LFNoise0.kr(0.5).range(220, 55), rq:0.001)\n\n	CombL.ar(noise, delaytime:1, decaytime:25).dup() * Line.kr( 0, 0.4, dur: " + t + ")\n\n).play()", !0) }, t.prototype.clickable_distortion = function () { return cc.run("(->\n	freq = MouseY.kr(55 / 2, 55, 'exponential')\n	freq1 = freq * MouseX.kr(2, 0.5, lag:2.5)\n	freq2 = freq * MouseX.kr(0.5, 2, lag:2.5)\n	feedback = MouseButton.kr(0, 0.5.pi(), lag:5)\n	SinOscFB.ar([freq1, freq2], feedback, mul:0.25)\n).play()", !0) }, t.prototype.bass_sequence = function () { return cc.run("\nsynth = SynthDef (freq)->\n\n	s = SinOscFB.ar( freq ) * Line.kr(1, 0, dur:0.5, doneAction:2)\n	s = s.dup()\n	Out.ar(0, s) * 0.5\n\n.add()\n\np = Pseq( [ 55,0,0,0 ], Infinity )\n\nTask ->\n	0.wait()\n	p.do syncblock (freq)->\n		# freq = (60 - 24 + i).midicps()\n\n		Synth(synth, freq:freq)\n\n		[0.5].choose().wait()\n.start()\n\np = Pseq( [ 55,0,0,0,55*1.25 ], Infinity )\n\nTask ->\n	0.2.wait()\n	p.do syncblock (freq)->\n		# freq = (60 - 24 + i).midicps()\n\n		Synth(synth, freq:freq)\n\n		[0.5].choose().wait()\n.start()\n", !0) }, t.prototype.percolation = function (t, e, i) { return null == t && (t = 60), null == e && (e = 7), null == i && (i = 40), cc.run("d = " + t + " # number of percolators\nc = " + e + " # number of comb delays\na = " + i + " # number of allpass delays\n(->\n	# sine percolation sound :\n	s = Mix.ar Array.fill d, ->\n		Resonz.ar(Dust.ar(2 / d, 50), 200 + 30000.rand(), 0.003)\n\n	# reverb predelay time :\n	z = DelayN.ar(s, 0.000498)\n\n	# 7 length modulated comb delays in parallel :\n	y = Mix.ar CombL.ar(z, 0.1, LFNoise1.kr(Array.fill(c, (->1.rand())), 0.04, 0.05), 15)\n\n	# chain of 4 allpass delays on each of two channels (8 total) :\n	a.do ->\n		y = AllpassN.ar(y, 0.050, [0.050.rand(), 0.050.rand()], 1)\n\n	# add original sound to reverb and play it :\n	s + 0.2 * y\n).play()", !0) }, t.prototype.klank = function (t, e) { return cc.run("(->\n	n = 5  # number of simultaneous instruments\n	p = 15 # number of partials per instrument\n\n	# filter bank specification :\n	z = $([\n		Array.fill(p, (-> 80 + 10000.linrand() )) # frequencies\n		Array.fill(p, (-> 1.rand2() ))            # amplitudes\n		Array.fill(p, (-> 0.2 + 8.rand() ))       # ring times\n	])\n\n	p = Pan2.ar(Klank.ar(z, Dust.ar(0.07, 0.25)), SinOsc(1))\n\n	40.do ->\n		p = AllpassN.ar(p, 0.050, [0.050.rand(), 0.050.rand()], 1)\n\n	p\n).play()\n", !0) }, t.prototype.glass = function () { return cc.run("d = 60 # number of percolators\nc = 7 # number of comb delays\na = 40 # number of allpass delays\n\nd = 1 # number of percolators\nc = 1 # number of comb delays\na = 1 # number of allpass delays\n\n(->\n	# sine percolation sound :\n	s = Mix.ar Array.fill d, ->\n		Resonz.ar( Dust.ar(2 + d.rand(), 50), 200 + 30000.rand(), 0.003 )\n\n	# reverb predelay time :\n	z = DelayN.ar(s, 0.000498)\n\n	# 7 length modulated comb delays in parallel :\n	y = Mix.ar CombL.ar(z, 0.1, LFNoise1.kr(Array.fill(c, (->1.rand())), 0.04, 0.05), 15)\n\n	# chain of 4 allpass delays on each of two channels (8 total) :\n	a.do ->\n		y = AllpassN.ar(y, 0.050, [0.050.rand(), 0.050.rand()], 1)\n\n	# add original sound to reverb and play it :\n	s + 0.2 * y\n).play()", !0) }, t.prototype.listen_messages = function () { return cc.run('\nMessage.on "noise", (value)->\n	console.log "noise is" + value.data\n', !0) }, t.prototype.send_messages = function () { return cc.run("\nfreq = MouseY.kr( 10, 100, 'linear' )\n\np = Pseq( [ 10, 20, 30 ], 1 )\n\nTask ->\n	p.do syncblock ( value )->\n\n		# console.log freq\n\n		Message.send \"sin\", ( value * freq  ).exprange( 0, 1)\n\n		0.5.wait()\n.start()\n", !0) }, t }() }, function (t, e, i) {
        var n, o, s, r, a, u, h, l, c, d, p, _, f, m = function (t, e) { return function () { return t.apply(e, arguments) } }; c = i(8), p = i(10), u = i(16), l = i(7), s = i(26), f = i(34), o = i(35), d = i(62), _ = i(63), h = i(76), r = i(77), a = i(79), t.exports = n = function () {
            function t(t, e) { this.scene = t, this.gui = e, this.next = m(this.next, this), this.update = m(this.update, this), this.transition_out_forward = m(this.transition_out_forward, this), this.transition_out_backward = m(this.transition_out_backward, this), this.setup = m(this.setup, this), c(this) } return t.prototype.camera_path = null, t.prototype.attributes = null, t.prototype.ready = !1, t.prototype.tweens = Array, t.prototype.has_transitioned_out = !1, t.prototype.is_transitioning = !1, t.prototype.transition_progress = 0, t.prototype.fov_transition_progress = 0, t.prototype.dolly_transition_progress = 0, t.prototype.load = function () { var t, e, i; for (this.loader = new s, e = 0, i = a.length; i > e; e++)t = a[e], this.loader.add(t.id, t.url, t.type); return this.loader.once("loaded", this.setup), this.loader.load() }, t.prototype.setup = function () { var t, e, i, n, s, a, c, m, g, y, v, b, w, x, E, k, T, z, R, C, A, H, M, S, P, L, O; for (l.fov = h.camera_fov, this.ui = new r(this.scene, this.gui, { hires_logo: this.loader.get_asset("hires_logo") }), this.keyboard = new o($(window)), this.tweens = [], h.fog_enabled && (this.scene.fog = new THREE.FogExp2(0, h.fog_in_start), this.gui.add(this.scene.fog, "density", 0, .001)), p.debug && (this.scene.add(new THREE.GridHelper(50, 10)), this.scene.add(new THREE.AxisHelper(10)), this.scene.add(new THREE.CameraHelper(u.user))), s = 0, m = d.length; m > s; s++)g = d[s], this.scene.add(g); for (this.sounds = { start: this.loader.get_asset("start").data, loop: this.loader.get_asset("loop").data, transition: this.loader.get_asset("transition").data }, this.sounds.start.play(), f.delay(37, function (t) { return function () { return t.sounds.loop.volume(0), t.sounds.loop.fade(0, 1, 1e3), t.sounds.loop.play(), t.sounds.loop.loop(!0) } }(this)), this.container = new THREE.Object3D, this.scene.add(this.container), this.container.position.fromArray(h.container_position), this.container.rotation.fromArray(h.container_rotation), e = 1e4, h.add_controls && (this.gui.add(this.container.rotation, "x", 0, PI_2).name("rotation x"), this.gui.add(this.container.rotation, "y", 0, PI_2).name("rotation y"), this.gui.add(this.container.rotation, "z", 0, PI_2).name("rotation z"), this.gui.add(this.container.position, "x", -e, e).name("position x"), this.gui.add(this.container.position, "y", -e, e).name("position y"), this.gui.add(this.container.position, "z", -e, e).name("position z")), this.attributes = { size: { type: "f", value: [] }, alpha: { type: "f", value: [] } }, A = { color: { type: "c", value: new THREE.Color(16777215) }, texture: { type: "t", value: THREE.ImageUtils.loadTexture(this.loader.get_asset("particle").src) } }, h.fog_enabled && (A.topColor = { type: "c", value: new THREE.Color(30719) }, A.bottomColor = { type: "c", value: new THREE.Color(16777215) }, A.offset = { type: "f", value: 33 }, A.exponent = { type: "f", value: .6 }, A.fogColor = { type: "c", value: this.scene.fog.color }, A.fogNear = { type: "f", value: this.scene.fog.near }, A.fogFar = { type: "f", value: this.scene.fog.far }, A.fogDensity = { type: "f", value: this.scene.fog.density }), y = new THREE.ShaderMaterial({ uniforms: A, attributes: this.attributes, vertexShader: _.vertex(), fragmentShader: _.fragment(), blending: THREE.AdditiveBlending, transparent: !0, fog: h.fog_enabled }), i = new THREE.Geometry, k = 350 * h.scale, E = 2e3 * h.scale, P = 10, L = 400 * h.scale, C = 20, R = 40, n = a = 0, T = h.partices; T >= 0 ? T > a : a > T; n = T >= 0 ? ++a : --a)t = f.random(0, PI_2), x = f.random(k, E), M = x * Math.cos(t), S = L * Math.cos(x / E * Math.PI), O = x * Math.sin(t), i.vertices.push(new THREE.Vector3(M, S, O)), this.attributes.alpha.value[n] = f.random(.2, 1), this.attributes.size.value[n] = f.random(C, R); for (this.mesh = new THREE.PointCloud(i, y), this.container.add(this.mesh), this.container.rotation.y = .1, C = 40, R = 80, i = new THREE.Geometry, E = k, k = 150 * h.scale, L = 1e3 * h.scale, n = c = 0, z = h.tunnel_particles; z >= 0 ? z > c : c > z; n = z >= 0 ? ++c : --c)t = f.random(0, PI_2), x = f.random(k, E), w = Math.random(), M = x * Math.cos(t), S = 13422 + L * Math.cos(x / E * Math.PI), O = x * Math.sin(t), i.vertices.push(new THREE.Vector3(M, S, O)), b = f.random(.2, 1), w = S / L, w > .5 && (b += f.lerp(b, 0, .5 + w)), this.attributes.alpha.value[n] = b, this.attributes.size.value[n] = f.random(C, R); return this.tunnel_mesh = new THREE.PointCloud(i, y), this.container.add(this.tunnel_mesh), v = new THREE.Mesh(new THREE.SphereGeometry(100, 4, 4)), v.position.y = 15e3, v.visible = !1, this.container.add(v), this.container.updateMatrixWorld(), H = new THREE.Vector3, H.setFromMatrixPosition(v.matrixWorld), h.path_camera_dolly.push(H.toArray()), h.path_out.push(H.toArray()), this.camera_dolly = new THREE.Mesh(new THREE.SphereGeometry(100, 8, 8), new THREE.MeshBasicMaterial({ color: 16711680 })), this.camera_dolly.visible = !1, this.scene.add(this.camera_dolly), this.path_in = f.path(this.scene, h.path_in, 65280), this.path_out = f.path(this.scene, h.path_out, 16711680), this.path_camera_dolly = f.path(this.scene, h.path_camera_dolly, 65280, null, 5), this.ready = !0, this.emit("setup:complete"), this.bind() }, t.prototype.bind = function () { return this.keyboard.on("key:down:space", this.transition_out_forward), this.keyboard.on("key:up:space", this.transition_out_backward), this.keyboard.bind(), l.on("update", this.update) }, t.prototype.unbind = function () { return this.keyboard.off("key:down:space", this.transition_out_forward), this.keyboard.off("key:up:space", this.transition_out_backward), this.keyboard.unbind(), l.off("update", this.update) }, t.prototype.transition_in = function () { var t, e; return this.emit("transition:in:complete"), this.is_transitioning = !0, u.user.position.fromArray(h.path_in[0]), u.user.lookAt(new THREE.Vector3), this.ui.transition_in(), e = { progress: 0 }, t = { progress: 1, ease: Power2.easeOut, onUpdate: function (t) { return function () { var i; return t.ui.update(), i = t.path_in.getPointAt(e.progress), u.user.position.copy(i), u.user.lookAt(new THREE.Vector3) } }(this), onComplete: function (t) { return function () { return t.is_transitioning = !1 } }(this) }, this.tweens.push(TweenLite.to(e, h.camera_in_duration, t)), h.fog_enabled ? (this.scene.fog.density = h.fog_in_start, t = { density: h.fog_in_end, ease: Power2.easeOut }, this.tweens.push(TweenLite.to(this.scene.fog, h.fog_in_duration, t))) : void 0 }, t.prototype.transition_out_backward = function () { var t, e, i, n, o, s; if (0 !== this.transition_progress && !(this.transition_progress > .6)) return this.kill_tweens(), this.ui.transition_out_backward(), s = { progress: this.transition_progress, percent: 0 }, o = { progress: 0, percent: 1, ease: Power3.easeOut, onUpdate: function (t) { return function () { var e, i; return e = t.path_out.getPointAt(s.progress), u.user.position.copy(e), u.user.lookAt(t.camera_dolly.position), t.sounds.loop.volume(s.percent), i = f.lerp(1, 0, s.percent), t.sounds.transition.volume(i) } }(this), onComplete: function (t) { return function () { return t.is_transitioning = !1, t.sounds.transition.stop() } }(this) }, t = 2 + 2 * this.transition_progress, this.tweens.push(TweenLite.to(s, t, o)), this.dolly_transition_progress > 0 && (i = { progress: this.dolly_transition_progress }, o = { progress: 0, ease: Power2.easeOut, onUpdate: function (t) { return function () { var e; return e = t.path_camera_dolly.getPointAt(i.progress), t.camera_dolly.position.copy(e) } }(this) }, e = 2 + 2 * this.dolly_transition_progress, this.tweens.push(TweenLite.to(i, e, o))), this.fov_transition_progress > 0 ? (o = { fov: h.camera_fov, ease: Power3.easeOut }, n = 5 + 5 * this.fov_transition_progress, this.tweens.push(TweenLite.to(l, n, o))) : void 0 }, t.prototype.transition_out_forward = function () { var t, e, i, n; if (!this.is_transitioning) return this.is_transitioning = !0, this.sounds.transition.volume(1), this.sounds.transition.play(), this.kill_tweens(), this.ui.transition_out(), n = { progress: 0 }, i = { progress: 1, ease: Power2.easeIn, onUpdate: function (t) { return function () { var e; return t.transition_progress = n.progress, e = t.path_out.getPointAt(n.progress), u.user.position.copy(e), u.user.lookAt(t.camera_dolly.position), t.sounds.loop.volume(1 - n.progress) } }(this), onComplete: function (t) { return function () { return t.next() } }(this) }, this.tweens.push(TweenLite.to(n, h.camera_out_duration, i)), t = { progress: 0 }, i = { progress: 1, delay: 6, ease: Power2.easeIn, onUpdate: function (e) { return function () { var i; return e.dolly_transition_progress = t.progress, i = e.path_camera_dolly.getPointAt(t.progress), e.camera_dolly.position.copy(i) } }(this) }, this.tweens.push(TweenLite.to(t, 3.7, i)), i = { fov: h.camera_fov_out, delay: 5, ease: Power3.easeOut, onUpdate: function (t) { return function () { return t.fov_transition_progress = e.progress() } }(this) }, e = TweenLite.to(l, h.camera_fov_out_duration, i), this.tweens.push(e) }, t.prototype.update = function () { var t; if (this.ready) return t = .001, this.mesh.rotation.y += t, this.tunnel_mesh.rotation.y += t }, t.prototype.next = function () { return this.has_transitioned_out = !0, this.emit("next") }, t.prototype.kill_tweens = function () {
                var t, e, i, n, o;
                for (i = this.tweens, n = [], t = 0, e = i.length; e > t; t++)o = i[t], n.push(null != o ? o.kill() : void 0); return n
            }, t.prototype.enable_transition = function () { }, t.prototype.disable_transition = function () { }, t.prototype.destroy = function () { var t, e, i; e = this.sounds; for (t in e) i = e[t], i.fade(1, 0, 1e3); return f.delay(1, function (e) { return function () { var n, o, s, r, a; r = e.sounds; for (t in r) i = r[t], i.unload(); for (a = e.scene.children, n = 0, o = a.length; o > n; n++)s = a[n], e.scene.remove(s); return e.kill_tweens(), e.unbind(), e.ui.destroy(), e.loader.dispose(), e.emit("destroyed") } }(this)) }, t
        }()
    }, function (t, e) { t.exports = { add_controls: !1, transition_debug: !1, fog_enabled: !0, camera_fov: 80, camera_fov_out: 120, camera_fov_out_duration: 10, path_in: [[14660.800000000001, -16761.800000000003, 12783.1], [13328, -15238, 11621]], path_out: [[13328, -15238, 11621], [11100, -12545, 9690], [7735, -9383, 7878], [4207, -4813, 5272], [1501, -1205, 3305], [0, 0, 0]], path_camera_dolly: [[0, 0, 0]], camera_in_duration: 2, camera_out_duration: 10, fog_in_duration: 10, hires_in_duration: 2, hires_out_duration: 1, fog_in_start: 7e-4, fog_in_end: 7e-5, scale: 10, partices: 4e5, tunnel_particles: 3e4, container_position: [1500, 1050, 4400], container_rotation: [4.4, .01, .28], title_position: [11100, -12e3, 9690], title_letter_in_position: [[-1173, -25, 0], [-291, -25, 0], [480, -28, 0], [1068, -28, 0]], title_letter_in_rotation: [[0, 0, -.08], [0, 0, .21], [0, -.36, 0], [-.08, 0, 0]], ui_hires_scale: 20, ui_hires_position: [0, 2170, 0], paragraph_positions: [[0, -700, 0], [0, -1435, 0]], enter_position: [0, -2355, 0], enter_letter_in_position: [{ x: -20, y: 6, z: 0 }, { x: -8, y: 3, z: 0 }, { x: 0, y: 0, z: 0 }, { x: 7, y: -1, z: 0 }, { x: 19, y: -3, z: 0 }], enter_letter_in_rotation: [{ x: 0, y: 7, z: 11 }, { x: 0, y: 6, z: 0 }, { x: 0, y: 0, z: 0 }, { x: 0, y: -3, z: 0 }, { x: -10, y: 0, z: -5 }] } }, function (t, e, i) { var n, o, s, r, a, u, h, l; u = i(8), r = i(16), l = i(34), n = i(66), a = i(76), h = i(39), o = i(41), t.exports = s = function () { function t(t, e, i) { this.scene = t, this.gui = e, this.assets = i, this.ui = { dim: ".dim", hitarea: ".hitarea", hires: "h1", preface: "h2", paragraphs: ".paragraphs p", next: ".next" }, u(this), this.tweens = [], this.render() } return t.prototype.render = function () { var t, e, o, s, r, u, l, c, d, p, _; t = h.get("home"), p = i(78), $("main").append(p({ data: t })), this.el = $("#" + t.id), c = this.ui; for (r in c) o = c[r], this.ui[r] = this.el.find(o); for (this.ui.letters = this.ui.paragraphs.lettering().children(), this.ui.next_letters = this.ui.next.lettering().children(), this.ui.dim.remove(), this.container = new THREE.Object3D, this.scene.add(this.container), this.container.position.fromArray(a.title_position), _ = new n, this.title_meshes = _.create_multichar({ text: "VOID", size: 490, curve_segments: 10 }), d = this.title_meshes, e = s = 0, u = d.length; u > s; e = ++s)l = d[e], this.container.add(l); return this.paragraph_meshes = [] }, t.prototype.update = function () { return this.container.lookAt(r.user.position) }, t.prototype.transition_in = function () { var t, e, i, n, s, r, u, h, c, d, p, _, f; for (r = { autoAlpha: 1, ease: Power2.easeIn, delay: 2 }, TweenLite.to(this.ui.hires, 4, r), r = { autoAlpha: 1, ease: Power4.easeIn, delay: .5 }, TweenLite.to(this.ui.preface, 1.2, r), f = new TimelineLite, p = this.title_meshes, e = i = 0, n = p.length; n > i; e = ++i)s = p[e], d = a.title_letter_in_position[e], u = { x: d[0], y: d[1], z: d[2], ease: Power3.easeOut }, _ = a.title_letter_in_rotation[e], h = { x: _[0], y: _[1], z: _[2], ease: Power3.easeOut }, c = { opacity: 1, delay: l.random(0, 1), ease: Power2.easeOut }, f.to(s.position, 20, u, 1.8), f.to(s.rotation, 20, h, 1.8), f.to(s.material, 5, c, 2.3); return f.play(), t = new o, t.animate(this.ui.letters, 4e3), r = { autoAlpha: 1, ease: Power2.easeIn, delay: 3, onComplete: function (e) { return function () { return t = new o, t.exclude = [11, 12, 13, 14, 15, 16, 17, 18, 19, 20], t.animate(e.ui.next_letters, 0) } }(this) }, TweenLite.to(this.ui.next, 1.6, r) }, t.prototype.transition_out = function () { var t, e, i, n, o, s, r, a, u, h, c, d, p, _, f; for (this.kill_tweens(), TweenLite.killTweensOf(this.el), n = { autoAlpha: 0, ease: Power2.easeOut }, this.tweens.push(TweenLite.to(this.el, 1.6, n)), d = new TimelineLite, a = this.title_meshes, t = 0, e = a.length; e > t; t++)i = a[t], r = 200, p = i.position.x + l.random(-r, r), _ = i.position.y + l.random(-r, r), f = i.position.z + l.random(2 * -r, 2 * r), r = Math.PI / 2, u = l.random(-r, r), h = l.random(-r, r), c = l.random(-r, r), o = { delay: 4, x: p, y: _, z: f, ease: Power1.easeInOut }, s = { delay: 4, x: u, y: h, z: c, ease: Power1.easeInOut }, d.to(i.position, 20, o, 0), d.to(i.rotation, 20, s, 0); return d.play(), this.tweens.push(d) }, t.prototype.transition_out_backward = function () { var t, e, i, n, o, s, r, u, h, l, c; for (this.kill_tweens(), o = { autoAlpha: 1, ease: Power2.easeOut, delay: 2 }, this.tweens.push(TweenLite.to(this.el, 1.6, o)), c = new TimelineLite, h = this.title_meshes, t = e = 0, i = h.length; i > e; t = ++e)n = h[t], u = a.title_letter_in_position[t], s = { x: u[0], y: u[1], z: u[2], ease: Power3.easeOut }, l = a.title_letter_in_rotation[t], r = { x: l[0], y: l[1], z: l[2], ease: Power3.easeOut }, c.to(n.position, 20, s, 1.8), c.to(n.rotation, 20, r, 1.8); return c.play(), this.tweens.push(c) }, t.prototype.kill_tweens = function () { var t, e, i, n, o; for (i = this.tweens, n = [], t = 0, e = i.length; e > t; t++)o = i[t], n.push(null != o ? o.kill() : void 0); return n }, t.prototype.destroy = function () { return this.el.remove() }, t }() }, function (t, e, i) { var n = i(43); t.exports = function (t) { var e, i = [], o = t || {}; return function (o) { i.push("<div" + n.attr("id", "" + t.data.id, !0, !1) + ' class="section scene layer layer_0"><div class="transition_black layer layer-0"></div><div class="ui"><div class="dim layer layer-0"></div><div class="content"><div class="hitarea layer layer-0"></div><h1 class="hi_res layer layer-1"><a href="http://hi-res.net" title="Hi-ReS!" target="_blank"></a></h1><h2 class="layer layer-1 font-garamond bold">PREFACE</h2><div class="paragraphs layer">'), function () { var n = t.data.paragraphs; if ("number" == typeof n.length) for (var o = 0, s = n.length; s > o; o++) { var r = n[o]; i.push("<p>" + (null == (e = r) ? "" : e) + "</p>") } else { var s = 0; for (var o in n) { s++; var r = n[o]; i.push("<p>" + (null == (e = r) ? "" : e) + "</p>") } } }.call(this), i.push('</div><a class="next layer layer_2 caps-text">HOLD THE SPACE BAR TO CONTINUE</a></div></div></div>') }.call(this, "undefined" in o ? o.undefined : void 0), i.join("") } }, function (t, e, i) { var n, o, s, r, a; for (a = i(10), o = [{ id: "particle", url: "/img/home/particle.jpg", type: "image" }, { id: "hires_logo", url: "/img/home/hires.png", type: "image" }, { id: "start", url: "/sound/home/start.mp3", type: "sound" }, { id: "loop", url: "/sound/home/loop.mp3", type: "sound" }, { id: "transition", url: "/sound/home/transition.mp3", type: "sound" }], s = 0, r = o.length; r > s; s++)n = o[s], n.url = a.base_path + n.url; t.exports = o }, function (t, e, i) { var n, o, s, r, a, u, h, l, c, d, p, _, f, m, g, y = function (t, e) { return function () { return t.apply(e, arguments) } }, v = function (t, e) { function i() { this.constructor = t } for (var n in e) b.call(e, n) && (t[n] = e[n]); return i.prototype = e.prototype, t.prototype = new i, t.__super__ = e.prototype, t }, b = {}.hasOwnProperty; _ = i(8), m = i(10), c = i(16), p = i(7), s = i(26), r = i(33), g = i(34), n = i(36), f = i(81), d = i(82), h = i(37), l = i(83), u = i(47), a = i(48), t.exports = o = function (t) { function e() { return this.update = y(this.update, this), this.on_mouse_move = y(this.on_mouse_move, this), this.on_mouse_up = y(this.on_mouse_up, this), this.on_mouse_down = y(this.on_mouse_down, this), this.setup = y(this.setup, this), e.__super__.constructor.apply(this, arguments) } return v(e, t), e.prototype.spread = 0, e.prototype.accel_x = .1, e.prototype.accel_y = .1, e.prototype.accel_z = .1, e.prototype.dopplerFactor = 1, e.prototype.speedOfSound = 343.3, e.prototype.setup = function (t) { var e, i, n, o, s, l, _, y, v, b, w, x, E, k, T; for (w = 10, this.gui.add(this, "audio_pos_x", -w, w), this.gui.add(this, "audio_pos_y", -w, w), this.gui.add(this, "audio_pos_z", -w, w), w = 1e3, this.gui.add(this, "accel_x", -w, w), this.gui.add(this, "accel_y", -w, w), this.gui.add(this, "accel_z", -w, w), this.gui.add(c.user.position, "z", -100, 1e3), p.fov = d.camera_fov, this.ui = new h("kubik", this.scene, this.gui), d.fog_enabled && (this.scene.fog = new THREE.FogExp2(0, d.fog_in_start), this.gui.add(this.scene.fog, "density", 0, 1)), this.gui.add(p, "fov", 0, 200), m.debug && (this.scene.add(new THREE.GridHelper(50, 10)), this.scene.add(new THREE.AxisHelper(10)), this.scene.add(new THREE.CameraHelper(c.user))), s = 0, _ = f.length; _ > s; s++)y = f[s], this.scene.add(y); this.path_in = new u("path_in", this.scene, d.path_in, d.path_in_lookat, 65280), this.path_out = new a("path_out", this.scene, d.path_out, d.path_out_lookat, 65280), this.mouse = new r($(".hitarea")), this.audio_pos_x = .1, this.audio_pos_z = this.config.audio_pos_z_in, this.sounds = { background: g.get_asset("background", t).data, top: g.get_asset("top", t).data }, this.sounds.background.play(), this.sounds.top.volume(0), this.sounds.top.play(), E = this.sounds; for (l in E) T = E[l], T.loop(!0); for (this.container = new THREE.Object3D, this.scene.add(this.container), b = { side: THREE.DoubleSide, blending: 2, transparent: !0, depthTest: !1, wireframeLinewidth: 1, opacity: .1, map: THREE.ImageUtils.loadTexture(this.loader.get_asset("texture").src) }, this.material = new THREE.MeshLambertMaterial(b), i = new THREE.BoxGeometry(1, 1, 1), o = 0, this.cubes = [], v = 160, this.object = new THREE.Object3D; v > o;)x = o / v, e = new THREE.Mesh(i, this.material), n = new THREE.Object3D, n.add(e), n.rotation.y = 360 * x * (Math.PI / 180), this.object.add(n), this.cubes.push(e), o++; return k = 40, this.object.scale.set(k, k, k), this.object.rotation.x = HALF_PI, this.container.add(this.object), this.spread = .1, this.ready = !0, this.bind(), this.emit("setup:complete") }, e.prototype.spread_cubes = function () { var t, e, i, n, o; i = 0, n = this.cubes, o = []; for (e in n) t = n[e], i = e / this.cubes.length, o.push(t.rotation.y = i * Math.PI * this.spread); return o }, e.prototype.bind = function () { return e.__super__.bind.call(this), this.mouse.on("move", this.on_mouse_move), this.mouse.on("down", this.on_mouse_down), this.mouse.on("up", this.on_mouse_up), this.ui.bind(), this.mouse.bind() }, e.prototype.unbind = function () { return e.__super__.unbind.call(this), this.mouse.off("move", this.on_mouse_move), this.mouse.off("down", this.on_mouse_down), this.mouse.off("up", this.on_mouse_up), this.ui.unbind(), this.mouse.unbind() }, e.prototype.force_transition_in_complete = function () { return e.__super__.force_transition_in_complete.call(this), this.camera_tween.totalProgress(1).kill() }, e.prototype.on_mouse_down = function () { var t, e, i; if (!this.is_transitioning_out) return this.force_transition_in_complete(), null != (e = this.fov_tween) && e.kill(), null != (i = this.pos_tween) && i.kill(), t = { fov: 200, ease: Cubic.easeOut }, this.fov_tween = TweenLite.to(p, .6, t), t = { z: 33 }, this.pos_tween = TweenLite.to(c.user.position, .3, t), this.sounds.background.fade(1, .5, 600), this.sounds.top.fade(0, 1, 600) }, e.prototype.on_mouse_up = function () { var t, e, i; if (!this.is_transitioning_out) return null != (e = this.fov_tween) && e.kill(), null != (i = this.pos_tween) && i.kill(), t = { fov: this.config.camera_fov, ease: Cubic.easeOut }, this.fov_tween = TweenLite.to(p, .55, t), t = { z: this.config.path_in[1].z }, this.pos_tween = TweenLite.to(c.user.position, .3, t), this.sounds.background.fade(.5, 1, 600), this.sounds.top.fade(1, 0, 600) }, e.prototype.on_mouse_move = function () { var t, e, i, n, o, s, r, a, u, h; return e = 0, i = 0, n = this.mouse.normal_center_x, o = this.mouse.normal_center_y, t = this.mouse.is_down ? .25 : 1, null != (r = this.rotation_tween) && r.kill(), h = HALF_PI + this.mouse.normal_center_y, s = { x: h }, this.rotation_tween = TweenLite.to(this.object.rotation, t, s), null != (a = this.tween) && a.kill(), u = this.mouse.normal_x.map(0, 1, 0, PI_2), s = { spread: u, ease: Power3.easeOut, onUpdate: function (t) { return function () { return t.spread_cubes() } }(this) }, this.tween = TweenLite.to(this, 1, s) }, e.prototype.update = function () { var t, e, i, n, o; if (this.ready) { this.audio_pos_x = 4 * this.mouse.normal_center_x, this.sounds.background.pos(this.audio_pos_x, null, this.audio_pos_z), n = this.cubes, o = []; for (e in n) t = n[e], i = e / this.cubes.length, o.push(t.rotation.x += .5 * Math.PI / 180); return o } }, e }(n) }, function (t, e) { var i; i = new THREE.AmbientLight(11645361), t.exports = [i] }, function (t, e) { t.exports = { fog_enabled: !0, transition_debug: !1, camera_fov: 80, path_in: [{ x: 0, y: 0, z: 300 }, { x: 0, y: 0, z: 80 }], path_in_lookat: { x: 0, y: 0, z: 0 }, path_out: [{ x: 0, y: 0, z: 80 }, { x: 0, y: -50, z: 200 }], path_out_lookat: [{ x: 0, y: 0, z: 0 }, { x: 0, y: -50, z: 0 }], camera_in_duration: 5, camera_out_duration: 4, fog_in_duration: 12, fog_out_duration: 6, fog_in_start: .1, fog_in_end: .001, fog_out_start: .001, fog_out_end: .01, audio_pos_z_in: -15, audio_pos_z_out: 6, num_blobs: 30, max_blobs: 50, speed: .15, scalar: 1 } }, function (t, e, i) { var n, o, s, r, a; for (a = i(10), o = [{ id: "texture", url: "/img/kubik/texture.png", type: "image" }, { id: "background", url: "/sound/kubik/background.mp3", type: "sound" }, { id: "top", url: "/sound/kubik/top.mp3", type: "sound" }], s = 0, r = o.length; r > s; s++)n = o[s], n.url = a.base_path + n.url; t.exports = o }, function (t, e, i) { var n, o, s, r, a, u, h, l, c, d, p, _, f, m, g, y = function (t, e) { return function () { return t.apply(e, arguments) } }, v = function (t, e) { function i() { this.constructor = t } for (var n in e) b.call(e, n) && (t[n] = e[n]); return i.prototype = e.prototype, t.prototype = new i, t.__super__ = e.prototype, t }, b = {}.hasOwnProperty; _ = i(8), m = i(10), c = i(16), p = i(7), s = i(26), r = i(33), g = i(34), n = i(36), f = i(85), d = i(86), h = i(37), l = i(87), u = i(47), a = i(48), t.exports = o = function (t) { function e() { return this.on_mouse_up = y(this.on_mouse_up, this), this.on_mouse_down = y(this.on_mouse_down, this), this.update = y(this.update, this), this.on_transition_out_forward = y(this.on_transition_out_forward, this), this.on_transition_out_backward = y(this.on_transition_out_backward, this), this.setup = y(this.setup, this), e.__super__.constructor.apply(this, arguments) } return v(e, t), e.prototype.values = null, e.prototype.points = null, e.prototype.positions = [], e.prototype.material = null, e.prototype.tween = null, e.prototype.audio_pos_x = .1, e.prototype.audio_pos_y = .1, e.prototype.audio_pos_z = 0, e.prototype.setup = function (t) { var e, i, n, o, s, l, _, y, v, b, w, x, E, k, T, z, R, C, A, H, M, S, P, L, O, I, F, j; for (T = 1, this.gui.add(this, "audio_pos_x", -T, T), this.gui.add(this, "audio_pos_y", -T, T), this.gui.add(this, "audio_pos_z", -T, T), p.fov = d.camera_fov, this.ui = new h("liquidice", this.scene, this.gui), d.fog_enabled && (this.scene.fog = new THREE.FogExp2(0, d.fog_in_start), this.gui.add(this.scene.fog, "density", 0, 1)), m.debug && (this.scene.add(new THREE.GridHelper(50, 10)), this.scene.add(new THREE.AxisHelper(10)), this.scene.add(new THREE.CameraHelper(c.user))), b = 0, w = f.length; w > b; b++)E = f[b], this.scene.add(E); this.path_in = new u("path_in", this.scene, d.path_in, d.path_in_lookat, 65280), this.path_out = new a("path_out", this.scene, d.path_out, d.path_out_lookat, 65280), this.mouse = new r($("body")), this.audio_pos_z = this.config.audio_pos_z_in, this.sounds = { background: g.get_asset("background", t).data, top: g.get_asset("top", t).data }, this.sounds.background.volume(2), this.sounds.background.play(), this.sounds.top.volume(0), this.sounds.top.play(), z = this.sounds; for (v in z) S = z[v], S.loop(!0); for (this.container = new THREE.Object3D, this.scene.add(this.container), n = -6, i = 6, o = i - n, A = 16, H = A * A, M = A * A * A, this.points = [], y = 0; A > y;) { for (_ = 0; A > _;) { for (l = 0; A > l;)I = n + o * l / (A - 1), F = n + o * _ / (A - 1), j = n + o * y / (A - 1), this.points.push(new THREE.Vector3(I, F, j)), l++; _++ } y++ } for (this.values = [], l = 0; M > l;)this.values[l] = 0, l++; for (O = [], k = 0, x = t.length; x > k; k++)e = t[k], "pos-x" !== (R = e.id) && "neg-x" !== R && "pos-y" !== R && "neg-y" !== R && "pos-z" !== R && "neg-z" !== R || O.push(e.src); for (P = THREE.ImageUtils.loadTextureCube(O), P.format = THREE.RGBFormat, s = THREE.FresnelShader, L = { mRefractionRatio: { type: "f", value: 1.02 }, mFresnelBias: { type: "f", value: .1 }, mFresnelPower: { type: "f", value: 2 }, mFresnelScale: { type: "f", value: 1 }, tCube: { type: "t", value: P } }, d.fog_enabled && (L.topColor = { type: "c", value: new THREE.Color(30719) }, L.bottomColor = { type: "c", value: new THREE.Color(16777215) }, L.offset = { type: "f", value: 33 }, L.exponent = { type: "f", value: .6 }, L.fogColor = { type: "c", value: 0 }, L.fogNear = { type: "f", value: 0 }, L.fogFar = { type: "f", value: 1 }, L.fogDensity = { type: "f", value: .01 }), this.material = new THREE.ShaderMaterial({ uniforms: L, vertexShader: s.vertexShader, fragmentShader: s.fragmentShader, fog: !0, side: THREE.DoubleSide }), l = 0; l < d.max_blobs;)C = this.random_sphere_point(0, 0, 0, 4), I = C[0], F = C[1], j = C[2], this.positions.push(new THREE.Vector3(I, F, j)), l++; return this.clock = new THREE.Clock, this.gui.add(d, "num_blobs", 1, d.max_blobs).name("blobs"), this.gui.add(d, "speed", 0, 1).name, this.ready = !0, this.bind(), this.emit("setup:complete") }, e.prototype.bind = function () { return e.__super__.bind.call(this), this.mouse.on("down", this.on_mouse_down), this.mouse.on("up", this.on_mouse_up), this.on("transition:out:backward", this.on_transition_out_backward), this.on("transition:out:forward", this.on_transition_out_forward), this.ui.bind(), this.mouse.bind() }, e.prototype.unbind = function () { return e.__super__.unbind.call(this), this.mouse.off("down", this.on_mouse_down), this.mouse.off("up", this.on_mouse_up), this.off("transition:out:backward", this.on_transition_out_backward), this.off("transition:out:forward", this.on_transition_out_forward), this.ui.unbind(), this.mouse.unbind() }, e.prototype.force_transition_in_complete = function () { return e.__super__.force_transition_in_complete.call(this), this.camera_tween.totalProgress(1).kill(), this.fog_tween.totalProgress(1).kill() }, e.prototype.transition_in = function () { var t; return e.__super__.transition_in.call(this), t = { audio_pos_z: 0, ease: Power1.easeOut }, TweenLite.to(this, this.config.camera_in_duration, t) }, e.prototype.on_transition_out_backward = function (t) { return t = Math.max(t, 0), t = Math.min(t, 1), this.audio_pos_z = g.lerp(0, this.config.audio_pos_z_out, t) }, e.prototype.on_transition_out_forward = function (t) { return this.audio_pos_z = g.lerp(0, this.config.audio_pos_z_out, t) }, e.prototype.update = function () { var t; if (this.ready) return this.audio_pos_x = this.mouse.normal_x, this.audio_pos_y = this.mouse.normal_y, this.sounds.background.pos(this.audio_pos_x, this.audio_pos_y, this.audio_pos_z), this.sounds.top.pos(this.audio_pos_x, this.audio_pos_y, this.audio_pos_z), t = this.clock.getElapsedTime(), this.ballUpdate(d.speed * t) }, e.prototype.ballUpdate = function (t) { var e, i, n, o, s; for (this.resetValues(this.values), i = 0; i < d.num_blobs;)n = this.positions[i].x * Math.cos(1.5 * t) * d.scalar, o = this.positions[i].y * Math.cos(2.5 * t) * d.scalar, s = this.positions[i].z * Math.sin(5.7 * t) * d.scalar, this.addBall(this.points, this.values, new THREE.Vector3(n, o, s)), i++; return this.container.remove(this.mesh), e = this.marchingCubes(this.points, this.values, .5), this.mesh = new THREE.Mesh(e, this.material), this.container.add(this.mesh), this.container.rotation.x += .3 * (.05 * this.mouse.normal_center_x), this.container.rotation.y += .3 * (.05 * this.mouse.normal_center_x), this.container.rotation.z += .3 * (.05 * this.mouse.normal_center_y) }, e.prototype.resetValues = function (t) { var e, i; for (this.values = t, e = 0, i = []; e < this.values.length;)this.values[e] = 0, i.push(e++); return i }, e.prototype.addBall = function (t, e, i) { var n, o, s; for (this.points = t, this.values = e, o = 0, s = []; o < this.values.length;)n = 1 - i.distanceToSquared(this.points[o]), this.values[o] += Math.exp(-(n * n)), s.push(o++); return s }, e.prototype.marchingCubes = function (t, e, i) { var n, o, s, r, a, u, h, l, c, d, p, _, f, m, g, y, v, b, w, x, E, k, T, z, R, C, A, H, M, S, P, L, O; for (this.points = t, this.values = e, b = Math.round(Math.pow(this.values.length, 1 / 3)), w = b * b, x = b * b * b, S = new Array(12), r = new THREE.Geometry, M = 0, O = 0; b - 1 > O;) { for (L = 0; b - 1 > L;) { for (P = 0; b - 1 > P;) { for (d = P + b * L + w * O, p = d + 1, g = d + b, _ = g + 1, v = d + w, m = p + w, y = g + w, f = _ + w, E = this.values[d], k = this.values[p], T = this.values[g], z = this.values[_], R = this.values[v], C = this.values[m], A = this.values[y], H = this.values[f], o = 0, i > E && (o |= 1), i > k && (o |= 2), i > T && (o |= 8), i > z && (o |= 4), i > R && (o |= 16), i > C && (o |= 32), i > A && (o |= 128), i > H && (o |= 64), n = THREE.edgeTable[o], c = .5, 1 & n && (c = (i - E) / (k - E), S[0] = this.points[d].clone().lerp(this.points[p], c)), 2 & n && (c = (i - k) / (z - k), S[1] = this.points[p].clone().lerp(this.points[_], c)), 4 & n && (c = (i - T) / (z - T), S[2] = this.points[g].clone().lerp(this.points[_], c)), 8 & n && (c = (i - E) / (T - E), S[3] = this.points[d].clone().lerp(this.points[g], c)), 16 & n && (c = (i - R) / (C - R), S[4] = this.points[v].clone().lerp(this.points[m], c)), 32 & n && (c = (i - C) / (H - C), S[5] = this.points[m].clone().lerp(this.points[f], c)), 64 & n && (c = (i - A) / (H - A), S[6] = this.points[y].clone().lerp(this.points[f], c)), 128 & n && (c = (i - R) / (A - R), S[7] = this.points[v].clone().lerp(this.points[y], c)), 256 & n && (c = (i - E) / (R - E), S[8] = this.points[d].clone().lerp(this.points[v], c)), 512 & n && (c = (i - k) / (C - k), S[9] = this.points[p].clone().lerp(this.points[m], c)), 1024 & n && (c = (i - z) / (H - z), S[10] = this.points[_].clone().lerp(this.points[f], c)), 2048 & n && (c = (i - T) / (A - T), S[11] = this.points[g].clone().lerp(this.points[y], c)), a = 0, o <<= 4; -1 !== THREE.triTable[o + a];)u = THREE.triTable[o + a], h = THREE.triTable[o + a + 1], l = THREE.triTable[o + a + 2], r.vertices.push(S[u].clone().multiplyScalar(10)), r.vertices.push(S[h].clone().multiplyScalar(10)), r.vertices.push(S[l].clone().multiplyScalar(10)), s = new THREE.Face3(M, M + 1, M + 2), r.faces.push(s), r.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(0, 1), new THREE.Vector2(1, 1)]), M += 3, a += 3; P++ } L++ } O++ } return r.mergeVertices(), r.computeFaceNormals(), r.computeVertexNormals(), r }, e.prototype.random_sphere_point = function (t, e, i, n) { var o, s, r, a, u, h, l; return null == t && (t = 0), null == e && (e = 0), null == i && (i = 0), null == n && (n = 1), r = Math.random(), a = Math.random(), s = 2 * Math.PI * r, o = Math.acos(2 * a - 1), u = t + n * Math.sin(o) * Math.cos(s), h = e + n * Math.sin(o) * Math.sin(s), l = i + n * Math.cos(o), [u, h, l] }, e.prototype.on_mouse_down = function () { var t, e, i; if (!this.is_transitioning_out) return this.force_transition_in_complete(), null != (e = this.tween) && e.kill(), null != (i = this.pos_tween) && i.kill(), t = { scalar: 2, ease: Power1.easeIn }, this.tween = TweenLite.to(d, 1, t), t = { z: 0 }, this.pos_tween = TweenLite.to(c.user.position, 1, t), this.sounds.background.fade(1, .5, 600), this.sounds.top.fade(0, 2, 600) }, e.prototype.on_mouse_up = function () { var t, e, i; if (!this.is_transitioning_out) return null != (e = this.tween) && e.kill(), null != (i = this.pos_tween) && i.kill(), t = { scalar: 1, ease: Elastic.easeOut }, this.tween = TweenLite.to(d, 2, t), t = { z: this.config.path_in[1].z }, this.pos_tween = TweenLite.to(c.user.position, .3, t), this.sounds.background.fade(.5, 2, 600), this.sounds.top.fade(2, 0, 600) }, e }(n) }, function (t, e) { var i, n, o, s; i = new THREE.PointLight(16711680), i.position.set(10, 0, 0), n = new THREE.PointLight(52224), n.position.set(0, 10, 0), o = new THREE.PointLight(255), o.position.set(0, 0, 10), s = new THREE.PointLight(3355443), s.position.set(-10, -10, -10), e.lights = [i, n, o, s] }, function (t, e) { t.exports = { fog_enabled: !0, transition_debug: !1, camera_fov: 80, path_in: [{ x: 0, y: 0, z: 300 }, { x: 0, y: 0, z: 80 }], path_in_lookat: { x: 0, y: 0, z: 0 }, path_out: [{ x: 0, y: .5714285714285836, z: 80.57142857142856 }, { x: 0, y: -17.714285714285722, z: 53.14285714285714 }, { x: -20, y: -90.85714285714286, z: -38.28571428571429 }], path_out_lookat: [{ x: 0, y: 0, z: 0 }, { x: 0, y: -100, z: 0 }], camera_in_duration: 15, camera_out_duration: 2.8, fog_in_duration: 15, fog_out_duration: 3, fog_in_start: .1, fog_in_end: .001, fog_out_start: .001, fog_out_end: .01, audio_pos_z_in: -8, audio_pos_z_out: 8, num_blobs: 30, max_blobs: 50, speed: .15, scalar: 1 } }, function (t, e, i) { var n, o, s, r, a; for (a = i(10), o = [{ id: "pos-x", url: "/img/liquidice/pos-x.jpg", type: "image" }, { id: "neg-x", url: "/img/liquidice/neg-x.jpg", type: "image" }, { id: "pos-y", url: "/img/liquidice/pos-y.jpg", type: "image" }, { id: "neg-y", url: "/img/liquidice/neg-y.jpg", type: "image" }, { id: "pos-z", url: "/img/liquidice/pos-z.jpg", type: "image" }, { id: "neg-z", url: "/img/liquidice/neg-z.jpg", type: "image" }, { id: "MarchingCubesData", url: "/js/liquidice/MarchingCubesData.js", type: "js" }, { id: "FresnelShader", url: "/js/liquidice/FresnelShader.js", type: "js" }, { id: "background", url: "/sound/liquidice/background.mp3", type: "sound" }, { id: "top", url: "/sound/liquidice/top.mp3", type: "sound" }], s = 0, r = o.length; r > s; s++)n = o[s], n.url = a.base_path + n.url; t.exports = o }, function (t, e, i) { function n(t) { return i(o(t)) } function o(t) { return s[t] || function () { throw new Error("Cannot find module '" + t + "'.") }() } var s = { "./blackice/assets": 45, "./calvarium/assets": 53, "./elements/assets": 89, "./epilogue/assets": 69, "./hires/assets": 73, "./home/assets": 79, "./kubik/assets": 83, "./liquidice/assets": 87 }; n.keys = function () { return Object.keys(s) }, n.resolve = o, t.exports = n, n.id = 88 }, function (t, e, i) { var n, o, s, r, a; for (a = i(10), o = [{ id: "dodecahedron_sequence", url: "/img/elements/dodecahedron/dodecahedron.frames.json", type: "sequence" }, { id: "hexahedron_sequence", url: "/img/elements/hexahedron/hexahedron.frames.json", type: "sequence" }, { id: "tetrahedron_sequence", url: "/img/elements/tetrahedron/tetrahedron.frames.json", type: "sequence" }, { id: "octahedron_sequence", url: "/img/elements/octahedron/octahedron.frames.json", type: "sequence" }, { id: "icosahedron_sequence", url: "/img/elements/icosahedron/icosahedron.frames.json", type: "sequence" }, { id: "background", url: "/sound/elements/background.mp3", type: "sound" }, { id: "aether", url: "/sound/elements/aether.mp3", type: "sound" }, { id: "air", url: "/sound/elements/air.mp3", type: "sound" }, { id: "earth", url: "/sound/elements/earth.mp3", type: "sound" }, { id: "fire", url: "/sound/elements/fire.mp3", type: "sound" }, { id: "water", url: "/sound/elements/water.mp3", type: "sound" }], s = 0, r = o.length; r > s; s++)n = o[s], n.url = a.base_path + n.url; t.exports = o }, function (t, e, i) { function n(t) { return i(o(t)) } function o(t) { return s[t] || function () { throw new Error("Cannot find module '" + t + "'.") }() } var s = { "./blackice/config": 91, "./calvarium/config": 51, "./elements/config": 92, "./epilogue/config": 64, "./hires/config": 72, "./home/config": 76, "./kubik/config": 82, "./liquidice/config": 86 }; n.keys = function () { return Object.keys(s) }, n.resolve = o, t.exports = n, n.id = 90 }, function (t, e) { t.exports = { fog_enabled: !0, transition_debug: !1, camera_fov: 55, path_in: [{ x: 0, y: 0, z: 500 }, { x: 0, y: 0, z: 80 }], path_in_lookat: { x: 0, y: 0, z: 0 }, path_out: [{ x: 0, y: 0, z: 80 }, { x: 0, y: -40.57142857142857, z: 71 }, { x: 0, y: -90.85714285714286, z: 10 }], path_out_lookat: [{ x: 0, y: 0, z: 0 }, { x: 0, y: -100, z: 0 }], camera_in_duration: 10, camera_out_duration: 2, fog_in_duration: 10, fog_out_duration: 3, fog_in_start: .01, fog_in_end: .001, fog_out_start: .001, fog_out_end: .1, audio_pos_z_in: -10, audio_pos_z_out: 15, iteration_preset: [{ movement_speed: .02, vel_x: -200 }, { movement_speed: .05, vel_x: -250 }, { movement_speed: .07, vel_x: -280 }] } }, function (t, e) { t.exports = { fog_enabled: !0, transition_debug: !1, camera_fov: 35, path_in: [{ x: 0, y: 0, z: 400 }, { x: 0, y: 0, z: 40 }], path_in_lookat: { x: 0, y: 0, z: 0 }, path_out: [{ x: 0, y: 0, z: 40 }, { x: 0, y: -27, z: 0 }, { x: 0, y: -60, z: -20 }], path_out_lookat: [{ x: 0, y: 0, z: -190 }, { x: 0, y: -260, z: -190 }], camera_in_duration: 10, camera_out_duration: 5, fog_in_duration: 10, fog_out_duration: 5, fog_in_start: .1, fog_in_end: .01, fog_out_start: .01, fog_out_end: .1, audio_pos_z_in: 35, audio_pos_z_out: 15, cam_move_bounds: .5, sphere_radius: 30, geometry: "", iteration: 0, radius: 0, scale_ratio: 0, deform: 0, color: "#ffffff", wireframe: !0, wireframe_thickness: 0, blending: "", opacity: .35, fog_near: .029, fog_far: .009, cam_zoom_percent: 1, geometries: { dodecahedron: { geometry: "DodecahedronGeometry", iteration: 2, radius: 20, scale_ratio: 3.61803399, color: "#ffffff", wireframe: !0, wireframe_thickness: 1.5, blending: "NormalBlending", opacity: 1, rotate: !0, fog: .03, deform: 0, rotate_x: 0, rotate_y: 1.06, rotate_z: 0, sound: "aether" }, icosahedron: { geometry: "IcosahedronGeometry", iteration: 3, radius: 20, scale_ratio: 2.61803399, color: "#ffffff", wireframe: !0, wireframe_thickness: 1.5, blending: "NormalBlending", opacity: 1, rotate: !0, fog: .03, deform: 0, rotate_x: 1.27, rotate_y: 1.06, rotate_z: 0, sound: "water" }, tetrahedron: { geometry: "TetrahedronGeometry", iteration: 6, radius: 20, scale_ratio: 2, color: "#ffffff", wireframe: !0, wireframe_thickness: 1.5, blending: "NormalBlending", opacity: 1, rotate: !0, fog: .03, deform: 0, rotate_x: 0, rotate_y: .99, rotate_z: 2.26, sound: "fire" }, octahedron: { geometry: "OctahedronGeometry", iteration: 5, radius: 20, scale_ratio: 2, color: "#ffffff", wireframe: !0, wireframe_thickness: 1.5, blending: "NormalBlending", opacity: 1, rotate: !0, fog: .046, deform: 0, rotate_x: .21, rotate_y: 0, rotate_z: 0, sound: "air" }, hexahedron: { geometry: "BoxGeometry", iteration: 4, radius: 20, scale_ratio: 2.4, color: "#ffffff", wireframe: !0, wireframe_thickness: 1.5, blending: "NormalBlending", opacity: 1, rotate: !0, fog: .03, deform: 0, rotate_x: .49, rotate_y: Math.PI / 4, rotate_z: 0, sound: "earth" } } } }, function (t, e, i) { var n, o, s, r, a, u, h = function (t, e) { return function () { return t.apply(e, arguments) } }; s = i(11), u = i(39), r = i(21), a = i(22), o = i(94), t.exports = n = function () { function t(t) { var e; this.id = t, this.disable = h(this.disable, this), this.enable = h(this.enable, this), this.on_url_change = h(this.on_url_change, this), this.gui = s.addFolder("controller::navigation"), this.gui.open(), e = u.all(), this.view = new o(this.gui, e), this.bind(), this.on_url_change(r.get_url()) } return t.prototype.bind = function () { return this.view.on("click", this.navigate), r.on("go", this.on_url_change), r.on("nav:disable", this.disable), r.on("nav:enable", this.enable) }, t.prototype.navigate = function (t) { var e, i, n, o; for (n = null, e = 0, i = a.length; i > e; e++)if (o = a[e], o.id.match(t)) { n = o; break } return r.go(n.url) }, t.prototype.on_url_change = function () { var t, e, i, n, o, s; for (s = r.get_url(), s = s.slice(1, s.length), i = u.all(), e = null, n = 0, o = i.length; o > n; n++)if (t = i[n], t.id.match(s)) { e = t; break } return this.view.update(e) }, t.prototype.enable = function () { return this.view.enable() }, t.prototype.disable = function () { return this.view.disable() }, t }() }, function (t, e, i) { var n, o, s = function (t, e) { return function () { return t.apply(e, arguments) } }; o = i(8), t.exports = n = function () { function t(t, e) { this.gui = t, this.data = e, this.on_click = s(this.on_click, this), this.disable = s(this.disable, this), this.enable = s(this.enable, this), o(this), this.render() } return t.prototype.ui = { chapters: "li a" }, t.prototype.render = function () { var t, e, n, o; o = i(95), $("main").append(o({ data: this.data })), this.el = $("#navigation"), n = this.ui; for (e in n) t = n[e], this.ui[e] = this.el.find(t); return this.transition_in(), this.bind(), this.disable() }, t.prototype.bind = function () { return this.ui.chapters.on("click", this.on_click) }, t.prototype.unbind = function () { return this.ui.chapters.off("click", this.on_click) }, t.prototype.enable = function () { return this.ui.chapters.removeClass("disable") }, t.prototype.disable = function () { return this.ui.chapters.addClass("disable") }, t.prototype.on_click = function (t) { var e; return t.preventDefault(), e = $(t.currentTarget).data("id"), this.emit("click", e) }, t.prototype.transition_in = function () { var t; return t = { autoAlpha: 1, ease: Power1.easeInOut, delay: .5 }, TweenLite.to(this.el, 2, t) }, t.prototype.update = function (t) { return this.ui.chapters.removeClass("active"), this.el.find("a[data-id=" + t.id + "]").addClass("active") }, t }() }, function (t, e, i) { var n = i(43); t.exports = function (t) { var e, i = [], o = t || {}; return function (o) { i.push('<div id="navigation" class="section layer layer-10"><div class="content"><nav><ul>'), function () { var o = t.data; if ("number" == typeof o.length) for (var s = 0, r = o.length; r > s; s++) { var a = o[s]; i.push('<li><a href="#"' + n.attr("data-id", "" + a.id, !0, !1) + '><span class="title">' + n.escape(null == (e = a.nav_title) ? "" : e) + '</span><span class="ch">' + n.escape(null == (e = a.chapter) ? "" : e) + "</span></a></li>") } else { var r = 0; for (var s in o) { r++; var a = o[s]; i.push('<li><a href="#"' + n.attr("data-id", "" + a.id, !0, !1) + '><span class="title">' + n.escape(null == (e = a.nav_title) ? "" : e) + '</span><span class="ch">' + n.escape(null == (e = a.chapter) ? "" : e) + "</span></a></li>") } } }.call(this), i.push("</ul></nav></div></div>") }.call(this, "undefined" in o ? o.undefined : void 0), i.join("") } }, function (t, e, i) {
        var n, o, s, r, a, u, h = function (t, e) { return function () { return t.apply(e, arguments) } }; a = i(34), r = i(10), o = i(26), u = i(9), t.exports = n = function () { function t() { this.omg = h(this.omg, this), this.lols = h(this.lols, this); var t, e, i, n, o; this.el = $("body"), this.ui = { main: "main" }, o = this.ui; for (e in o) t = o[e], this.ui[e] = this.el.find(t); i = [], n = "38,38,40,40,37,39,37,39,66,65", $(document).keydown(function (t) { return function (e) { return i.push(e.keyCode), i.toString().indexOf(n) >= 0 ? ($(document).unbind("keydown", arguments.callee), t.wtf(), i = []) : void 0 } }(this)) } return t.prototype.num_stickers = 35, t.prototype.wtf = function () { return u.on("resize", this.omg), this.ui.main.addClass("konami"), this.loader = new o, this.loader.add("images", r.base_path + "/img/konami/images.json", "json"), this.loader.add("lol", r.base_path + "/sound/konami/lol.mp3", "sound"), this.loader.once("loaded", this.lols), this.loader.load() }, t.prototype.lols = function (t) { var e, i, n, o, r, a, u; for (e = this.loader.get_asset("images").data.images, a = this.loader.get_asset("lol").data, a.play(), a.loop(!0), this.stickers = [], r = [], i = n = 0, o = this.num_stickers; o >= 0 ? o > n : n > o; i = o >= 0 ? ++n : --n)u = .2 * i, r.push(this.stickers.push(new s(u, e))); return r }, t.prototype.omg = function () { var t, e, i, n, o, s, r, a, h; for (h = u.width < 1280 ? 15 : u.width < 1440 ? 25 : this.num_stickers, o = this.stickers, e = 0, n = o.length; n > e; e++)a = o[e], a.hide(); for (r = [], t = i = 0, s = h; s >= 0 ? s > i : i > s; t = s >= 0 ? ++i : --i)r.push(this.stickers[t].show()); return r }, t }(), s = function () {
            function t(t, e) { this.data = e, this.img = $("<img/>"), this.img.addClass("sticker"), $("body").append(this.img), a.delay(t, function (t) { return function () { return t.random() } }(this)) } return t.prototype.src = function () { var t; return t = this.data[Math.floor(Math.random() * this.data.length)], this.img.attr("src", r.base_path + "/img/konami/" + t) }, t.prototype.random = function () {
                var t, e;
                return this.src(), e = "scale(" + a.random(.3, 1) + ")", this.img.css({ left: a.random(0, .8 * u.width) + "px", top: a.random(0, .8 * u.height) + "px", transform: e }), t = a.random(5, 10), a.delay(t, function (t) { return function () { return t.start_delay = 0, t.random() } }(this))
            }, t.prototype.show = function () { return this.img.css("display", "block") }, t.prototype.hide = function () { return this.img.css("display", "none") }, t
        }()
    }, function (t, e, i) { var n, o, s; o = i(38), s = i(10), n = i(4), t.exports = function () { function t() { var t, e; e = i(98), t = { dictionary: o, base_path: s.base_path, device: n.device }, $("body").append(e(t)) } return t }() }, function (t, e, i) { var n = i(43); t.exports = function (t) { var e, i = [], o = t || {}; return function (o) { i.push('<div id="unsupported" class="section layer layer-1"><div class="content"><h1 class="hi_res layer layer-1"><a href="http://hi-res.net" title="Hi-ReS!"></a></h1><div class="message layer"><div class="the-future"><img' + n.attr("src", "" + t.base_path + "/img/ui/nyan.gif", !0, !1) + ' class="nyan layer layer-1"/><img' + n.attr("src", "" + t.base_path + "/img/ui/ibm.png", !0, !1) + ' class="ibm layer layer-2"/></div><h2>' + n.escape(null == (e = o.get("unsupported_title")) ? "" : e) + "</h2>"), t.device ? i.push("" + (null == (e = o.get("unsupported_text_device")) ? "" : e)) : i.push("" + (null == (e = o.get("unsupported_text_desktop")) ? "" : e)), i.push("</div></div></div>") }.call(this, "dictionary" in o ? o.dictionary : "undefined" != typeof dictionary ? dictionary : void 0), i.join("") } }, function (t, e, i) { var n; n = i(38), t.exports = function () { function t() { var t, e; e = i(100), t = { dictionary: n }, $("body").append(e(t)) } return t }() }, function (t, e, i) { var n = i(43); t.exports = function (t) { var e, i = [], o = t || {}; return function (o) { i.push('<div id="notfound" class="section layer layer-1"><div class="content"><h1 class="hi_res layer layer-1"></h1><div class="message layer"><img' + n.attr("src", "" + t.base_path + "/img/ui/404.jpg", !0, !1) + "/><h2>" + n.escape(null == (e = o.get("notfound_title")) ? "" : e) + "</h2></div></div></div>") }.call(this, "dictionary" in o ? o.dictionary : "undefined" != typeof dictionary ? dictionary : void 0), i.join("") } }, function (t, e) { var i; i = function () { function t() { } var e; return e = ["not-allowed", "help", "move", "all-scroll", "sw-resize"], t.prototype._random_to = null, t.prototype.random = function () { var t; return (t = function (t) { return function () { var i; return i = Math.floor(Math.random() * e.length), $("body").css({ cursor: e[i] }), t._random_to = setTimeout(arguments.callee, 5e3 * Math.random()) } }(this))() }, t.prototype.stop_random = function () { return clearTimeout(this._random_to) }, t }(), t.exports = new i }]);
});